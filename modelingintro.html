<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 17 Intro to Modeling - Getting Started with HBV | Hydroinformatics at VT</title>
  <meta name="description" content="This bookdown contains notes and exercises for a course in hydroinformatics at Virginia Tech." />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 17 Intro to Modeling - Getting Started with HBV | Hydroinformatics at VT" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This bookdown contains notes and exercises for a course in hydroinformatics at Virginia Tech." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 17 Intro to Modeling - Getting Started with HBV | Hydroinformatics at VT" />
  
  <meta name="twitter:description" content="This bookdown contains notes and exercises for a course in hydroinformatics at Virginia Tech." />
  

<meta name="author" content="JP Gannon" />


<meta name="date" content="2023-02-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="rgeowatersheds.html"/>
<link rel="next" href="modelingcalibration.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>
<script src="libs/rglWebGL-binding-0.109.6/rglWebGL.js"></script>
<link href="libs/rglwidgetClass-0.109.6/rgl.css" rel="stylesheet" />
<script src="libs/rglwidgetClass-0.109.6/rglClass.min.js"></script>
<script type = "text/plain" id = "rgl-vertex-shader">
#line 2 1
// File 1 is the vertex shader
#ifdef GL_ES
#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
#endif

attribute vec3 aPos;
attribute vec4 aCol;
uniform mat4 mvMatrix;
uniform mat4 prMatrix;
varying vec4 vCol;
varying vec4 vPosition;

#ifdef NEEDS_VNORMAL
attribute vec3 aNorm;
uniform mat4 normMatrix;
varying vec4 vNormal;
#endif

#if defined(HAS_TEXTURE) || defined (IS_TEXT)
attribute vec2 aTexcoord;
varying vec2 vTexcoord;
#endif

#ifdef FIXED_SIZE
uniform vec3 textScale;
#endif

#ifdef FIXED_QUADS
attribute vec3 aOfs;
#endif

#ifdef IS_TWOSIDED
#ifdef HAS_NORMALS
varying float normz;
uniform mat4 invPrMatrix;
#else
attribute vec3 aPos1;
attribute vec3 aPos2;
varying float normz;
#endif
#endif // IS_TWOSIDED

#ifdef FAT_LINES
attribute vec3 aNext;
attribute vec2 aPoint;
varying vec2 vPoint;
varying float vLength;
uniform float uAspect;
uniform float uLwd;
#endif


void main(void) {
  
#ifndef IS_BRUSH
#if defined(NCLIPPLANES) || !defined(FIXED_QUADS) || defined(HAS_FOG)
  vPosition = mvMatrix * vec4(aPos, 1.);
#endif
  
#ifndef FIXED_QUADS
  gl_Position = prMatrix * vPosition;
#endif
#endif // !IS_BRUSH
  
#ifdef IS_POINTS
  gl_PointSize = POINTSIZE;
#endif
  
  vCol = aCol;
  
#ifdef NEEDS_VNORMAL
  vNormal = normMatrix * vec4(-aNorm, dot(aNorm, aPos));
#endif
  
#ifdef IS_TWOSIDED
#ifdef HAS_NORMALS
  /* normz should be calculated *after* projection */
  normz = (invPrMatrix*vNormal).z;
#else
  vec4 pos1 = prMatrix*(mvMatrix*vec4(aPos1, 1.));
  pos1 = pos1/pos1.w - gl_Position/gl_Position.w;
  vec4 pos2 = prMatrix*(mvMatrix*vec4(aPos2, 1.));
  pos2 = pos2/pos2.w - gl_Position/gl_Position.w;
  normz = pos1.x*pos2.y - pos1.y*pos2.x;
#endif
#endif // IS_TWOSIDED
  
#ifdef NEEDS_VNORMAL
  vNormal = vec4(normalize(vNormal.xyz/vNormal.w), 1);
#endif
  
#if defined(HAS_TEXTURE) || defined(IS_TEXT)
  vTexcoord = aTexcoord;
#endif
  
#if defined(FIXED_SIZE) && !defined(ROTATING)
  vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);
  pos = pos/pos.w;
  gl_Position = pos + vec4(aOfs*textScale, 0.);
#endif
  
#if defined(IS_SPRITES) && !defined(FIXED_SIZE)
  vec4 pos = mvMatrix * vec4(aPos, 1.);
  pos = pos/pos.w + vec4(aOfs,  0.);
  gl_Position = prMatrix*pos;
#endif
  
#ifdef FAT_LINES
  /* This code was inspired by Matt Deslauriers' code in 
   https://mattdesl.svbtle.com/drawing-lines-is-hard */
  vec2 aspectVec = vec2(uAspect, 1.0);
  mat4 projViewModel = prMatrix * mvMatrix;
  vec4 currentProjected = projViewModel * vec4(aPos, 1.0);
  currentProjected = currentProjected/currentProjected.w;
  vec4 nextProjected = projViewModel * vec4(aNext, 1.0);
  vec2 currentScreen = currentProjected.xy * aspectVec;
  vec2 nextScreen = (nextProjected.xy / nextProjected.w) * aspectVec;
  float len = uLwd;
  vec2 dir = vec2(1.0, 0.0);
  vPoint = aPoint;
  vLength = length(nextScreen - currentScreen)/2.0;
  vLength = vLength/(vLength + len);
  if (vLength > 0.0) {
    dir = normalize(nextScreen - currentScreen);
  }
  vec2 normal = vec2(-dir.y, dir.x);
  dir.x /= uAspect;
  normal.x /= uAspect;
  vec4 offset = vec4(len*(normal*aPoint.x*aPoint.y - dir), 0.0, 0.0);
  gl_Position = currentProjected + offset;
#endif
  
#ifdef IS_BRUSH
  gl_Position = vec4(aPos, 1.);
#endif
}
</script>
<script type = "text/plain" id = "rgl-fragment-shader">
#line 2 2
// File 2 is the fragment shader
#ifdef GL_ES
#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
#endif
varying vec4 vCol; // carries alpha
varying vec4 vPosition;
#if defined(HAS_TEXTURE) || defined (IS_TEXT)
varying vec2 vTexcoord;
uniform sampler2D uSampler;
#endif

#ifdef HAS_FOG
uniform int uFogMode;
uniform vec3 uFogColor;
uniform vec4 uFogParms;
#endif

#if defined(IS_LIT) && !defined(FIXED_QUADS)
varying vec4 vNormal;
#endif

#if NCLIPPLANES > 0
uniform vec4 vClipplane[NCLIPPLANES];
#endif

#if NLIGHTS > 0
uniform mat4 mvMatrix;
#endif

#ifdef IS_LIT
uniform vec3 emission;
uniform float shininess;
#if NLIGHTS > 0
uniform vec3 ambient[NLIGHTS];
uniform vec3 specular[NLIGHTS]; // light*material
uniform vec3 diffuse[NLIGHTS];
uniform vec3 lightDir[NLIGHTS];
uniform bool viewpoint[NLIGHTS];
uniform bool finite[NLIGHTS];
#endif
#endif // IS_LIT

#ifdef IS_TWOSIDED
uniform bool front;
varying float normz;
#endif

#ifdef FAT_LINES
varying vec2 vPoint;
varying float vLength;
#endif

void main(void) {
  vec4 fragColor;
#ifdef FAT_LINES
  vec2 point = vPoint;
  bool neg = point.y < 0.0;
  point.y = neg ? (point.y + vLength)/(1.0 - vLength) :
                 -(point.y - vLength)/(1.0 - vLength);
#if defined(IS_TRANSPARENT) && defined(IS_LINESTRIP)
  if (neg && length(point) <= 1.0) discard;
#endif
  point.y = min(point.y, 0.0);
  if (length(point) > 1.0) discard;
#endif // FAT_LINES
  
#ifdef ROUND_POINTS
  vec2 coord = gl_PointCoord - vec2(0.5);
  if (length(coord) > 0.5) discard;
#endif
  
#if NCLIPPLANES > 0
  for (int i = 0; i < NCLIPPLANES; i++)
    if (dot(vPosition, vClipplane[i]) < 0.0) discard;
#endif
    
#ifdef FIXED_QUADS
    vec3 n = vec3(0., 0., 1.);
#elif defined(IS_LIT)
    vec3 n = normalize(vNormal.xyz);
#endif
    
#ifdef IS_TWOSIDED
    if ((normz <= 0.) != front) discard;
#endif
    
#ifdef IS_LIT
    vec3 eye = normalize(-vPosition.xyz/vPosition.w);
    vec3 lightdir;
    vec4 colDiff;
    vec3 halfVec;
    vec4 lighteffect = vec4(emission, 0.);
    vec3 col;
    float nDotL;
#ifdef FIXED_QUADS
    n = -faceforward(n, n, eye);
#endif
    
#if NLIGHTS > 0
    for (int i=0;i<NLIGHTS;i++) {
      colDiff = vec4(vCol.rgb * diffuse[i], vCol.a);
      lightdir = lightDir[i];
      if (!viewpoint[i])
        lightdir = (mvMatrix * vec4(lightdir, 1.)).xyz;
      if (!finite[i]) {
        halfVec = normalize(lightdir + eye);
      } else {
        lightdir = normalize(lightdir - vPosition.xyz/vPosition.w);
        halfVec = normalize(lightdir + eye);
      }
      col = ambient[i];
      nDotL = dot(n, lightdir);
      col = col + max(nDotL, 0.) * colDiff.rgb;
      col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular[i];
      lighteffect = lighteffect + vec4(col, colDiff.a);
    }
#endif
    
#else // not IS_LIT
    vec4 colDiff = vCol;
    vec4 lighteffect = colDiff;
#endif
    
#ifdef IS_TEXT
    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);
#endif
    
#ifdef HAS_TEXTURE
#ifdef TEXTURE_rgb
    vec4 textureColor = lighteffect*vec4(texture2D(uSampler, vTexcoord).rgb, 1.);
#endif
    
#ifdef TEXTURE_rgba
    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);
#endif
    
#ifdef TEXTURE_alpha
    vec4 textureColor = texture2D(uSampler, vTexcoord);
    float luminance = dot(vec3(1.,1.,1.), textureColor.rgb)/3.;
    textureColor =  vec4(lighteffect.rgb, lighteffect.a*luminance);
#endif
    
#ifdef TEXTURE_luminance
    vec4 textureColor = vec4(lighteffect.rgb*dot(texture2D(uSampler, vTexcoord).rgb, vec3(1.,1.,1.))/3., lighteffect.a);
#endif
    
#ifdef TEXTURE_luminance_alpha
    vec4 textureColor = texture2D(uSampler, vTexcoord);
    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;
    textureColor = vec4(lighteffect.rgb*luminance, lighteffect.a*textureColor.a);
#endif
    
    fragColor = textureColor;

#elif defined(IS_TEXT)
    if (textureColor.a < 0.1)
      discard;
    else
      fragColor = textureColor;
#else
    fragColor = lighteffect;
#endif // HAS_TEXTURE
    
#ifdef HAS_FOG
    // uFogParms elements: x = near, y = far, z = fogscale, w = (1-sin(FOV/2))/(1+sin(FOV/2))
    // In Exp and Exp2: use density = density/far
    // fogF will be the proportion of fog
    // Initialize it to the linear value
    float fogF;
    if (uFogMode > 0) {
      fogF = (uFogParms.y - vPosition.z/vPosition.w)/(uFogParms.y - uFogParms.x);
      if (uFogMode > 1)
        fogF = mix(uFogParms.w, 1.0, fogF);
      fogF = fogF*uFogParms.z;
      if (uFogMode == 2)
        fogF = 1.0 - exp(-fogF);
      // Docs are wrong: use (density*c)^2, not density*c^2
      // https://gitlab.freedesktop.org/mesa/mesa/-/blob/master/src/mesa/swrast/s_fog.c#L58
      else if (uFogMode == 3)
        fogF = 1.0 - exp(-fogF*fogF);
      fogF = clamp(fogF, 0.0, 1.0);
      gl_FragColor = vec4(mix(fragColor.rgb, uFogColor, fogF), fragColor.a);
    } else gl_FragColor = fragColor;
#else
    gl_FragColor = fragColor;
#endif // HAS_FOG
    
}
</script>
<script src="libs/CanvasMatrix4-0.109.6/CanvasMatrix.min.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GBDXSZFFSR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-GBDXSZFFSR');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Hydroinformatics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.0.1" data-path="index.html"><a href="index.html#to-help-me-keep-get-an-idea-of-who-is-using-this-resource-so-i-can-improve-it-in-the-future-please-consider-filling-out-any-or-all-of-this-survey-httpsforms.gle6zcntzvr1wzzuh6s7-thanks"><i class="fa fa-check"></i><b>1.0.1</b> To help me keep get an idea of who is using this resource so I can improve it in the future, please consider filling out any or all of this survey: https://forms.gle/6Zcntzvr1wZZUh6S7 Thanks!</a></li>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#how-to-use-these-materials"><i class="fa fa-check"></i><b>1.1</b> How to use these materials</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#table-of-contents"><i class="fa fa-check"></i><b>1.2</b> Table of contents:</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Plotting.html"><a href="Plotting.html"><i class="fa fa-check"></i><b>2</b> Intro to Plotting</a>
<ul>
<li class="chapter" data-level="2.1" data-path="Plotting.html"><a href="Plotting.html#download-and-install-tidyverse-library"><i class="fa fa-check"></i><b>2.1</b> Download and install tidyverse library</a></li>
<li class="chapter" data-level="2.2" data-path="Plotting.html"><a href="Plotting.html#reading-data"><i class="fa fa-check"></i><b>2.2</b> Reading data</a></li>
<li class="chapter" data-level="2.3" data-path="Plotting.html"><a href="Plotting.html#our-first-ggplot"><i class="fa fa-check"></i><b>2.3</b> Our first ggplot</a></li>
<li class="chapter" data-level="2.4" data-path="Plotting.html"><a href="Plotting.html#change-point-type"><i class="fa fa-check"></i><b>2.4</b> Change point type</a></li>
<li class="chapter" data-level="2.5" data-path="Plotting.html"><a href="Plotting.html#set-colors"><i class="fa fa-check"></i><b>2.5</b> Set colors</a></li>
<li class="chapter" data-level="2.6" data-path="Plotting.html"><a href="Plotting.html#controlling-color-with-a-third-variable-and-other-functions"><i class="fa fa-check"></i><b>2.6</b> Controlling color with a third variable and other functions</a></li>
<li class="chapter" data-level="2.7" data-path="Plotting.html"><a href="Plotting.html#plotting-multiple-groups"><i class="fa fa-check"></i><b>2.7</b> Plotting multiple groups</a></li>
<li class="chapter" data-level="2.8" data-path="Plotting.html"><a href="Plotting.html#facets"><i class="fa fa-check"></i><b>2.8</b> Facets</a></li>
<li class="chapter" data-level="2.9" data-path="Plotting.html"><a href="Plotting.html#two-variable-faceting"><i class="fa fa-check"></i><b>2.9</b> Two variable faceting</a></li>
<li class="chapter" data-level="2.10" data-path="Plotting.html"><a href="Plotting.html#boxplots"><i class="fa fa-check"></i><b>2.10</b> Boxplots</a></li>
<li class="chapter" data-level="2.11" data-path="Plotting.html"><a href="Plotting.html#more-about-color-size-etc"><i class="fa fa-check"></i><b>2.11</b> More about color, size, etc</a></li>
<li class="chapter" data-level="2.12" data-path="Plotting.html"><a href="Plotting.html#multiple-geoms"><i class="fa fa-check"></i><b>2.12</b> Multiple geoms</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Programming.html"><a href="Programming.html"><i class="fa fa-check"></i><b>3</b> R Tidyverse Programming Basics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="Programming.html"><a href="Programming.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="Programming.html"><a href="Programming.html#you-can-use-r-as-a-calculator"><i class="fa fa-check"></i><b>3.2</b> You can use R as a calculator</a></li>
<li class="chapter" data-level="3.3" data-path="Programming.html"><a href="Programming.html#you-can-create-new-objects-using--"><i class="fa fa-check"></i><b>3.3</b> You can create new objects using &lt;-</a></li>
<li class="chapter" data-level="3.4" data-path="Programming.html"><a href="Programming.html#using-functions"><i class="fa fa-check"></i><b>3.4</b> Using functions</a></li>
<li class="chapter" data-level="3.5" data-path="Programming.html"><a href="Programming.html#read-in-some-data."><i class="fa fa-check"></i><b>3.5</b> Read in some data.</a></li>
<li class="chapter" data-level="3.6" data-path="Programming.html"><a href="Programming.html#wait-hold-up.-what-is-a-tibble"><i class="fa fa-check"></i><b>3.6</b> Wait, hold up. What is a tibble?</a></li>
<li class="chapter" data-level="3.7" data-path="Programming.html"><a href="Programming.html#data-wrangling-in-dplyr"><i class="fa fa-check"></i><b>3.7</b> Data wrangling in dplyr</a></li>
<li class="chapter" data-level="3.8" data-path="Programming.html"><a href="Programming.html#filter"><i class="fa fa-check"></i><b>3.8</b> Filter</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="Programming.html"><a href="Programming.html#multiple-conditions"><i class="fa fa-check"></i><b>3.8.1</b> Multiple conditions</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="Programming.html"><a href="Programming.html#arrange"><i class="fa fa-check"></i><b>3.9</b> Arrange</a></li>
<li class="chapter" data-level="3.10" data-path="Programming.html"><a href="Programming.html#select"><i class="fa fa-check"></i><b>3.10</b> Select</a></li>
<li class="chapter" data-level="3.11" data-path="Programming.html"><a href="Programming.html#mutate"><i class="fa fa-check"></i><b>3.11</b> Mutate</a></li>
<li class="chapter" data-level="3.12" data-path="Programming.html"><a href="Programming.html#summarize"><i class="fa fa-check"></i><b>3.12</b> Summarize</a></li>
<li class="chapter" data-level="3.13" data-path="Programming.html"><a href="Programming.html#multiple-operations-with-pipes"><i class="fa fa-check"></i><b>3.13</b> Multiple operations with pipes</a>
<ul>
<li class="chapter" data-level="3.13.1" data-path="Programming.html"><a href="Programming.html#lets-say-we-want-to-tell-r-to-make-a-pbj-sandwich-by-using-the-pbbread-jbread-and-joinslices-functions-and-the-data-ingredients.-if-we-do-this-saving-each-step-if-would-look-like-this"><i class="fa fa-check"></i><b>3.13.1</b> Let’s say we want to tell R to make a PB&amp;J sandwich by using the pbbread(), jbread(), and joinslices() functions and the data “ingredients”. If we do this saving each step if would look like this:</a></li>
<li class="chapter" data-level="3.13.2" data-path="Programming.html"><a href="Programming.html#if-we-nest-the-functions-together-we-get-this"><i class="fa fa-check"></i><b>3.13.2</b> If we nest the functions together we get this</a></li>
<li class="chapter" data-level="3.13.3" data-path="Programming.html"><a href="Programming.html#using-the-pipe-it-would-look-like-this"><i class="fa fa-check"></i><b>3.13.3</b> Using the pipe it would look like this</a></li>
<li class="chapter" data-level="3.13.4" data-path="Programming.html"><a href="Programming.html#when-you-use-the-pipe-it-basically-takes-whatever-came-out-of-the-first-function-and-puts-it-into-the-data-argument-for-the-next-one"><i class="fa fa-check"></i><b>3.13.4</b> When you use the pipe, it basically takes whatever came out of the first function and puts it into the data argument for the next one</a></li>
</ul></li>
<li class="chapter" data-level="3.14" data-path="Programming.html"><a href="Programming.html#save-your-results-to-a-new-tibble"><i class="fa fa-check"></i><b>3.14</b> Save your results to a new tibble</a></li>
<li class="chapter" data-level="3.15" data-path="Programming.html"><a href="Programming.html#what-about-nas"><i class="fa fa-check"></i><b>3.15</b> What about NAs?</a></li>
<li class="chapter" data-level="3.16" data-path="Programming.html"><a href="Programming.html#what-are-some-things-you-think-ill-ask-you-to-do-for-the-activity-next-class"><i class="fa fa-check"></i><b>3.16</b> What are some things you think I’ll ask you to do for the activity next class?</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introactivity.html"><a href="introactivity.html"><i class="fa fa-check"></i><b>4</b> ACTIVITY Intro Skills</a>
<ul>
<li class="chapter" data-level="4.1" data-path="introactivity.html"><a href="introactivity.html#problem-1"><i class="fa fa-check"></i><b>4.1</b> Problem 1</a></li>
<li class="chapter" data-level="4.2" data-path="introactivity.html"><a href="introactivity.html#problem-2"><i class="fa fa-check"></i><b>4.2</b> Problem 2</a></li>
<li class="chapter" data-level="4.3" data-path="introactivity.html"><a href="introactivity.html#problem-3"><i class="fa fa-check"></i><b>4.3</b> Problem 3</a></li>
<li class="chapter" data-level="4.4" data-path="introactivity.html"><a href="introactivity.html#problem-4"><i class="fa fa-check"></i><b>4.4</b> Problem 4</a></li>
<li class="chapter" data-level="4.5" data-path="introactivity.html"><a href="introactivity.html#problem-5"><i class="fa fa-check"></i><b>4.5</b> Problem 5</a></li>
<li class="chapter" data-level="4.6" data-path="introactivity.html"><a href="introactivity.html#problem-6"><i class="fa fa-check"></i><b>4.6</b> Problem 6</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="stats.html"><a href="stats.html"><i class="fa fa-check"></i><b>5</b> Introduction to Basic Statistics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="stats.html"><a href="stats.html#reading-for-this-section-statistical-methods-in-water-resources-chapter-1"><i class="fa fa-check"></i><b>5.1</b> Reading for this section: Statistical Methods in Water Resources: Chapter 1</a></li>
<li class="chapter" data-level="5.2" data-path="stats.html"><a href="stats.html#questions-for-today"><i class="fa fa-check"></i><b>5.2</b> Questions for today:</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="stats.html"><a href="stats.html#stack-plots-to-compare-histogram-and-pdf"><i class="fa fa-check"></i><b>5.2.1</b> Stack plots to compare histogram and pdf</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="stats.html"><a href="stats.html#what-is-the-difference-between-a-sample-and-a-population."><i class="fa fa-check"></i><b>5.3</b> What is the difference between a sample and a population.</a></li>
<li class="chapter" data-level="5.4" data-path="stats.html"><a href="stats.html#measuring-our-sample-distribution-central-tendency."><i class="fa fa-check"></i><b>5.4</b> Measuring our sample distribution: central tendency.</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="stats.html"><a href="stats.html#so-whats-a-weighted-average"><i class="fa fa-check"></i><b>5.4.1</b> So what’s a weighted average?</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="stats.html"><a href="stats.html#measures-of-variability"><i class="fa fa-check"></i><b>5.5</b> Measures of variability</a></li>
<li class="chapter" data-level="5.6" data-path="stats.html"><a href="stats.html#what-is-a-normal-distribution-and-how-can-we-determine-if-we-have-one"><i class="fa fa-check"></i><b>5.6</b> What is a normal distribution and how can we determine if we have one?</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="statsactivity.html"><a href="statsactivity.html"><i class="fa fa-check"></i><b>6</b> ACTIVITY Intro Stats</a>
<ul>
<li class="chapter" data-level="6.1" data-path="statsactivity.html"><a href="statsactivity.html#problem-1-1"><i class="fa fa-check"></i><b>6.1</b> Problem 1</a></li>
<li class="chapter" data-level="6.2" data-path="statsactivity.html"><a href="statsactivity.html#problem-2-1"><i class="fa fa-check"></i><b>6.2</b> Problem 2</a></li>
<li class="chapter" data-level="6.3" data-path="statsactivity.html"><a href="statsactivity.html#problem-3-1"><i class="fa fa-check"></i><b>6.3</b> Problem 3</a></li>
<li class="chapter" data-level="6.4" data-path="statsactivity.html"><a href="statsactivity.html#problem-4-1"><i class="fa fa-check"></i><b>6.4</b> Problem 4</a></li>
<li class="chapter" data-level="6.5" data-path="statsactivity.html"><a href="statsactivity.html#problem-5-1"><i class="fa fa-check"></i><b>6.5</b> Problem 5</a></li>
<li class="chapter" data-level="6.6" data-path="statsactivity.html"><a href="statsactivity.html#problem-6-1"><i class="fa fa-check"></i><b>6.6</b> Problem 6</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="getdata.html"><a href="getdata.html"><i class="fa fa-check"></i><b>7</b> Joins, Pivots, and USGS dataRetrieval</a>
<ul>
<li class="chapter" data-level="7.1" data-path="getdata.html"><a href="getdata.html#goals-for-today"><i class="fa fa-check"></i><b>7.1</b> Goals for today</a></li>
<li class="chapter" data-level="7.2" data-path="getdata.html"><a href="getdata.html#exploring-what-dataretrieval-can-do."><i class="fa fa-check"></i><b>7.2</b> Exploring what dataRetrieval can do.</a></li>
<li class="chapter" data-level="7.3" data-path="getdata.html"><a href="getdata.html#joins"><i class="fa fa-check"></i><b>7.3</b> Joins</a></li>
<li class="chapter" data-level="7.4" data-path="getdata.html"><a href="getdata.html#join-example"><i class="fa fa-check"></i><b>7.4</b> Join example</a></li>
<li class="chapter" data-level="7.5" data-path="getdata.html"><a href="getdata.html#finding-ids-to-download-usgs-data"><i class="fa fa-check"></i><b>7.5</b> Finding IDs to download USGS data</a></li>
<li class="chapter" data-level="7.6" data-path="getdata.html"><a href="getdata.html#ok-lets-download-some-data"><i class="fa fa-check"></i><b>7.6</b> OK let’s download some data!</a></li>
<li class="chapter" data-level="7.7" data-path="getdata.html"><a href="getdata.html#pivoting-wide-and-long-data"><i class="fa fa-check"></i><b>7.7</b> Pivoting: wide and long data</a></li>
<li class="chapter" data-level="7.8" data-path="getdata.html"><a href="getdata.html#pivot-examples"><i class="fa fa-check"></i><b>7.8</b> Pivot Examples</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="joinpivotDR.html"><a href="joinpivotDR.html"><i class="fa fa-check"></i><b>8</b> ACTIVITY: Joins Pivots dataRetrieval</a>
<ul>
<li class="chapter" data-level="8.1" data-path="joinpivotDR.html"><a href="joinpivotDR.html#load-the-tidyverse-dataretrieval-and-patchwork-packages."><i class="fa fa-check"></i><b>8.1</b> Load the tidyverse, dataRetrieval, and patchwork packages.</a></li>
<li class="chapter" data-level="8.2" data-path="joinpivotDR.html"><a href="joinpivotDR.html#problem-1-2"><i class="fa fa-check"></i><b>8.2</b> Problem 1</a></li>
<li class="chapter" data-level="8.3" data-path="joinpivotDR.html"><a href="joinpivotDR.html#problem-2-2"><i class="fa fa-check"></i><b>8.3</b> Problem 2</a></li>
<li class="chapter" data-level="8.4" data-path="joinpivotDR.html"><a href="joinpivotDR.html#problem-3-2"><i class="fa fa-check"></i><b>8.4</b> Problem 3</a></li>
<li class="chapter" data-level="8.5" data-path="joinpivotDR.html"><a href="joinpivotDR.html#problem-4-2"><i class="fa fa-check"></i><b>8.5</b> Problem 4</a></li>
<li class="chapter" data-level="8.6" data-path="joinpivotDR.html"><a href="joinpivotDR.html#problem-5-2"><i class="fa fa-check"></i><b>8.6</b> Problem 5</a></li>
<li class="chapter" data-level="8.7" data-path="joinpivotDR.html"><a href="joinpivotDR.html#problem-6-2"><i class="fa fa-check"></i><b>8.7</b> Problem 6</a></li>
<li class="chapter" data-level="8.8" data-path="joinpivotDR.html"><a href="joinpivotDR.html#problem-7"><i class="fa fa-check"></i><b>8.8</b> Problem 7</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Summative1.html"><a href="Summative1.html"><i class="fa fa-check"></i><b>9</b> ACTIVITY Summative 1</a>
<ul>
<li class="chapter" data-level="9.0.1" data-path="Summative1.html"><a href="Summative1.html#instructions"><i class="fa fa-check"></i><b>9.0.1</b> Instructions</a></li>
<li class="chapter" data-level="9.1" data-path="Summative1.html"><a href="Summative1.html#problem-1-3"><i class="fa fa-check"></i><b>9.1</b> Problem 1</a></li>
<li class="chapter" data-level="9.2" data-path="Summative1.html"><a href="Summative1.html#problem-2-3"><i class="fa fa-check"></i><b>9.2</b> Problem 2</a></li>
<li class="chapter" data-level="9.3" data-path="Summative1.html"><a href="Summative1.html#problem-3-3"><i class="fa fa-check"></i><b>9.3</b> Problem 3</a></li>
<li class="chapter" data-level="9.4" data-path="Summative1.html"><a href="Summative1.html#problem-4-3"><i class="fa fa-check"></i><b>9.4</b> Problem 4</a></li>
<li class="chapter" data-level="9.5" data-path="Summative1.html"><a href="Summative1.html#problem-5-3"><i class="fa fa-check"></i><b>9.5</b> Problem 5</a></li>
<li class="chapter" data-level="9.6" data-path="Summative1.html"><a href="Summative1.html#problem-6-3"><i class="fa fa-check"></i><b>9.6</b> Problem 6</a></li>
<li class="chapter" data-level="9.7" data-path="Summative1.html"><a href="Summative1.html#problem-7-1"><i class="fa fa-check"></i><b>9.7</b> Problem 7</a></li>
<li class="chapter" data-level="9.8" data-path="Summative1.html"><a href="Summative1.html#problem-8"><i class="fa fa-check"></i><b>9.8</b> Problem 8</a></li>
<li class="chapter" data-level="9.9" data-path="Summative1.html"><a href="Summative1.html#problem-9"><i class="fa fa-check"></i><b>9.9</b> Problem 9</a></li>
<li class="chapter" data-level="9.10" data-path="Summative1.html"><a href="Summative1.html#problem-10"><i class="fa fa-check"></i><b>9.10</b> Problem 10</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="fdcs.html"><a href="fdcs.html"><i class="fa fa-check"></i><b>10</b> Flow Duration Curves</a>
<ul>
<li class="chapter" data-level="10.1" data-path="fdcs.html"><a href="fdcs.html#get-data"><i class="fa fa-check"></i><b>10.1</b> Get data</a></li>
<li class="chapter" data-level="10.2" data-path="fdcs.html"><a href="fdcs.html#review-describe-the-distribution"><i class="fa fa-check"></i><b>10.2</b> Review: describe the distribution</a></li>
<li class="chapter" data-level="10.3" data-path="fdcs.html"><a href="fdcs.html#ecdfs"><i class="fa fa-check"></i><b>10.3</b> ECDFs</a></li>
<li class="chapter" data-level="10.4" data-path="fdcs.html"><a href="fdcs.html#calculate-flow-exceedence-probabilities"><i class="fa fa-check"></i><b>10.4</b> Calculate flow exceedence probabilities</a></li>
<li class="chapter" data-level="10.5" data-path="fdcs.html"><a href="fdcs.html#plot-a-flow-duration-curve-using-the-probabilities"><i class="fa fa-check"></i><b>10.5</b> Plot a Flow Duration Curve using the probabilities</a></li>
<li class="chapter" data-level="10.6" data-path="fdcs.html"><a href="fdcs.html#make-an-almost-fdc-with-stat_ecdf"><i class="fa fa-check"></i><b>10.6</b> Make an almost FDC with stat_ecdf</a></li>
<li class="chapter" data-level="10.7" data-path="fdcs.html"><a href="fdcs.html#example-use-of-an-fdc"><i class="fa fa-check"></i><b>10.7</b> Example use of an FDC</a></li>
<li class="chapter" data-level="10.8" data-path="fdcs.html"><a href="fdcs.html#compare-to-a-boxplot-of-the-same-data"><i class="fa fa-check"></i><b>10.8</b> Compare to a boxplot of the same data</a></li>
<li class="chapter" data-level="10.9" data-path="fdcs.html"><a href="fdcs.html#challenge-examining-flow-regime-change-at-the-grand-canyon"><i class="fa fa-check"></i><b>10.9</b> Challenge: Examining flow regime change at the Grand Canyon</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="lfas.html"><a href="lfas.html"><i class="fa fa-check"></i><b>11</b> Low Flow Analysis</a>
<ul>
<li class="chapter" data-level="11.1" data-path="lfas.html"><a href="lfas.html#what-are-low-flow-statistics"><i class="fa fa-check"></i><b>11.1</b> What are low flow statistics?</a></li>
<li class="chapter" data-level="11.2" data-path="lfas.html"><a href="lfas.html#get-data-1"><i class="fa fa-check"></i><b>11.2</b> Get data</a></li>
<li class="chapter" data-level="11.3" data-path="lfas.html"><a href="lfas.html#create-the-x-days-average-flow-record"><i class="fa fa-check"></i><b>11.3</b> Create the X days average flow record</a></li>
<li class="chapter" data-level="11.4" data-path="lfas.html"><a href="lfas.html#look-at-what-a-rolling-mean-does."><i class="fa fa-check"></i><b>11.4</b> Look at what a rolling mean does.</a></li>
<li class="chapter" data-level="11.5" data-path="lfas.html"><a href="lfas.html#calculate-yearly-minimums"><i class="fa fa-check"></i><b>11.5</b> Calculate yearly minimums</a></li>
<li class="chapter" data-level="11.6" data-path="lfas.html"><a href="lfas.html#calculate-return-interval"><i class="fa fa-check"></i><b>11.6</b> Calculate return interval</a></li>
<li class="chapter" data-level="11.7" data-path="lfas.html"><a href="lfas.html#fit-to-pearson-type-iii-distribution"><i class="fa fa-check"></i><b>11.7</b> Fit to Pearson Type III distribution</a></li>
<li class="chapter" data-level="11.8" data-path="lfas.html"><a href="lfas.html#distribution-free-method"><i class="fa fa-check"></i><b>11.8</b> Distribution-free method</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="floods.html"><a href="floods.html"><i class="fa fa-check"></i><b>12</b> Flood Frequency Analysis and Creating Functions</a>
<ul>
<li class="chapter" data-level="12.1" data-path="floods.html"><a href="floods.html#template-repository"><i class="fa fa-check"></i><b>12.1</b> Template Repository</a></li>
<li class="chapter" data-level="12.2" data-path="floods.html"><a href="floods.html#intro"><i class="fa fa-check"></i><b>12.2</b> Intro</a></li>
<li class="chapter" data-level="12.3" data-path="floods.html"><a href="floods.html#challenge-create-a-function"><i class="fa fa-check"></i><b>12.3</b> Challenge: Create a function</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="rgeospatial.html"><a href="rgeospatial.html"><i class="fa fa-check"></i><b>13</b> Geospatial data in R - Vector</a>
<ul>
<li class="chapter" data-level="13.1" data-path="rgeospatial.html"><a href="rgeospatial.html#goals"><i class="fa fa-check"></i><b>13.1</b> Goals</a></li>
<li class="chapter" data-level="13.2" data-path="rgeospatial.html"><a href="rgeospatial.html#intro-to-tmap"><i class="fa fa-check"></i><b>13.2</b> Intro to tmap</a></li>
<li class="chapter" data-level="13.3" data-path="rgeospatial.html"><a href="rgeospatial.html#data-wrangling-with-tidyverse-principles"><i class="fa fa-check"></i><b>13.3</b> Data wrangling with tidyverse principles</a></li>
<li class="chapter" data-level="13.4" data-path="rgeospatial.html"><a href="rgeospatial.html#plot-maps-side-by-side"><i class="fa fa-check"></i><b>13.4</b> Plot maps side by side</a></li>
<li class="chapter" data-level="13.5" data-path="rgeospatial.html"><a href="rgeospatial.html#built-in-styles-like-themes-in-ggplot"><i class="fa fa-check"></i><b>13.5</b> Built in styles, like themes in ggplot</a></li>
<li class="chapter" data-level="13.6" data-path="rgeospatial.html"><a href="rgeospatial.html#interactive-maps"><i class="fa fa-check"></i><b>13.6</b> Interactive Maps</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="rgeospatial.html"><a href="rgeospatial.html#tmap"><i class="fa fa-check"></i><b>13.6.1</b> tmap</a></li>
<li class="chapter" data-level="13.6.2" data-path="rgeospatial.html"><a href="rgeospatial.html#leaflet"><i class="fa fa-check"></i><b>13.6.2</b> Leaflet</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="summative2.html"><a href="summative2.html"><i class="fa fa-check"></i><b>14</b> Summative Assessment 2</a>
<ul>
<li class="chapter" data-level="14.1" data-path="summative2.html"><a href="summative2.html#info-for-assessment"><i class="fa fa-check"></i><b>14.1</b> Info for assessment</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="rgeoraster.html"><a href="rgeoraster.html"><i class="fa fa-check"></i><b>15</b> Geospatial R Raster - Hydro Analyses</a>
<ul>
<li class="chapter" data-level="15.1" data-path="rgeoraster.html"><a href="rgeoraster.html#introduction-2"><i class="fa fa-check"></i><b>15.1</b> Introduction</a></li>
<li class="chapter" data-level="15.2" data-path="rgeoraster.html"><a href="rgeoraster.html#read-in-dem"><i class="fa fa-check"></i><b>15.2</b> Read in DEM</a></li>
<li class="chapter" data-level="15.3" data-path="rgeoraster.html"><a href="rgeoraster.html#plot-dem"><i class="fa fa-check"></i><b>15.3</b> Plot DEM</a></li>
<li class="chapter" data-level="15.4" data-path="rgeoraster.html"><a href="rgeoraster.html#generate-a-hillshade"><i class="fa fa-check"></i><b>15.4</b> Generate a hillshade</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="rgeoraster.html"><a href="rgeoraster.html#how-whitebox-tools-functions-work"><i class="fa fa-check"></i><b>15.4.1</b> How whitebox tools functions work</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="rgeoraster.html"><a href="rgeoraster.html#prepare-dem-for-hydrology-analyses"><i class="fa fa-check"></i><b>15.5</b> Prepare DEM for Hydrology Analyses</a></li>
<li class="chapter" data-level="15.6" data-path="rgeoraster.html"><a href="rgeoraster.html#visualize-filled-sinks-and-breached-depressions"><i class="fa fa-check"></i><b>15.6</b> Visualize filled sinks and breached depressions</a></li>
<li class="chapter" data-level="15.7" data-path="rgeoraster.html"><a href="rgeoraster.html#d8-flow-accumulation"><i class="fa fa-check"></i><b>15.7</b> D8 Flow Accumulation</a></li>
<li class="chapter" data-level="15.8" data-path="rgeoraster.html"><a href="rgeoraster.html#d-infinity-flow-accumulation"><i class="fa fa-check"></i><b>15.8</b> D infinity flow accumulation</a></li>
<li class="chapter" data-level="15.9" data-path="rgeoraster.html"><a href="rgeoraster.html#topographic-wetness-index"><i class="fa fa-check"></i><b>15.9</b> Topographic Wetness Index</a></li>
<li class="chapter" data-level="15.10" data-path="rgeoraster.html"><a href="rgeoraster.html#downslope-twi"><i class="fa fa-check"></i><b>15.10</b> Downslope TWI</a></li>
<li class="chapter" data-level="15.11" data-path="rgeoraster.html"><a href="rgeoraster.html#map-stream-network"><i class="fa fa-check"></i><b>15.11</b> Map Stream Network</a></li>
<li class="chapter" data-level="15.12" data-path="rgeoraster.html"><a href="rgeoraster.html#extract-raster-values-to-point-locations"><i class="fa fa-check"></i><b>15.12</b> Extract raster values to point locations</a>
<ul>
<li class="chapter" data-level="15.12.1" data-path="rgeoraster.html"><a href="rgeoraster.html#import-and-plot-points"><i class="fa fa-check"></i><b>15.12.1</b> Import and plot points</a></li>
<li class="chapter" data-level="15.12.2" data-path="rgeoraster.html"><a href="rgeoraster.html#extract-values-from-multiple-rasters-at-once"><i class="fa fa-check"></i><b>15.12.2</b> Extract values from multiple rasters at once</a></li>
</ul></li>
<li class="chapter" data-level="15.13" data-path="rgeoraster.html"><a href="rgeoraster.html#view-raster-data-as-a-pdf-or-histogram"><i class="fa fa-check"></i><b>15.13</b> View raster data as a PDF or histogram</a></li>
<li class="chapter" data-level="15.14" data-path="rgeoraster.html"><a href="rgeoraster.html#subsetting-a-raster-for-visualization"><i class="fa fa-check"></i><b>15.14</b> Subsetting a raster for visualization</a></li>
<li class="chapter" data-level="15.15" data-path="rgeoraster.html"><a href="rgeoraster.html#raster-math"><i class="fa fa-check"></i><b>15.15</b> Raster Math</a></li>
<li class="chapter" data-level="15.16" data-path="rgeoraster.html"><a href="rgeoraster.html#extra-plot-topo-characteristics-against-one-another"><i class="fa fa-check"></i><b>15.16</b> Extra: plot topo characteristics against one another</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html"><i class="fa fa-check"></i><b>16</b> Geospatial R Raster - Watershed Delineation</a>
<ul>
<li class="chapter" data-level="16.1" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#introduction-3"><i class="fa fa-check"></i><b>16.1</b> Introduction</a></li>
<li class="chapter" data-level="16.2" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#the-watershed-delineation-toolprocess"><i class="fa fa-check"></i><b>16.2</b> The watershed delineation tool/process</a></li>
<li class="chapter" data-level="16.3" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#read-in-dem-1"><i class="fa fa-check"></i><b>16.3</b> Read in DEM</a></li>
<li class="chapter" data-level="16.4" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#generate-a-hillshade-1"><i class="fa fa-check"></i><b>16.4</b> Generate a hillshade</a></li>
<li class="chapter" data-level="16.5" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#prepare-dem-for-hydrology-analyses-1"><i class="fa fa-check"></i><b>16.5</b> Prepare DEM for Hydrology Analyses</a></li>
<li class="chapter" data-level="16.6" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#create-flow-accumulation-and-pointer-grids"><i class="fa fa-check"></i><b>16.6</b> Create flow accumulation and pointer grids</a></li>
<li class="chapter" data-level="16.7" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#setting-pour-points"><i class="fa fa-check"></i><b>16.7</b> Setting pour points</a></li>
<li class="chapter" data-level="16.8" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#delineate-watersheds"><i class="fa fa-check"></i><b>16.8</b> Delineate watersheds</a></li>
<li class="chapter" data-level="16.9" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#convert-watersheds-to-shapefiles"><i class="fa fa-check"></i><b>16.9</b> Convert watersheds to shapefiles</a></li>
<li class="chapter" data-level="16.10" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#extract-data-based-on-watershed-outline"><i class="fa fa-check"></i><b>16.10</b> Extract data based on watershed outline</a></li>
<li class="chapter" data-level="16.11" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#bonus-make-a-3d-map-of-your-watershed-with-rayshader"><i class="fa fa-check"></i><b>16.11</b> BONUS: Make a 3d map of your watershed with rayshader</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="modelingintro.html"><a href="modelingintro.html"><i class="fa fa-check"></i><b>17</b> Intro to Modeling - Getting Started with HBV</a>
<ul>
<li class="chapter" data-level="17.1" data-path="modelingintro.html"><a href="modelingintro.html#introduction-4"><i class="fa fa-check"></i><b>17.1</b> Introduction</a></li>
<li class="chapter" data-level="17.2" data-path="modelingintro.html"><a href="modelingintro.html#creating-the-hbv-model-function"><i class="fa fa-check"></i><b>17.2</b> Creating the HBV model function</a></li>
<li class="chapter" data-level="17.3" data-path="modelingintro.html"><a href="modelingintro.html#read-in-precip-and-temp"><i class="fa fa-check"></i><b>17.3</b> Read in Precip and Temp</a></li>
<li class="chapter" data-level="17.4" data-path="modelingintro.html"><a href="modelingintro.html#calculate-pet"><i class="fa fa-check"></i><b>17.4</b> Calculate PET</a></li>
<li class="chapter" data-level="17.5" data-path="modelingintro.html"><a href="modelingintro.html#hbv-parameters"><i class="fa fa-check"></i><b>17.5</b> HBV Parameters</a></li>
<li class="chapter" data-level="17.6" data-path="modelingintro.html"><a href="modelingintro.html#first-model-run"><i class="fa fa-check"></i><b>17.6</b> First model run</a></li>
<li class="chapter" data-level="17.7" data-path="modelingintro.html"><a href="modelingintro.html#import-observed-streamflow-data"><i class="fa fa-check"></i><b>17.7</b> Import observed streamflow data</a></li>
<li class="chapter" data-level="17.8" data-path="modelingintro.html"><a href="modelingintro.html#compare-observed-and-modeled-discharge-graphically"><i class="fa fa-check"></i><b>17.8</b> Compare observed and modeled discharge graphically</a></li>
<li class="chapter" data-level="17.9" data-path="modelingintro.html"><a href="modelingintro.html#compare-observed-and-modelled-discharge-with-interactive-graph"><i class="fa fa-check"></i><b>17.9</b> Compare observed and modelled discharge with interactive graph</a></li>
<li class="chapter" data-level="17.10" data-path="modelingintro.html"><a href="modelingintro.html#measure-how-well-the-model-fits-with-nse"><i class="fa fa-check"></i><b>17.10</b> Measure how well the model fits with NSE</a></li>
<li class="chapter" data-level="17.11" data-path="modelingintro.html"><a href="modelingintro.html#assess-model-fit-with-a-different-measure-snow"><i class="fa fa-check"></i><b>17.11</b> Assess model fit with a different measure: Snow</a></li>
<li class="chapter" data-level="17.12" data-path="modelingintro.html"><a href="modelingintro.html#calibrate-hbv-manually"><i class="fa fa-check"></i><b>17.12</b> Calibrate HBV manually</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="modelingcalibration.html"><a href="modelingcalibration.html"><i class="fa fa-check"></i><b>18</b> Intro to Modeling - Calibrate HBV</a>
<ul>
<li class="chapter" data-level="18.1" data-path="modelingcalibration.html"><a href="modelingcalibration.html#introduction-5"><i class="fa fa-check"></i><b>18.1</b> Introduction</a></li>
<li class="chapter" data-level="18.2" data-path="modelingcalibration.html"><a href="modelingcalibration.html#challenge-write-a-for-loop"><i class="fa fa-check"></i><b>18.2</b> Challenge: Write a for loop</a></li>
<li class="chapter" data-level="18.3" data-path="modelingcalibration.html"><a href="modelingcalibration.html#prep-data-for-hbv"><i class="fa fa-check"></i><b>18.3</b> Prep data for HBV</a></li>
<li class="chapter" data-level="18.4" data-path="modelingcalibration.html"><a href="modelingcalibration.html#calculate-pet-1"><i class="fa fa-check"></i><b>18.4</b> Calculate PET</a></li>
<li class="chapter" data-level="18.5" data-path="modelingcalibration.html"><a href="modelingcalibration.html#monte-carlo-step-1-generate-random-parameter-sets"><i class="fa fa-check"></i><b>18.5</b> Monte Carlo step 1: generate random parameter sets</a></li>
<li class="chapter" data-level="18.6" data-path="modelingcalibration.html"><a href="modelingcalibration.html#run-the-model-for-each-parameter-set"><i class="fa fa-check"></i><b>18.6</b> Run the model for each parameter set</a></li>
<li class="chapter" data-level="18.7" data-path="modelingcalibration.html"><a href="modelingcalibration.html#find-the-best-parameter-set"><i class="fa fa-check"></i><b>18.7</b> Find the best parameter set</a></li>
<li class="chapter" data-level="18.8" data-path="modelingcalibration.html"><a href="modelingcalibration.html#investigating-a-much-bigger-monte-carlo"><i class="fa fa-check"></i><b>18.8</b> Investigating a much bigger Monte Carlo</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Hydroinformatics at VT</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelingintro" class="section level1 hasAnchor" number="17">
<h1><span class="header-section-number">Chapter 17</span> Intro to Modeling - Getting Started with HBV<a href="modelingintro.html#modelingintro" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-4" class="section level2 hasAnchor" number="17.1">
<h2><span class="header-section-number">17.1</span> Introduction<a href="modelingintro.html#introduction-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The following activity is available as a template github repository at the following link: <a href="https://github.com/VT-Hydroinformatics/16-Intro-Modeling-HBV" class="uri">https://github.com/VT-Hydroinformatics/16-Intro-Modeling-HBV</a></p>
<p><strong>Before we start with the code below, we will briefly discuss modeling in general, using the following reading as a guide: <a href="https://cfpub.epa.gov/si/si_public_record_report.cfm?dirEntryId=339328&amp;Lab=NERL" class="uri">https://cfpub.epa.gov/si/si_public_record_report.cfm?dirEntryId=339328&amp;Lab=NERL</a></strong></p>
<p><strong>Please be prepared to discuss the reading at the start of class.</strong></p>
<p><em>Goals for this activity:</em></p>
<ul>
<li>Become familiar with the process of running a simple hydrologic model</li>
<li>Try parameterizing the model manually</li>
<li>Introduction to methods of assessing model success</li>
</ul>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="modelingintro.html#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb266-2"><a href="modelingintro.html#cb266-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb266-3"><a href="modelingintro.html#cb266-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb266-4"><a href="modelingintro.html#cb266-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb266-5"><a href="modelingintro.html#cb266-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-6"><a href="modelingintro.html#cb266-6" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>())</span></code></pre></div>
</div>
<div id="creating-the-hbv-model-function" class="section level2 hasAnchor" number="17.2">
<h2><span class="header-section-number">17.2</span> Creating the HBV model function<a href="modelingintro.html#creating-the-hbv-model-function" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The code for the HBV model is in the HBV folder, it is called <em>HBV.R</em>. We will open that and look at the code a bit to discuss how HBV works.</p>
<p>The code in HBV.R creates a function that runs the HBV model. We can run that code by using the source() function in. When we give the location of the HBV.R file to source(), it runs the code and creates the HBV function. Run the line of code below, then type HBV( and you’ll see the input parameters pop up just like any other function.</p>
<p>From this we see that HBV takes as input pars, P, Temp, PET, and routing.</p>
<p>pars is a vector of all the parameters that HBV uses to run (discussed below)
P is a vector of precipitation values
Temp is a vector of temperature values
PET is a vector of PET values
And routing is a parameter that controls how water is routes through the channel of larger watersheds. We will not use this because we are running the model on a small watershed.</p>
<p>HBV is a lumped conceptual model. We will use the diagram below and the HBV.R code to discuss how the model works and get an idea of what the parameters do.</p>
<p><img src="images/HBV-schem-Shrestha-Solomantine-2008.png" title="HBV Model" alt="HBV Model" />
This schematic was reproduced from: Durga Lal Shrestha &amp; Dimitri P. Solomatine (2008) Data‐driven approaches for estimating uncertainty in rainfall‐runoff modelling, International Journal of River Basin Management, 6:2, 109-122, DOI: 10.1080/15715124.2008.9635341</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="modelingintro.html#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&#39;HBV/HBV.R&#39;</span>)</span></code></pre></div>
</div>
<div id="read-in-precip-and-temp" class="section level2 hasAnchor" number="17.3">
<h2><span class="header-section-number">17.3</span> Read in Precip and Temp<a href="modelingintro.html#read-in-precip-and-temp" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Our objective today is basically to get the model running with data from watershed 3 at the Hubbard Brook experimental forest in NH, USA.</p>
<p>Watershed 3 is a hydrologic reference watershed at HBEF. This means it hasn’t been experimentally manipulated, but discharge, temperature, and precipitation have been recorded there for a long time. This makes it a good candidate for some modeling! You can see more about watershed 3 here: <a href="https://hubbardbrook.org/watersheds/watershed-3" class="uri">https://hubbardbrook.org/watersheds/watershed-3</a></p>
<p>As we saw in the chunk above, we need P, Temp, PET, and a set of parameters to run the model.</p>
<p>We will talk parameters later, but for now we need the data that drives the model: P, Temp, and PET.</p>
<p>We have P and Temp. The data is in Pwd2009-2012.csv and Tdm2009-2012.csv.</p>
<p>So how do we get PET?</p>
<p>We calculate it! But before we do that let’s bring in the precip and temp data and format them how the model wants them.</p>
<p>Our model function just wants a vector of values. No dates attached. So we must be careful that each set of input data is for the same amount of time with the same number of values. To help with that, we will start below by defining and start and end date for the model run.</p>
<p>Finally, we will read in the data, select the gage or station we want to represent the watershed, change the format of the date column, and then filter to our start and end date.</p>
<p>Then we will pull out just the data, so it can be passed to the model.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="modelingintro.html#cb268-1" aria-hidden="true" tabindex="-1"></a>start <span class="ot">&lt;-</span> <span class="fu">mdy</span>(<span class="st">&quot;01-01-2009&quot;</span>)</span>
<span id="cb268-2"><a href="modelingintro.html#cb268-2" aria-hidden="true" tabindex="-1"></a>end <span class="ot">&lt;-</span> <span class="fu">mdy</span>(<span class="st">&quot;12-31-2012&quot;</span>)</span>
<span id="cb268-3"><a href="modelingintro.html#cb268-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-4"><a href="modelingintro.html#cb268-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Precip</span></span>
<span id="cb268-5"><a href="modelingintro.html#cb268-5" aria-hidden="true" tabindex="-1"></a>P1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;HBV/Pwd2009-2012.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb268-6"><a href="modelingintro.html#cb268-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">select</span>(DATE, WS_3) <span class="sc">%&gt;%</span></span>
<span id="cb268-7"><a href="modelingintro.html#cb268-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">DATE =</span> <span class="fu">ymd</span>(DATE)) <span class="sc">%&gt;%</span></span>
<span id="cb268-8"><a href="modelingintro.html#cb268-8" aria-hidden="true" tabindex="-1"></a>         <span class="fu">filter</span>(DATE <span class="sc">&gt;=</span> start <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end)</span></code></pre></div>
<pre><code>## Rows: 1461 Columns: 10
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## dbl (10): DATE, WS_1, WS_2, WS_3, WS_4, WS_5, WS_6, WS_7, WS_8, WS_9
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="modelingintro.html#cb270-1" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> P1<span class="sc">$</span>WS_3</span>
<span id="cb270-2"><a href="modelingintro.html#cb270-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-3"><a href="modelingintro.html#cb270-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Temp in deg C</span></span>
<span id="cb270-4"><a href="modelingintro.html#cb270-4" aria-hidden="true" tabindex="-1"></a>Temp1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;HBV/Tdm2009-2012.csv&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb270-5"><a href="modelingintro.html#cb270-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">select</span>(DATE, STA_1) <span class="sc">%&gt;%</span></span>
<span id="cb270-6"><a href="modelingintro.html#cb270-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">DATE =</span> <span class="fu">ymd</span>(DATE)) <span class="sc">%&gt;%</span></span>
<span id="cb270-7"><a href="modelingintro.html#cb270-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">filter</span>(DATE <span class="sc">&gt;=</span> start <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end)</span></code></pre></div>
<pre><code>## Rows: 1461 Columns: 9
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## dbl (9): DATE, STA_1, STA_6, STA_14, STA_INT, STA_HQ, STA_23, STA_17, STA_24
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="modelingintro.html#cb272-1" aria-hidden="true" tabindex="-1"></a>Temp <span class="ot">&lt;-</span> Temp1<span class="sc">$</span>STA_1</span></code></pre></div>
</div>
<div id="calculate-pet" class="section level2 hasAnchor" number="17.4">
<h2><span class="header-section-number">17.4</span> Calculate PET<a href="modelingintro.html#calculate-pet" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Next, we need to calculate PET for the same time reange as our temperature and precipitation record.</p>
<p>We will use the Hamon method to calculate PET for each day of the record.</p>
<p>To do that we will take the latitude of the site in radians…</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="modelingintro.html#cb273-1" aria-hidden="true" tabindex="-1"></a>lat <span class="ot">&lt;-</span> <span class="dv">43</span> <span class="sc">+</span> <span class="dv">57</span><span class="sc">/</span><span class="dv">60</span> <span class="co">#43 degrees and 57 minutes</span></span>
<span id="cb273-2"><a href="modelingintro.html#cb273-2" aria-hidden="true" tabindex="-1"></a>latrad <span class="ot">&lt;-</span> (lat<span class="sc">/</span><span class="dv">360</span>) <span class="sc">*</span> <span class="dv">2</span> <span class="sc">*</span> pi <span class="co">#convert to radians</span></span>
<span id="cb273-3"><a href="modelingintro.html#cb273-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-4"><a href="modelingintro.html#cb273-4" aria-hidden="true" tabindex="-1"></a>PET1 <span class="ot">&lt;-</span> <span class="fu">select</span>(Temp1, DATE) <span class="sc">%&gt;%</span></span>
<span id="cb273-5"><a href="modelingintro.html#cb273-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">DOY =</span> <span class="fu">yday</span>(DATE)) <span class="sc">%&gt;%</span> <span class="co">#DOY for dates</span></span>
<span id="cb273-6"><a href="modelingintro.html#cb273-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">tempvar =</span> (<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">365</span>) <span class="sc">*</span> DOY) <span class="sc">%&gt;%</span></span>
<span id="cb273-7"><a href="modelingintro.html#cb273-7" aria-hidden="true" tabindex="-1"></a>         <span class="co">#declination of the sun above the celestial equator in </span></span>
<span id="cb273-8"><a href="modelingintro.html#cb273-8" aria-hidden="true" tabindex="-1"></a>         <span class="co">#radians on day JulDay of the year</span></span>
<span id="cb273-9"><a href="modelingintro.html#cb273-9" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">delta_h =</span> <span class="fl">0.4093</span> <span class="sc">*</span> <span class="fu">sin</span>(tempvar <span class="sc">-</span> <span class="fl">1.405</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb273-10"><a href="modelingintro.html#cb273-10" aria-hidden="true" tabindex="-1"></a>         <span class="co">#day length in h</span></span>
<span id="cb273-11"><a href="modelingintro.html#cb273-11" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">daylen =</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">acos</span>(<span class="sc">-</span><span class="fu">tan</span>(delta_h) <span class="sc">*</span> <span class="fu">tan</span>(latrad)) <span class="sc">/</span> <span class="fl">0.2618</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb273-12"><a href="modelingintro.html#cb273-12" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(</span>
<span id="cb273-13"><a href="modelingintro.html#cb273-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">PET =</span> <span class="fl">29.8</span> <span class="sc">*</span> daylen <span class="sc">*</span> <span class="fl">0.611</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">17.3</span> <span class="sc">*</span> Temp <span class="sc">/</span> </span>
<span id="cb273-14"><a href="modelingintro.html#cb273-14" aria-hidden="true" tabindex="-1"></a>                  (Temp <span class="sc">+</span> <span class="fl">237.3</span>)) <span class="sc">/</span> (Temp <span class="sc">+</span> <span class="fl">273.2</span>))  <span class="co">#PET Hamon method</span></span>
<span id="cb273-15"><a href="modelingintro.html#cb273-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-16"><a href="modelingintro.html#cb273-16" aria-hidden="true" tabindex="-1"></a>PET <span class="ot">&lt;-</span> PET1<span class="sc">$</span>PET</span></code></pre></div>
</div>
<div id="hbv-parameters" class="section level2 hasAnchor" number="17.5">
<h2><span class="header-section-number">17.5</span> HBV Parameters<a href="modelingintro.html#hbv-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Okay, so now we have our data set up. Next we need to talk parameters.</p>
<p>The table below shows the parameters of the HBV model, the minimum and maximum for those values, and a description of their function in the model.</p>
<table>
<colgroup>
<col width="32%" />
<col width="17%" />
<col width="14%" />
<col width="35%" />
</colgroup>
<thead>
<tr class="header">
<th>Object Name</th>
<th>Min</th>
<th>Max</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>FC</td>
<td>40</td>
<td>400</td>
<td>Max soil moisture storage, field capacity</td>
</tr>
<tr class="even">
<td>beta</td>
<td>1</td>
<td>6</td>
<td>Shape coefficient governing fate of water input to soil moisture storage</td>
</tr>
<tr class="odd">
<td>LP</td>
<td>.3</td>
<td>1</td>
<td>Threshold for reduction of evaporation</td>
</tr>
<tr class="even">
<td>SFCF</td>
<td>0.4</td>
<td>1.2</td>
<td>Snowfall correction factor</td>
</tr>
<tr class="odd">
<td>TT</td>
<td>-1.5</td>
<td>1.2</td>
<td>Threshold temperature</td>
</tr>
<tr class="even">
<td>CFMAX</td>
<td>1</td>
<td>8</td>
<td>Degree-day factor</td>
</tr>
<tr class="odd">
<td>k0</td>
<td>0.05</td>
<td>0.5</td>
<td>Recession constant (upper storage, near surface)</td>
</tr>
<tr class="even">
<td>k1</td>
<td>0.01</td>
<td>0.3</td>
<td>Recession constant (upper storage)</td>
</tr>
<tr class="odd">
<td>k2</td>
<td>0.001</td>
<td>0.15</td>
<td>Recession constant (lower storage)</td>
</tr>
<tr class="even">
<td>UZL</td>
<td>0</td>
<td>70</td>
<td>Threshold for shallow storage</td>
</tr>
<tr class="odd">
<td>PERC</td>
<td>0</td>
<td>4</td>
<td>Percolation, max flow from upper to lower storage</td>
</tr>
<tr class="even">
<td>MAXBAS</td>
<td>1</td>
<td>3</td>
<td>base of the triangular routing function, days”</td>
</tr>
</tbody>
</table>
<p>To pass a set of parameters to the model, we just put them into a single vector in the order they are in the table above. In the chunk below, I’ve structured this to make it easy to see a description of each parameter, but you could also just do it in one line without all the comments. Just be sure to get the order right!</p>
<p>The code below sets the routing to 0, which is what we want for a small catchment.</p>
<p>Then I just set each parameter to it’s minimum value. We will use this parameter set to run the model and see what happens!</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="modelingintro.html#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co">#when this term = 1, then triangular routing is invoked, or for no routing, routing = 0</span></span>
<span id="cb274-2"><a href="modelingintro.html#cb274-2" aria-hidden="true" tabindex="-1"></a><span class="co">#if routing = 0 then MAXBAS doesn&#39;t do anything</span></span>
<span id="cb274-3"><a href="modelingintro.html#cb274-3" aria-hidden="true" tabindex="-1"></a>routing <span class="ot">&lt;-</span> <span class="dv">0</span>      </span>
<span id="cb274-4"><a href="modelingintro.html#cb274-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-5"><a href="modelingintro.html#cb274-5" aria-hidden="true" tabindex="-1"></a><span class="co">#hard code parameters </span></span>
<span id="cb274-6"><a href="modelingintro.html#cb274-6" aria-hidden="true" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">40</span>,    <span class="co">#FCM ax soil moisture storage, field capacity</span></span>
<span id="cb274-7"><a href="modelingintro.html#cb274-7" aria-hidden="true" tabindex="-1"></a>            <span class="dv">1</span>,     <span class="co">#beta Shape coefficient governing fate of water input to soil moisture storage</span></span>
<span id="cb274-8"><a href="modelingintro.html#cb274-8" aria-hidden="true" tabindex="-1"></a>            <span class="fl">0.3</span>,   <span class="co">#LP Threshold for reduction of evap</span></span>
<span id="cb274-9"><a href="modelingintro.html#cb274-9" aria-hidden="true" tabindex="-1"></a>            <span class="fl">0.4</span>,   <span class="co">#SFCF Snowfall correction factor</span></span>
<span id="cb274-10"><a href="modelingintro.html#cb274-10" aria-hidden="true" tabindex="-1"></a>            <span class="sc">-</span><span class="fl">1.5</span>,  <span class="co">#TT Threshold temperature</span></span>
<span id="cb274-11"><a href="modelingintro.html#cb274-11" aria-hidden="true" tabindex="-1"></a>            <span class="dv">1</span>,     <span class="co">#CFMAX Degree-day factor</span></span>
<span id="cb274-12"><a href="modelingintro.html#cb274-12" aria-hidden="true" tabindex="-1"></a>            <span class="fl">0.05</span>,  <span class="co">#k0 Recession constant (upper storage, near surface)</span></span>
<span id="cb274-13"><a href="modelingintro.html#cb274-13" aria-hidden="true" tabindex="-1"></a>            <span class="fl">0.01</span>,  <span class="co">#k1 Recession constant (upper storage)</span></span>
<span id="cb274-14"><a href="modelingintro.html#cb274-14" aria-hidden="true" tabindex="-1"></a>            <span class="fl">0.001</span>, <span class="co">#k2 Recession constant (lower storage)</span></span>
<span id="cb274-15"><a href="modelingintro.html#cb274-15" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span>,     <span class="co">#UZLThreshold for shallow storage</span></span>
<span id="cb274-16"><a href="modelingintro.html#cb274-16" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span>,     <span class="co">#PERC Percolation, max flow from upper to lower storage</span></span>
<span id="cb274-17"><a href="modelingintro.html#cb274-17" aria-hidden="true" tabindex="-1"></a>            <span class="dv">1</span>      <span class="co">#MAXBAS base of the triangular routing function, days</span></span>
<span id="cb274-18"><a href="modelingintro.html#cb274-18" aria-hidden="true" tabindex="-1"></a>            )</span></code></pre></div>
</div>
<div id="first-model-run" class="section level2 hasAnchor" number="17.6">
<h2><span class="header-section-number">17.6</span> First model run<a href="modelingintro.html#first-model-run" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s run the model! Remember the function is HBV(parameters, Precip, Temp, PET, routing)</p>
<p>We will set the output of the model equal to ModelOutput and then have a look at what it outputs.</p>
<p>How can we tell how this did at modeling flow in watershed 3?</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="modelingintro.html#cb275-1" aria-hidden="true" tabindex="-1"></a>ModelOutput <span class="ot">&lt;-</span> <span class="fu">HBV</span>(params, P, Temp, PET, routing)</span>
<span id="cb275-2"><a href="modelingintro.html#cb275-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-3"><a href="modelingintro.html#cb275-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ModelOutput)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 12
##       q    qs    qi    qb Storage   SWE   AET    SF    S1    S2  soil     w
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     0     0     0     0       0    0      0  0        0     0     0     0
## 2     0     0     0     0      40  152.     0  0        0     0    40     0
## 3     0     0     0     0      40  152.     0  0        0     0    40     0
## 4     0     0     0     0      40  152.     0  0        0     0    40     0
## 5     0     0     0     0      40  154.     0  1.16     0     0    40     0
## 6     0     0     0     0      40  154.     0  0        0     0    40     0</code></pre>
</div>
<div id="import-observed-streamflow-data" class="section level2 hasAnchor" number="17.7">
<h2><span class="header-section-number">17.7</span> Import observed streamflow data<a href="modelingintro.html#import-observed-streamflow-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>q in the model output is discharge, and we also have a record of measured discharge from watershed 3 in the file called SWD2009-2012.csv</p>
<p>In order to compare the modeled discharge to the measured discharge, we will read in the data and process it the same way we did with the model inputs. Then we can attach it to the model output so we can compare the two.</p>
<p>NOTE: These data are all nicely processed. They have the same temporal resolution (daily), there are no NAs, and they are in the same units. These are all things to check if you are preparing data from another site.</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="modelingintro.html#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Streamflow mm/d</span></span>
<span id="cb277-2"><a href="modelingintro.html#cb277-2" aria-hidden="true" tabindex="-1"></a>Qobs1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;HBV/SWD2009-2012.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb277-3"><a href="modelingintro.html#cb277-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">select</span>(DATE, WS_3) <span class="sc">%&gt;%</span></span>
<span id="cb277-4"><a href="modelingintro.html#cb277-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">DATE =</span> <span class="fu">ymd</span>(DATE)) <span class="sc">%&gt;%</span></span>
<span id="cb277-5"><a href="modelingintro.html#cb277-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">filter</span>(DATE <span class="sc">&gt;=</span> start <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end)</span></code></pre></div>
<pre><code>## Rows: 1461 Columns: 10
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## dbl (10): DATE, WS_1, WS_2, WS_3, WS_4, WS_5, WS_6, WS_7, WS_8, WS_9
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="modelingintro.html#cb279-1" aria-hidden="true" tabindex="-1"></a>Qobs <span class="ot">&lt;-</span> Qobs1<span class="sc">$</span>WS_3</span>
<span id="cb279-2"><a href="modelingintro.html#cb279-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-3"><a href="modelingintro.html#cb279-3" aria-hidden="true" tabindex="-1"></a>ModelOutput <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(ModelOutput, Qobs1)</span></code></pre></div>
</div>
<div id="compare-observed-and-modeled-discharge-graphically" class="section level2 hasAnchor" number="17.8">
<h2><span class="header-section-number">17.8</span> Compare observed and modeled discharge graphically<a href="modelingintro.html#compare-observed-and-modeled-discharge-graphically" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that we have the observed values glued on to our model output, we can plot the two and see how they compare. Below we will plot the modelled and observed discharge as two lines on a ggplot.</p>
<p>Because the model starts out with its storages at zero, it takes some time for it to actually approximate real conditions. For this reason, you will typically set aside part of the modelled period as a “warm up” period. The duration of this period depends on the system, but for our purposes, we are doing to drop the first half of the model run and only look at the second half: 2011 - 2013. So we will filter the data to just look at that time.</p>
<p>How’d we do? Did the model do a good job of capturing runoff dynamics in watershed 3?</p>
<p>Describe what it looks like the model did well and what it did poorly?</p>
<p>When you are looking at results like this, it is often helpful to look at the full timeframe but to also zoom in and look at specific event dynamics to see what hydrologic processes the model is or is not capturing well. One helpful tool at doing that is plotly. Plotly allows you to create interactive plots. The code chunk after the ggplot creates a plotly graph. From here on out we will use plotly to look at our modeling results so we can investigate them more thoroughly.</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="modelingintro.html#cb280-1" aria-hidden="true" tabindex="-1"></a>OutputTrim <span class="ot">&lt;-</span> <span class="fu">filter</span>(ModelOutput, DATE <span class="sc">&gt;=</span> <span class="fu">mdy</span>(<span class="st">&quot;01-01-2011&quot;</span>))</span>
<span id="cb280-2"><a href="modelingintro.html#cb280-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-3"><a href="modelingintro.html#cb280-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(OutputTrim, <span class="fu">aes</span>(<span class="at">x =</span> DATE, <span class="at">y =</span> WS_3, <span class="at">color =</span> <span class="st">&quot;Measured&quot;</span>))<span class="sc">+</span></span>
<span id="cb280-4"><a href="modelingintro.html#cb280-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb280-5"><a href="modelingintro.html#cb280-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> q, <span class="at">color =</span> <span class="st">&quot;Modelled&quot;</span>))<span class="sc">+</span></span>
<span id="cb280-6"><a href="modelingintro.html#cb280-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Discharge (mm/d)&quot;</span>)</span></code></pre></div>
<p><img src="Hydroinformatics_Bookdown_files/figure-html/unnamed-chunk-174-1.png" width="672" /></p>
</div>
<div id="compare-observed-and-modelled-discharge-with-interactive-graph" class="section level2 hasAnchor" number="17.9">
<h2><span class="header-section-number">17.9</span> Compare observed and modelled discharge with interactive graph<a href="modelingintro.html#compare-observed-and-modelled-discharge-with-interactive-graph" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The code below creates a plot analogous to the ggplot above. Note the differences in syntax. All the same information is there, it is just a different recipe, and you use pipes instead of +.</p>
<p>You can click and drag a box over any time you want to look at to zoom, and if you hover over one of the lines, it will show you the values in a dialogue box. There is a lot of other functionality as well, which you can explore in the menu in the upper right.</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="modelingintro.html#cb281-1" aria-hidden="true" tabindex="-1"></a>OutputTrim <span class="sc">%&gt;%</span> <span class="fu">plot_ly</span>(<span class="at">x =</span> <span class="sc">~</span>DATE) <span class="sc">%&gt;%</span> </span>
<span id="cb281-2"><a href="modelingintro.html#cb281-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">add_trace</span>(<span class="at">y =</span> <span class="sc">~</span>q, <span class="at">name =</span> <span class="st">&#39;Modeled&#39;</span>,  <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="at">mode =</span> <span class="st">&#39;lines&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb281-3"><a href="modelingintro.html#cb281-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">add_trace</span>(<span class="at">y =</span> <span class="sc">~</span>WS_3, <span class="at">name =</span> <span class="st">&#39;Measured&#39;</span>,  <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="at">mode =</span> <span class="st">&#39;lines&#39;</span>)</span></code></pre></div>
<div id="htmlwidget-6c9ff66d9c3d7b81936a" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-6c9ff66d9c3d7b81936a">{"x":{"visdat":{"11ce47b0b538b":["function () ","plotlyVisDat"]},"cur_data":"11ce47b0b538b","attrs":{"11ce47b0b538b":{"x":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"name":"Modeled","type":"scatter","mode":"lines","inherit":true},"11ce47b0b538b.1":{"x":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"name":"Measured","type":"scatter","mode":"lines","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"DATE"},"yaxis":{"domain":[0,1],"automargin":true,"title":"q"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["2011-01-01","2011-01-02","2011-01-03","2011-01-04","2011-01-05","2011-01-06","2011-01-07","2011-01-08","2011-01-09","2011-01-10","2011-01-11","2011-01-12","2011-01-13","2011-01-14","2011-01-15","2011-01-16","2011-01-17","2011-01-18","2011-01-19","2011-01-20","2011-01-21","2011-01-22","2011-01-23","2011-01-24","2011-01-25","2011-01-26","2011-01-27","2011-01-28","2011-01-29","2011-01-30","2011-01-31","2011-02-01","2011-02-02","2011-02-03","2011-02-04","2011-02-05","2011-02-06","2011-02-07","2011-02-08","2011-02-09","2011-02-10","2011-02-11","2011-02-12","2011-02-13","2011-02-14","2011-02-15","2011-02-16","2011-02-17","2011-02-18","2011-02-19","2011-02-20","2011-02-21","2011-02-22","2011-02-23","2011-02-24","2011-02-25","2011-02-26","2011-02-27","2011-02-28","2011-03-01","2011-03-02","2011-03-03","2011-03-04","2011-03-05","2011-03-06","2011-03-07","2011-03-08","2011-03-09","2011-03-10","2011-03-11","2011-03-12","2011-03-13","2011-03-14","2011-03-15","2011-03-16","2011-03-17","2011-03-18","2011-03-19","2011-03-20","2011-03-21","2011-03-22","2011-03-23","2011-03-24","2011-03-25","2011-03-26","2011-03-27","2011-03-28","2011-03-29","2011-03-30","2011-03-31","2011-04-01","2011-04-02","2011-04-03","2011-04-04","2011-04-05","2011-04-06","2011-04-07","2011-04-08","2011-04-09","2011-04-10","2011-04-11","2011-04-12","2011-04-13","2011-04-14","2011-04-15","2011-04-16","2011-04-17","2011-04-18","2011-04-19","2011-04-20","2011-04-21","2011-04-22","2011-04-23","2011-04-24","2011-04-25","2011-04-26","2011-04-27","2011-04-28","2011-04-29","2011-04-30","2011-05-01","2011-05-02","2011-05-03","2011-05-04","2011-05-05","2011-05-06","2011-05-07","2011-05-08","2011-05-09","2011-05-10","2011-05-11","2011-05-12","2011-05-13","2011-05-14","2011-05-15","2011-05-16","2011-05-17","2011-05-18","2011-05-19","2011-05-20","2011-05-21","2011-05-22","2011-05-23","2011-05-24","2011-05-25","2011-05-26","2011-05-27","2011-05-28","2011-05-29","2011-05-30","2011-05-31","2011-06-01","2011-06-02","2011-06-03","2011-06-04","2011-06-05","2011-06-06","2011-06-07","2011-06-08","2011-06-09","2011-06-10","2011-06-11","2011-06-12","2011-06-13","2011-06-14","2011-06-15","2011-06-16","2011-06-17","2011-06-18","2011-06-19","2011-06-20","2011-06-21","2011-06-22","2011-06-23","2011-06-24","2011-06-25","2011-06-26","2011-06-27","2011-06-28","2011-06-29","2011-06-30","2011-07-01","2011-07-02","2011-07-03","2011-07-04","2011-07-05","2011-07-06","2011-07-07","2011-07-08","2011-07-09","2011-07-10","2011-07-11","2011-07-12","2011-07-13","2011-07-14","2011-07-15","2011-07-16","2011-07-17","2011-07-18","2011-07-19","2011-07-20","2011-07-21","2011-07-22","2011-07-23","2011-07-24","2011-07-25","2011-07-26","2011-07-27","2011-07-28","2011-07-29","2011-07-30","2011-07-31","2011-08-01","2011-08-02","2011-08-03","2011-08-04","2011-08-05","2011-08-06","2011-08-07","2011-08-08","2011-08-09","2011-08-10","2011-08-11","2011-08-12","2011-08-13","2011-08-14","2011-08-15","2011-08-16","2011-08-17","2011-08-18","2011-08-19","2011-08-20","2011-08-21","2011-08-22","2011-08-23","2011-08-24","2011-08-25","2011-08-26","2011-08-27","2011-08-28","2011-08-29","2011-08-30","2011-08-31","2011-09-01","2011-09-02","2011-09-03","2011-09-04","2011-09-05","2011-09-06","2011-09-07","2011-09-08","2011-09-09","2011-09-10","2011-09-11","2011-09-12","2011-09-13","2011-09-14","2011-09-15","2011-09-16","2011-09-17","2011-09-18","2011-09-19","2011-09-20","2011-09-21","2011-09-22","2011-09-23","2011-09-24","2011-09-25","2011-09-26","2011-09-27","2011-09-28","2011-09-29","2011-09-30","2011-10-01","2011-10-02","2011-10-03","2011-10-04","2011-10-05","2011-10-06","2011-10-07","2011-10-08","2011-10-09","2011-10-10","2011-10-11","2011-10-12","2011-10-13","2011-10-14","2011-10-15","2011-10-16","2011-10-17","2011-10-18","2011-10-19","2011-10-20","2011-10-21","2011-10-22","2011-10-23","2011-10-24","2011-10-25","2011-10-26","2011-10-27","2011-10-28","2011-10-29","2011-10-30","2011-10-31","2011-11-01","2011-11-02","2011-11-03","2011-11-04","2011-11-05","2011-11-06","2011-11-07","2011-11-08","2011-11-09","2011-11-10","2011-11-11","2011-11-12","2011-11-13","2011-11-14","2011-11-15","2011-11-16","2011-11-17","2011-11-18","2011-11-19","2011-11-20","2011-11-21","2011-11-22","2011-11-23","2011-11-24","2011-11-25","2011-11-26","2011-11-27","2011-11-28","2011-11-29","2011-11-30","2011-12-01","2011-12-02","2011-12-03","2011-12-04","2011-12-05","2011-12-06","2011-12-07","2011-12-08","2011-12-09","2011-12-10","2011-12-11","2011-12-12","2011-12-13","2011-12-14","2011-12-15","2011-12-16","2011-12-17","2011-12-18","2011-12-19","2011-12-20","2011-12-21","2011-12-22","2011-12-23","2011-12-24","2011-12-25","2011-12-26","2011-12-27","2011-12-28","2011-12-29","2011-12-30","2011-12-31","2012-01-01","2012-01-02","2012-01-03","2012-01-04","2012-01-05","2012-01-06","2012-01-07","2012-01-08","2012-01-09","2012-01-10","2012-01-11","2012-01-12","2012-01-13","2012-01-14","2012-01-15","2012-01-16","2012-01-17","2012-01-18","2012-01-19","2012-01-20","2012-01-21","2012-01-22","2012-01-23","2012-01-24","2012-01-25","2012-01-26","2012-01-27","2012-01-28","2012-01-29","2012-01-30","2012-01-31","2012-02-01","2012-02-02","2012-02-03","2012-02-04","2012-02-05","2012-02-06","2012-02-07","2012-02-08","2012-02-09","2012-02-10","2012-02-11","2012-02-12","2012-02-13","2012-02-14","2012-02-15","2012-02-16","2012-02-17","2012-02-18","2012-02-19","2012-02-20","2012-02-21","2012-02-22","2012-02-23","2012-02-24","2012-02-25","2012-02-26","2012-02-27","2012-02-28","2012-02-29","2012-03-01","2012-03-02","2012-03-03","2012-03-04","2012-03-05","2012-03-06","2012-03-07","2012-03-08","2012-03-09","2012-03-10","2012-03-11","2012-03-12","2012-03-13","2012-03-14","2012-03-15","2012-03-16","2012-03-17","2012-03-18","2012-03-19","2012-03-20","2012-03-21","2012-03-22","2012-03-23","2012-03-24","2012-03-25","2012-03-26","2012-03-27","2012-03-28","2012-03-29","2012-03-30","2012-03-31","2012-04-01","2012-04-02","2012-04-03","2012-04-04","2012-04-05","2012-04-06","2012-04-07","2012-04-08","2012-04-09","2012-04-10","2012-04-11","2012-04-12","2012-04-13","2012-04-14","2012-04-15","2012-04-16","2012-04-17","2012-04-18","2012-04-19","2012-04-20","2012-04-21","2012-04-22","2012-04-23","2012-04-24","2012-04-25","2012-04-26","2012-04-27","2012-04-28","2012-04-29","2012-04-30","2012-05-01","2012-05-02","2012-05-03","2012-05-04","2012-05-05","2012-05-06","2012-05-07","2012-05-08","2012-05-09","2012-05-10","2012-05-11","2012-05-12","2012-05-13","2012-05-14","2012-05-15","2012-05-16","2012-05-17","2012-05-18","2012-05-19","2012-05-20","2012-05-21","2012-05-22","2012-05-23","2012-05-24","2012-05-25","2012-05-26","2012-05-27","2012-05-28","2012-05-29","2012-05-30","2012-05-31","2012-06-01","2012-06-02","2012-06-03","2012-06-04","2012-06-05","2012-06-06","2012-06-07","2012-06-08","2012-06-09","2012-06-10","2012-06-11","2012-06-12","2012-06-13","2012-06-14","2012-06-15","2012-06-16","2012-06-17","2012-06-18","2012-06-19","2012-06-20","2012-06-21","2012-06-22","2012-06-23","2012-06-24","2012-06-25","2012-06-26","2012-06-27","2012-06-28","2012-06-29","2012-06-30","2012-07-01","2012-07-02","2012-07-03","2012-07-04","2012-07-05","2012-07-06","2012-07-07","2012-07-08","2012-07-09","2012-07-10","2012-07-11","2012-07-12","2012-07-13","2012-07-14","2012-07-15","2012-07-16","2012-07-17","2012-07-18","2012-07-19","2012-07-20","2012-07-21","2012-07-22","2012-07-23","2012-07-24","2012-07-25","2012-07-26","2012-07-27","2012-07-28","2012-07-29","2012-07-30","2012-07-31","2012-08-01","2012-08-02","2012-08-03","2012-08-04","2012-08-05","2012-08-06","2012-08-07","2012-08-08","2012-08-09","2012-08-10","2012-08-11","2012-08-12","2012-08-13","2012-08-14","2012-08-15","2012-08-16","2012-08-17","2012-08-18","2012-08-19","2012-08-20","2012-08-21","2012-08-22","2012-08-23","2012-08-24","2012-08-25","2012-08-26","2012-08-27","2012-08-28","2012-08-29","2012-08-30","2012-08-31","2012-09-01","2012-09-02","2012-09-03","2012-09-04","2012-09-05","2012-09-06","2012-09-07","2012-09-08","2012-09-09","2012-09-10","2012-09-11","2012-09-12","2012-09-13","2012-09-14","2012-09-15","2012-09-16","2012-09-17","2012-09-18","2012-09-19","2012-09-20","2012-09-21","2012-09-22","2012-09-23","2012-09-24","2012-09-25","2012-09-26","2012-09-27","2012-09-28","2012-09-29","2012-09-30","2012-10-01","2012-10-02","2012-10-03","2012-10-04","2012-10-05","2012-10-06","2012-10-07","2012-10-08","2012-10-09","2012-10-10","2012-10-11","2012-10-12","2012-10-13","2012-10-14","2012-10-15","2012-10-16","2012-10-17","2012-10-18","2012-10-19","2012-10-20","2012-10-21","2012-10-22","2012-10-23","2012-10-24","2012-10-25","2012-10-26","2012-10-27","2012-10-28","2012-10-29","2012-10-30","2012-10-31","2012-11-01","2012-11-02","2012-11-03","2012-11-04","2012-11-05","2012-11-06","2012-11-07","2012-11-08","2012-11-09","2012-11-10","2012-11-11","2012-11-12","2012-11-13","2012-11-14","2012-11-15","2012-11-16","2012-11-17","2012-11-18","2012-11-19","2012-11-20","2012-11-21","2012-11-22","2012-11-23","2012-11-24","2012-11-25","2012-11-26","2012-11-27","2012-11-28","2012-11-29","2012-11-30","2012-12-01","2012-12-02","2012-12-03","2012-12-04","2012-12-05","2012-12-06","2012-12-07","2012-12-08","2012-12-09","2012-12-10","2012-12-11","2012-12-12","2012-12-13","2012-12-14","2012-12-15","2012-12-16","2012-12-17","2012-12-18","2012-12-19","2012-12-20","2012-12-21","2012-12-22","2012-12-23","2012-12-24","2012-12-25","2012-12-26","2012-12-27","2012-12-28","2012-12-29","2012-12-30","2012-12-31"],"y":[2.20774117508333,2.2971839203006,2.15935288508256,2.02979171197761,1.90800420925895,1.79352395670341,1.68591251930121,1.58475776814314,1.48967230205455,1.40029196393128,1.3162744460954,1.23729797932968,1.16306010056989,1.0932764945357,1.02767990486356,0.966019110571745,0.90805796393744,0.853574486101194,0.802360016935122,0.754218415919015,0.708965310963874,0.666427392306042,0.626441748767679,0.588855243841619,0.553523929211121,0.520312493458454,0.489093743850947,0.45974811921989,0.432163232066697,0.406233438142695,0.381859431854133,0.358947865942885,0.337410993986312,0.317166334347133,0.298136354286305,0.280248173029127,0.421425976692089,0.524024999661504,0.492583499681814,0.463028489700905,0.435246780318851,0.40913197349972,0.384584055089736,0.361509011784352,0.339818471077291,0.319429362812654,0.300263601043894,0.307054781375343,0.703481965849635,0.661273047898657,0.621596665024737,0.584300865123253,0.549242813215858,0.516288244422906,0.485310949757532,0.45619229277208,0.428820755205755,0.40309150989341,0.378906019299805,0.356171658141817,0.334801358653308,0.314713277134109,0.295830480506063,0.278080651675699,3.63376858768835,3.41574247242705,3.21079792408142,3.01815004863654,2.83706104571835,3.65292121086508,3.65139230943902,3.60233517799904,3.38619506731909,3.18302336327995,2.99204196148315,3.13990239824514,3.4623031825916,3.2545649916361,3.05929109213794,2.87573362660966,2.70318960901308,2.5409982324723,2.38853833852396,2.24522603821252,2.11051247591977,1.98388172736458,1.86484882372271,1.75295789429935,1.64778042064139,1.5489135954029,1.45597877967873,1.45367775296415,1.5308653810262,2.10000914710574,2.65944638966799,2.71846972799602,2.72007681062466,2.85340670644027,3.24246749819308,4.3877303024394,6.31652309936375,6.58838290764232,6.92795441494659,6.86922887112862,6.4570751388609,6.06965063052925,7.3529228014864,7.31072447881726,7.30106027616031,7.627967831854,7.45528119053912,7.11022848900892,7.51413567278283,7.12048819288825,7.25362140067021,8.22903404239332,7.80019728865122,7.73274838919321,7.28839833082813,6.85109443097844,6.44002876511973,6.05362703921255,5.69420478821519,6.05499637057883,5.74181094714845,5.39730229031955,5.07346415290037,4.76905630372635,4.48291292550277,4.2139381499726,3.96110186097425,3.72343574931579,3.50002960435685,3.53053363109293,4.50584860250118,4.29428212896979,4.18592824913648,4.19521342687021,4.6392366514223,4.50878252714017,4.93607990488426,4.68149003452559,4.83253463156086,4.54258255366721,4.27002760044718,4.14819539489195,3.94759269175695,3.71073713025153,3.48809290243644,3.34228244115663,3.14174549468723,2.953240765006,2.78117357486966,2.61430316037748,2.45744497075483,2.30999827250954,2.17139837615897,2.04111447358943,1.91921895125468,1.82766565046289,1.71800571143511,1.87675593099792,1.88033713007371,2.25025606391997,2.23360113559758,2.14332674331392,2.02571744979947,2.00428691467014,1.98363409776484,1.88910581244743,1.77575946370058,1.66921389587855,1.65359932666852,1.88101471874002,2.45795764458041,2.34645092834782,2.3451591266491,2.21676783507688,2.11167589792057,1.98497534404534,1.87526405331316,1.77010353376309,1.6638973217373,1.5954819021931,1.49975298806151,1.40976780877782,1.46321294192839,1.37542016541269,1.29613081316795,1.33823022886882,1.25793641513669,1.18246023022849,1.11151261641478,1.04813793251462,0.98524965656374,0.926134677169916,0.870566596539721,0.818332600747338,0.845767861573868,0.795021789879436,0.74732048248667,0.70248125353747,0.660332378325221,0.620712435625708,0.583469689488166,0.59654750506735,0.602451355536488,0.566304274204299,0.532326017752041,0.612623881557175,0.587681863371946,0.55242095156963,0.519275694475452,0.503387849955011,0.479516188102603,0.469420003001994,0.441254802821875,0.419518181460668,0.540509803240937,0.524160994832656,0.579944491911108,0.850985953812835,0.799926796584065,0.751931188789021,0.70681531746168,1.26991121280771,3.19867277467407,3.80588239332448,3.57752944972501,3.38032965838552,3.18917743213173,2.99782678620382,4.36304472171253,4.34364907241743,4.08303012807238,3.83804832038804,3.95328947070578,3.71609210246343,3.61335380851222,9.61576045966751,9.11572682348777,8.56878321407851,8.0546562212338,7.57137684795977,7.11709423708218,6.69006858285725,6.64773345769638,7.11175054734351,7.05045513174939,7.46642918878307,7.39094982231766,6.9474928329786,6.53064326299988,6.13880466721989,5.7704763871867,5.42424780395549,5.09879293571816,5.31859515281319,4.99947944364439,4.69951067702573,4.41754003640419,4.15248763421994,3.95820646621026,3.72071407823765,3.81266034247257,3.69696203415491,3.57278352707865,3.35841651545393,3.15691152452669,2.96749683305509,2.78944702307179,3.51194948074047,4.59740050249884,4.80467345899222,6.27445547966822,6.03942596145149,5.717235860622,5.4706416532466,5.14240315405181,4.8338589648087,4.54382742692018,4.27119778130496,4.01492591442667,3.77403035956107,3.5475885379874,3.47046613972193,5.22631930895635,5.30312119029803,5.2456703923009,5.00318668997873,4.70299548858,4.59749855909345,4.67217383308621,4.39184340310104,4.15866007844223,3.9091404737357,3.77727198006081,3.55063566125716,3.33759752158173,3.46912897013091,3.34307079545995,3.45096803129834,3.45011310399836,3.24310631775846,3.04851993869295,2.86560874237137,2.69367221782909,2.53205188475934,2.38012877167378,2.23732104537336,2.10308178265095,1.9768968756919,1.85828306315038,2.27438003287883,2.17149814874274,2.04120825981818,1.91873576422908,1.99213960658381,1.89769527989475,2.0818459890858,2.01014479885974,1.88953611092816,1.77616394427247,1.66959410761612,1.56941846115915,1.4818875482743,2.6476219637863,2.48876464595912,2.35246377705524,2.21131595043193,2.07863699340601,1.95391877380165,2.04775315226985,3.17895089609691,3.00791339330131,2.82743858970323,2.65779227432103,2.49832473786177,2.34842525359007,2.45225706967553,3.1247071508549,2.93722472180361,2.76099123849539,2.59533176418567,2.43961185833453,2.3481848367764,2.34340876376396,2.2302910920021,3.14789788386536,3.05467868412039,2.87139796307317,2.69911408528878,2.53716724017145,2.38493720576116,2.24184097341549,2.42467042362989,2.2791901982121,2.14243878631937,2.01389245914021,1.8930589115918,1.77947537689629,1.67270685428251,1.57234444302556,1.47800377644403,1.52537247984005,1.98912027991854,1.86977306312343,1.75758667933602,1.65213147857586,1.55300358986131,1.45982337446963,1.37223397200145,1.28989993368137,1.21250593766048,1.13975558140085,1.0713702465168,1.0070880317258,0.946662749822247,0.889862984832913,0.836471205742938,0.786282933398362,0.73910595739446,0.694759599950792,0.653074023953745,0.61388958251652,0.577056207565529,0.542432835111597,0.509886865004901,0.479293653104607,0.450536033918331,0.656229074020844,2.42803986291425,2.44019293558588,2.29378135945073,2.15615447788368,2.02678520921066,2.1433097299651,2.01471114616719,1.89382847739716,1.78019876875333,1.67338684262813,1.57298363207044,1.47860461414622,1.38988833729744,1.3064950370596,1.26642953523993,1.19044376312553,1.119017137338,1.05187610909772,0.988763542551857,0.933252385376154,1.09429677175311,1.491058180414,1.49792346545737,1.40804805752993,1.32356517407813,1.24415126363345,1.4647690888635,1.59688567267242,2.28767508824638,2.1504145829516,2.0213897079745,1.90010632549603,1.78609994596627,1.67893394920829,1.57819791225579,1.48350603752045,2.06480334699589,1.98541096460833,1.86628630673183,1.75430912832792,1.83187181721759,2.68872838237568,3.08499596743502,2.89989620938892,2.87909018741867,3.46206653194824,3.59952982210477,3.4412663642376,3.31356735317395,3.46906513237247,3.26092122443012,3.06526595096432,2.88134999390646,2.70846899427207,2.54596085461575,2.3932032033388,2.24961101113847,2.14997315734537,2.19147953450885,2.18444738767673,2.05338054441613,2.00572640380514,1.97568260736705,1.88474539328155,1.77166066968466,1.69099628894403,1.58953651160739,1.49416432091094,1.40451446165629,1.32024359395691,1.24102897831949,1.16656723962032,1.10939264264323,1.3813238378006,1.29844440753256,1.22053774308061,1.14730547849577,1.07846714978603,1.01375912079886,0.952933573550932,0.895757559137876,0.842012105589603,0.791491379254227,0.744001896498974,0.699361782709035,0.816949045525737,1.35176317863778,2.66483286602772,2.60687021690865,2.45045800389413,2.82392246537879,2.78625100420667,2.61907594395427,2.46193138731701,2.31421550407799,2.97469191616594,2.86827425172172,2.80072659339931,3.32474695829686,3.16565082053646,2.97571177130428,2.79716906502602,3.60759633986132,3.63832504470801,4.37435792371112,4.28350598832635,4.02649562902677,3.78490589128517,3.65879310813106,5.89055781903046,6.07218503902957,5.81351382041413,5.46470299118928,5.13682081171793,4.82861156301485,4.59531369557878,4.39654041203473,4.13274798731265,3.88478310807389,3.75852709793384,3.53301547205781,3.32103454373434,3.13267409609997,5.05314952135079,4.76820416336566,4.48211191356372,4.2131851987499,6.20818321128726,6.20536025851358,6.10263581882132,5.75955651332837,5.78770823187815,5.47866816351186,5.52610268197738,5.19843187757933,4.88652596492457,4.5933344070291,4.88480742316116,5.51183169931457,5.1811217973557,4.87025448951436,4.57803922014349,4.30335686693488,4.04515545491879,3.80244612762366,3.57429935996624,3.35984139836827,3.15825091446617,2.9687558595982,2.79063050802231,3.47908750688768,3.30064011213794,3.24872651597683,3.05380292501822,2.87057474951713,2.6983402645461,2.55356821369744,2.40404907144001,2.25980612715361,2.40531455738712,2.2609956839439,2.12533594290726,1.99781578633283,1.87794683915286,1.76527002880368,1.65935382707546,1.55979259745094,1.46620504160388,1.37823273910765,1.29553877476119,1.2199562110841,1.15162075220408,1.14070623127011,1.07424054133921,1.00978610885886,0.949198942327328,0.892247005787689,0.838712185440427,0.835392181099506,0.944562064028619,0.887888340186902,0.920558656315304,0.886563032906523,1.0206626317892,1.41566348382241,1.33072367479307,1.25088025430549,1.29595249129093,1.21819534181347,1.14510362130467,1.07639740402639,1.26817400394645,1.19208356370966,1.12055854988708,1.05332503689386,2.23457974277863,6.04204065411857,6.14250840735466,6.04911141291423,5.68616472813937,5.34499484445101,5.31823254064463,4.99913858820595,4.76799137786073,4.48191189518909,4.21299718147774,3.96021735058908,3.72260430955373,3.49924805098051,3.28929316792168,3.09193557784638,2.90641944317559,2.73203427658506,2.73963177461672,3.22251706515042,3.02916604124139,2.84741607876691,2.69592481434186,2.53416932548134,2.5900067372666,2.4346063330306,2.53076857237605,2.87723074327225,2.70459689867591,2.54232108475536,3.08484194599656,2.89975142923677,2.72576634348256,2.56222036287361,2.40848714110119,2.26397791263512,2.12813923787701,2.00045088360439,1.88042383058813,1.76759840075284,4.62716877971383,4.53512344437524,4.26301603771272,4.00723507544996,3.92285440704684,3.80859104050032,3.5800755780703,3.36527104338608,3.20191686042894,3.03297893138996,3.23214522332511,3.10057180861891,3.0325785053369,3.24268030680363,3.04811948839542,3.39117568929634,3.33997604944504,3.14726336091734,3.25781847220165,3.21538498267861,3.05649941940178,2.87310945423768,3.02147343703168,2.85149501344629,2.82794986974937,2.65827287756441,2.84283455297959,2.79456707261432,2.65347483802002,2.49426634773882,2.34461036687449,3.49877939932098,3.52388786899367,3.37022094772895,3.16800769086521,2.9779272294133,2.7992515956485,2.63129649990959,2.47341870991501,2.32501358732011,2.18551277208091,2.71447026798776,4.39677555650369,4.25254678936768,3.99739398200562,3.77163083261461,3.54533298265774,3.33261300369827,3.13265622347638,2.94469685006779,2.76801503906373,2.68336179582444,2.54664210130407,2.39384357522583,2.25021296071228,2.11520018306954,2.54523985613781,2.39252546476954,2.24897393688337,2.11403550067037,1.98719337063015,1.86796176839234,1.7558840622888,1.65053101855147,1.55149915743838,1.45840920799208,1.38041590475236,1.35004042457723,1.26903799910259,1.19289571915644,1.12132197600705,1.05404265744663,0.99080009799983,0.93135209211984,0.87547096659265,1.53267686609211,1.60447354485833,1.53386061993155,1.86253596814951,1.75078381006054,1.64573678145691,1.58610406471865,1.49950203949537,2.5800761790585,2.42527160831499,2.27975531181609,2.14296999310713,2.0143917935207,1.89352828590946,1.77991658875489,1.6731215934296,2.45948236807952,2.56590893946603,2.44052501249821,3.54241601570315,3.32987105476096,3.1300787914753,2.94227406398679,2.76573762014758,2.59979336293872,2.4438057611624,2.29717741549266,2.1593467705631,2.02978596432931,1.90799880646955],"name":"Modeled","type":"scatter","mode":"lines","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2011-01-01","2011-01-02","2011-01-03","2011-01-04","2011-01-05","2011-01-06","2011-01-07","2011-01-08","2011-01-09","2011-01-10","2011-01-11","2011-01-12","2011-01-13","2011-01-14","2011-01-15","2011-01-16","2011-01-17","2011-01-18","2011-01-19","2011-01-20","2011-01-21","2011-01-22","2011-01-23","2011-01-24","2011-01-25","2011-01-26","2011-01-27","2011-01-28","2011-01-29","2011-01-30","2011-01-31","2011-02-01","2011-02-02","2011-02-03","2011-02-04","2011-02-05","2011-02-06","2011-02-07","2011-02-08","2011-02-09","2011-02-10","2011-02-11","2011-02-12","2011-02-13","2011-02-14","2011-02-15","2011-02-16","2011-02-17","2011-02-18","2011-02-19","2011-02-20","2011-02-21","2011-02-22","2011-02-23","2011-02-24","2011-02-25","2011-02-26","2011-02-27","2011-02-28","2011-03-01","2011-03-02","2011-03-03","2011-03-04","2011-03-05","2011-03-06","2011-03-07","2011-03-08","2011-03-09","2011-03-10","2011-03-11","2011-03-12","2011-03-13","2011-03-14","2011-03-15","2011-03-16","2011-03-17","2011-03-18","2011-03-19","2011-03-20","2011-03-21","2011-03-22","2011-03-23","2011-03-24","2011-03-25","2011-03-26","2011-03-27","2011-03-28","2011-03-29","2011-03-30","2011-03-31","2011-04-01","2011-04-02","2011-04-03","2011-04-04","2011-04-05","2011-04-06","2011-04-07","2011-04-08","2011-04-09","2011-04-10","2011-04-11","2011-04-12","2011-04-13","2011-04-14","2011-04-15","2011-04-16","2011-04-17","2011-04-18","2011-04-19","2011-04-20","2011-04-21","2011-04-22","2011-04-23","2011-04-24","2011-04-25","2011-04-26","2011-04-27","2011-04-28","2011-04-29","2011-04-30","2011-05-01","2011-05-02","2011-05-03","2011-05-04","2011-05-05","2011-05-06","2011-05-07","2011-05-08","2011-05-09","2011-05-10","2011-05-11","2011-05-12","2011-05-13","2011-05-14","2011-05-15","2011-05-16","2011-05-17","2011-05-18","2011-05-19","2011-05-20","2011-05-21","2011-05-22","2011-05-23","2011-05-24","2011-05-25","2011-05-26","2011-05-27","2011-05-28","2011-05-29","2011-05-30","2011-05-31","2011-06-01","2011-06-02","2011-06-03","2011-06-04","2011-06-05","2011-06-06","2011-06-07","2011-06-08","2011-06-09","2011-06-10","2011-06-11","2011-06-12","2011-06-13","2011-06-14","2011-06-15","2011-06-16","2011-06-17","2011-06-18","2011-06-19","2011-06-20","2011-06-21","2011-06-22","2011-06-23","2011-06-24","2011-06-25","2011-06-26","2011-06-27","2011-06-28","2011-06-29","2011-06-30","2011-07-01","2011-07-02","2011-07-03","2011-07-04","2011-07-05","2011-07-06","2011-07-07","2011-07-08","2011-07-09","2011-07-10","2011-07-11","2011-07-12","2011-07-13","2011-07-14","2011-07-15","2011-07-16","2011-07-17","2011-07-18","2011-07-19","2011-07-20","2011-07-21","2011-07-22","2011-07-23","2011-07-24","2011-07-25","2011-07-26","2011-07-27","2011-07-28","2011-07-29","2011-07-30","2011-07-31","2011-08-01","2011-08-02","2011-08-03","2011-08-04","2011-08-05","2011-08-06","2011-08-07","2011-08-08","2011-08-09","2011-08-10","2011-08-11","2011-08-12","2011-08-13","2011-08-14","2011-08-15","2011-08-16","2011-08-17","2011-08-18","2011-08-19","2011-08-20","2011-08-21","2011-08-22","2011-08-23","2011-08-24","2011-08-25","2011-08-26","2011-08-27","2011-08-28","2011-08-29","2011-08-30","2011-08-31","2011-09-01","2011-09-02","2011-09-03","2011-09-04","2011-09-05","2011-09-06","2011-09-07","2011-09-08","2011-09-09","2011-09-10","2011-09-11","2011-09-12","2011-09-13","2011-09-14","2011-09-15","2011-09-16","2011-09-17","2011-09-18","2011-09-19","2011-09-20","2011-09-21","2011-09-22","2011-09-23","2011-09-24","2011-09-25","2011-09-26","2011-09-27","2011-09-28","2011-09-29","2011-09-30","2011-10-01","2011-10-02","2011-10-03","2011-10-04","2011-10-05","2011-10-06","2011-10-07","2011-10-08","2011-10-09","2011-10-10","2011-10-11","2011-10-12","2011-10-13","2011-10-14","2011-10-15","2011-10-16","2011-10-17","2011-10-18","2011-10-19","2011-10-20","2011-10-21","2011-10-22","2011-10-23","2011-10-24","2011-10-25","2011-10-26","2011-10-27","2011-10-28","2011-10-29","2011-10-30","2011-10-31","2011-11-01","2011-11-02","2011-11-03","2011-11-04","2011-11-05","2011-11-06","2011-11-07","2011-11-08","2011-11-09","2011-11-10","2011-11-11","2011-11-12","2011-11-13","2011-11-14","2011-11-15","2011-11-16","2011-11-17","2011-11-18","2011-11-19","2011-11-20","2011-11-21","2011-11-22","2011-11-23","2011-11-24","2011-11-25","2011-11-26","2011-11-27","2011-11-28","2011-11-29","2011-11-30","2011-12-01","2011-12-02","2011-12-03","2011-12-04","2011-12-05","2011-12-06","2011-12-07","2011-12-08","2011-12-09","2011-12-10","2011-12-11","2011-12-12","2011-12-13","2011-12-14","2011-12-15","2011-12-16","2011-12-17","2011-12-18","2011-12-19","2011-12-20","2011-12-21","2011-12-22","2011-12-23","2011-12-24","2011-12-25","2011-12-26","2011-12-27","2011-12-28","2011-12-29","2011-12-30","2011-12-31","2012-01-01","2012-01-02","2012-01-03","2012-01-04","2012-01-05","2012-01-06","2012-01-07","2012-01-08","2012-01-09","2012-01-10","2012-01-11","2012-01-12","2012-01-13","2012-01-14","2012-01-15","2012-01-16","2012-01-17","2012-01-18","2012-01-19","2012-01-20","2012-01-21","2012-01-22","2012-01-23","2012-01-24","2012-01-25","2012-01-26","2012-01-27","2012-01-28","2012-01-29","2012-01-30","2012-01-31","2012-02-01","2012-02-02","2012-02-03","2012-02-04","2012-02-05","2012-02-06","2012-02-07","2012-02-08","2012-02-09","2012-02-10","2012-02-11","2012-02-12","2012-02-13","2012-02-14","2012-02-15","2012-02-16","2012-02-17","2012-02-18","2012-02-19","2012-02-20","2012-02-21","2012-02-22","2012-02-23","2012-02-24","2012-02-25","2012-02-26","2012-02-27","2012-02-28","2012-02-29","2012-03-01","2012-03-02","2012-03-03","2012-03-04","2012-03-05","2012-03-06","2012-03-07","2012-03-08","2012-03-09","2012-03-10","2012-03-11","2012-03-12","2012-03-13","2012-03-14","2012-03-15","2012-03-16","2012-03-17","2012-03-18","2012-03-19","2012-03-20","2012-03-21","2012-03-22","2012-03-23","2012-03-24","2012-03-25","2012-03-26","2012-03-27","2012-03-28","2012-03-29","2012-03-30","2012-03-31","2012-04-01","2012-04-02","2012-04-03","2012-04-04","2012-04-05","2012-04-06","2012-04-07","2012-04-08","2012-04-09","2012-04-10","2012-04-11","2012-04-12","2012-04-13","2012-04-14","2012-04-15","2012-04-16","2012-04-17","2012-04-18","2012-04-19","2012-04-20","2012-04-21","2012-04-22","2012-04-23","2012-04-24","2012-04-25","2012-04-26","2012-04-27","2012-04-28","2012-04-29","2012-04-30","2012-05-01","2012-05-02","2012-05-03","2012-05-04","2012-05-05","2012-05-06","2012-05-07","2012-05-08","2012-05-09","2012-05-10","2012-05-11","2012-05-12","2012-05-13","2012-05-14","2012-05-15","2012-05-16","2012-05-17","2012-05-18","2012-05-19","2012-05-20","2012-05-21","2012-05-22","2012-05-23","2012-05-24","2012-05-25","2012-05-26","2012-05-27","2012-05-28","2012-05-29","2012-05-30","2012-05-31","2012-06-01","2012-06-02","2012-06-03","2012-06-04","2012-06-05","2012-06-06","2012-06-07","2012-06-08","2012-06-09","2012-06-10","2012-06-11","2012-06-12","2012-06-13","2012-06-14","2012-06-15","2012-06-16","2012-06-17","2012-06-18","2012-06-19","2012-06-20","2012-06-21","2012-06-22","2012-06-23","2012-06-24","2012-06-25","2012-06-26","2012-06-27","2012-06-28","2012-06-29","2012-06-30","2012-07-01","2012-07-02","2012-07-03","2012-07-04","2012-07-05","2012-07-06","2012-07-07","2012-07-08","2012-07-09","2012-07-10","2012-07-11","2012-07-12","2012-07-13","2012-07-14","2012-07-15","2012-07-16","2012-07-17","2012-07-18","2012-07-19","2012-07-20","2012-07-21","2012-07-22","2012-07-23","2012-07-24","2012-07-25","2012-07-26","2012-07-27","2012-07-28","2012-07-29","2012-07-30","2012-07-31","2012-08-01","2012-08-02","2012-08-03","2012-08-04","2012-08-05","2012-08-06","2012-08-07","2012-08-08","2012-08-09","2012-08-10","2012-08-11","2012-08-12","2012-08-13","2012-08-14","2012-08-15","2012-08-16","2012-08-17","2012-08-18","2012-08-19","2012-08-20","2012-08-21","2012-08-22","2012-08-23","2012-08-24","2012-08-25","2012-08-26","2012-08-27","2012-08-28","2012-08-29","2012-08-30","2012-08-31","2012-09-01","2012-09-02","2012-09-03","2012-09-04","2012-09-05","2012-09-06","2012-09-07","2012-09-08","2012-09-09","2012-09-10","2012-09-11","2012-09-12","2012-09-13","2012-09-14","2012-09-15","2012-09-16","2012-09-17","2012-09-18","2012-09-19","2012-09-20","2012-09-21","2012-09-22","2012-09-23","2012-09-24","2012-09-25","2012-09-26","2012-09-27","2012-09-28","2012-09-29","2012-09-30","2012-10-01","2012-10-02","2012-10-03","2012-10-04","2012-10-05","2012-10-06","2012-10-07","2012-10-08","2012-10-09","2012-10-10","2012-10-11","2012-10-12","2012-10-13","2012-10-14","2012-10-15","2012-10-16","2012-10-17","2012-10-18","2012-10-19","2012-10-20","2012-10-21","2012-10-22","2012-10-23","2012-10-24","2012-10-25","2012-10-26","2012-10-27","2012-10-28","2012-10-29","2012-10-30","2012-10-31","2012-11-01","2012-11-02","2012-11-03","2012-11-04","2012-11-05","2012-11-06","2012-11-07","2012-11-08","2012-11-09","2012-11-10","2012-11-11","2012-11-12","2012-11-13","2012-11-14","2012-11-15","2012-11-16","2012-11-17","2012-11-18","2012-11-19","2012-11-20","2012-11-21","2012-11-22","2012-11-23","2012-11-24","2012-11-25","2012-11-26","2012-11-27","2012-11-28","2012-11-29","2012-11-30","2012-12-01","2012-12-02","2012-12-03","2012-12-04","2012-12-05","2012-12-06","2012-12-07","2012-12-08","2012-12-09","2012-12-10","2012-12-11","2012-12-12","2012-12-13","2012-12-14","2012-12-15","2012-12-16","2012-12-17","2012-12-18","2012-12-19","2012-12-20","2012-12-21","2012-12-22","2012-12-23","2012-12-24","2012-12-25","2012-12-26","2012-12-27","2012-12-28","2012-12-29","2012-12-30","2012-12-31"],"y":[2.793,5.399,3.435,2.377,1.942,1.647,1.46,1.334,1.181,1.072,1.053,1.003,0.945,0.8,0.718,0.701,0.763,0.83,0.866,0.872,0.817,0.795,0.76,0.723,0.694,0.659,0.617,0.603,0.591,0.581,0.595,0.613,0.622,0.639,0.649,0.604,0.618,0.622,0.61,0.6,0.597,0.596,0.593,0.606,0.595,0.559,0.556,0.771,1.816,1.711,1.143,0.941,0.894,0.806,0.768,0.757,0.734,0.769,0.826,0.721,0.667,0.656,0.692,0.69,20.072,35.229,9.098,5.066,3.885,9.084,9.595,5.179,3.889,3.298,3.212,3.847,13.622,10.723,6.062,4.849,3.79,3.125,2.739,2.353,2.129,2.023,1.777,1.673,1.738,1.871,1.821,1.856,2.232,2.573,3.455,3.297,3.201,4.419,7.254,16.446,54.427,33.419,18.191,16.396,10.761,6.962,27.681,11.052,7.386,7.512,6.176,5.309,4.929,10.734,9.581,30.516,11.822,9.907,8.569,5.303,3.948,3.218,2.751,4.437,4.76,3.427,2.813,2.418,2.1,1.835,1.693,1.566,1.452,1.735,9.302,9.21,5.657,5.255,11.735,6.777,8.116,6.566,7.713,7.815,4.795,3.521,3.272,2.736,2.457,1.999,1.396,1.1,0.915,0.892,0.772,0.648,0.427,0.349,0.274,0.234,0.203,0.546,1.285,1.61,3.157,1.357,0.824,0.558,1.021,0.77,0.535,0.334,0.277,1.009,3.865,4.349,2.339,1.856,1.088,0.789,0.595,0.54,0.375,0.5,0.558,0.327,0.349,0.504,0.301,0.521,0.353,0.235,0.25,0.244,0.256,0.18,0.14,0.144,0.184,0.181,0.079,0.078,0.062,0.062,0.067,0.073,0.152,0.085,0.092,0.122,0.167,0.089,0.079,0.087,0.091,0.072,0.076,0.08,0.203,0.149,0.089,0.408,0.259,0.131,0.103,0.557,3.556,6.615,1.895,0.675,0.362,0.217,1.105,8.194,1.687,0.771,0.913,1.363,0.665,70.594,18.438,5.086,2.57,1.608,1.138,0.859,0.843,3.67,8.085,8.756,11.075,4.923,2.704,1.81,1.361,0.95,0.731,2.328,1.913,1.165,0.832,0.646,0.679,0.711,1.704,3.06,4.273,2.37,1.435,0.96,0.768,5.311,11.334,19.193,22.093,13.334,6.617,4.483,3.238,2.459,1.972,1.586,1.343,1.164,1.071,1.604,11.522,14.451,6.472,4.439,3.308,2.774,3.765,2.974,2.471,2.185,1.935,1.848,1.695,1.672,1.744,1.658,1.572,1.672,2.305,2.309,1.937,1.63,1.428,1.289,1.256,1.168,1.034,1.648,2.685,1.767,1.558,1.487,2.145,1.923,2.788,2.057,1.717,1.576,1.396,1.277,1.405,1.286,1.659,3.155,4.457,5.312,3.781,21.773,6.944,4.398,3.367,2.812,2.447,4.378,9.479,4.739,3.551,2.88,2.456,2.178,2.006,3.54,6.687,5.106,3.488,2.621,2.339,2.059,2.409,4.094,3.4,2.582,2.268,2.07,3.854,19.039,6.486,4.18,3.446,3.975,7.375,4.134,2.863,2.456,2.108,1.97,1.774,1.612,1.47,1.312,2.459,1.334,1.131,1.124,1.115,1.122,1.076,0.948,0.893,0.866,0.821,1.25,8.871,3.599,2.392,3.556,3.68,2.474,1.99,1.781,1.997,2.219,1.776,1.627,1.464,1.412,1.338,1.247,1.217,1.146,1.145,1.126,1.16,1.067,0.87,0.784,0.79,0.766,0.76,0.734,0.775,0.798,0.825,0.837,0.856,0.806,0.719,0.695,0.706,0.711,0.699,0.73,0.768,0.787,0.786,1.018,3.463,7.184,3.231,2.489,4.08,12.631,12.704,7.638,6.216,12.118,19.133,16.104,11.335,7.399,5.325,4.083,3.22,3.672,3.335,2.477,2.263,2.204,2.086,3.453,1.992,1.578,1.43,1.358,1.265,1.118,1.013,1.038,1.898,2.095,1.693,1.462,1.294,1.224,1.139,1.117,1.03,0.95,0.927,0.918,1.431,4.066,19.152,9.82,5.496,3.89,6.778,3.972,3.04,2.52,6.379,5.353,4.756,8.827,5.861,4.166,3.317,27.385,18.61,12.629,7.319,4.799,3.597,2.992,13.381,11.137,8.26,5.562,3.95,2.876,2.107,1.972,1.62,1.346,1.715,1.764,1.227,1.001,15.039,12.596,4.444,2.711,20.044,17.601,7.196,4.387,3.801,4.092,3.137,3.226,2.099,1.571,1.681,13.289,5.063,3.035,2.263,1.856,1.359,1.227,0.914,0.658,0.472,0.355,0.29,2.826,2.535,1.636,1.15,0.784,0.507,1.435,0.382,0.246,0.559,0.736,0.457,0.328,0.234,0.175,0.145,0.121,0.104,0.092,0.08,0.072,0.087,0.073,0.113,0.081,0.078,0.074,0.072,0.087,0.255,0.1,0.088,0.194,0.205,0.522,0.356,0.15,0.138,0.316,0.146,0.093,0.163,0.382,0.149,0.098,2.295,28.957,11.403,5.286,2.951,1.67,1.827,1.52,0.972,0.685,0.45,0.301,0.2,0.153,0.11,0.097,0.083,0.108,0.236,1.943,0.609,0.313,0.185,0.165,0.281,0.237,0.533,3.651,1.376,0.739,1.595,2.942,1.283,0.763,0.483,0.341,0.252,0.203,0.175,0.157,18.486,20.958,4.84,2.684,1.988,2.137,1.435,1.15,1.021,0.973,1.533,2.167,1.864,3.319,2.318,4.109,4.352,3.433,2.968,2.786,2.811,2.078,2.304,2.963,2.276,1.91,2.829,2.874,2.651,2.069,1.738,7.919,13.908,6.11,4.052,2.872,2.384,2.038,1.83,1.69,1.554,1.797,17.857,18.49,7.325,4.669,3.419,2.741,2.311,1.972,1.786,1.694,1.548,1.49,1.382,1.308,2.84,2.446,1.901,1.595,1.372,1.194,1.18,1.157,1.104,1.045,1.05,1.014,0.956,0.877,0.804,0.809,0.766,0.722,0.67,1.567,5.631,2.947,4.107,2.723,2.102,1.866,1.662,6.493,7.312,3.684,2.651,2.228,1.883,1.62,1.543,3.026,4.714,2.924,7.174,8.398,4.226,2.967,2.399,2.017,1.9,1.685,1.557,1.457,1.334],"name":"Measured","type":"scatter","mode":"lines","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="measure-how-well-the-model-fits-with-nse" class="section level2 hasAnchor" number="17.10">
<h2><span class="header-section-number">17.10</span> Measure how well the model fits with NSE<a href="modelingintro.html#measure-how-well-the-model-fits-with-nse" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before we can start trying to tune our model to look more like the observed discharge record, it would be helpful to have some sort of quantified metric for how well our modeled data fits the measured data.</p>
<p>There are many different ways to do this, but discussion of the pros and cons of those approaches is beyond this quick introduction to modeling. So we are just going to look at one method, the Nash-Sutcliffe Efficiency (NSE).</p>
<p>Basically, the NSE looks at how much better your model run did that if you had just used the mean discharge for the data record as your “modelled results”. It does this by comparing how far off the observed values where from the mean discharge to how far off the modeled values were from the observed discharge.</p>
<p>Mathematically NSE the sum of the squared differences between the modeled and observed discharge divided by the sum of the squared differences between the observed and mean discharge, subtracted by 1.</p>
<p><span class="math display">\[
NSE = 1 - \frac{\sum_{t = 1}^{T}{(Q_m^t - Q_o^t)^2}}{\sum_{t = 1}^{T}{(Q_o^t - \bar{Q_o})^2}}
\]</span>
Where <span class="math inline">\(Q_m^t\)</span> is modeled discharge at time t, <span class="math inline">\(Q_o^t\)</span> is observed discharge at time t, and <span class="math inline">\(\bar{Q_o}\)</span> is mean observed discharge.</p>
<p>Below, we calculate NSE for the model run above. We will continue to exclude the warm up period.</p>
<p>An NSE over 0 means the model did better than the mean discharge at predicting discharge. An NSE of 1 would be a perfect model fit. How’d we do? Does this make sense with the timeseries we looked at above?</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="modelingintro.html#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate NSE</span></span>
<span id="cb282-2"><a href="modelingintro.html#cb282-2" aria-hidden="true" tabindex="-1"></a>NSE <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> ((<span class="fu">sum</span>((OutputTrim<span class="sc">$</span>q <span class="sc">-</span> OutputTrim<span class="sc">$</span>WS_3) <span class="sc">^</span> <span class="dv">2</span>)) <span class="sc">/</span> </span>
<span id="cb282-3"><a href="modelingintro.html#cb282-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">sum</span>((OutputTrim<span class="sc">$</span>WS_3 <span class="sc">-</span> <span class="fu">mean</span>(OutputTrim<span class="sc">$</span>WS_3)) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb282-4"><a href="modelingintro.html#cb282-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-5"><a href="modelingintro.html#cb282-5" aria-hidden="true" tabindex="-1"></a>NSE</span></code></pre></div>
<pre><code>## [1] 0.2135378</code></pre>
</div>
<div id="assess-model-fit-with-a-different-measure-snow" class="section level2 hasAnchor" number="17.11">
<h2><span class="header-section-number">17.11</span> Assess model fit with a different measure: Snow<a href="modelingintro.html#assess-model-fit-with-a-different-measure-snow" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before we jump into trying to parameterize this thing, I wanted to note that there are other things you can calibrate your model to other than discharge. In the case of watershed 3, for example, we also have a snow record. Snowmelt is a very important input driving our model so we might want to make sure that the model is doing a good job of capturing that as well!</p>
<p>Let’s pull in snow, calculate NSE between the modeled and measure snow, and look at a plot of the data.</p>
<p>Snow is not measured daily, so we will plot the measured values as points. Likewise, we will have filter our data to only times when we have a modeled snow amount AND a recorded snow amount when we calculate NSE.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="modelingintro.html#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Read and prep snow data</span></span>
<span id="cb284-2"><a href="modelingintro.html#cb284-2" aria-hidden="true" tabindex="-1"></a>snow <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;HBV/sno2009-2012.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb284-3"><a href="modelingintro.html#cb284-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">select</span>(DATE, STA2) <span class="sc">%&gt;%</span></span>
<span id="cb284-4"><a href="modelingintro.html#cb284-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">DATE =</span> <span class="fu">ymd</span>(DATE)) <span class="sc">%&gt;%</span></span>
<span id="cb284-5"><a href="modelingintro.html#cb284-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">filter</span>(DATE <span class="sc">&gt;=</span> start <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end)</span></code></pre></div>
<pre><code>## New names:
## Rows: 76 Columns: 25
## ── Column specification
## ──────────────────────────────────────────────────────── Delimiter: &quot;,&quot; chr
## (1): DATE dbl (21): STA1, STA2, STA3, STA4, STA5, STA6, STA7, STA8, STA9,
## STA10, STA11... lgl (3): ...23, ...24, ...25
## ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
## Specify the column types or set `show_col_types = FALSE` to quiet this message.
## • `` -&gt; `...23`
## • `` -&gt; `...24`
## • `` -&gt; `...25`</code></pre>
<pre><code>## Warning: 8 failed to parse.</code></pre>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="modelingintro.html#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Join measured snow to model output</span></span>
<span id="cb287-2"><a href="modelingintro.html#cb287-2" aria-hidden="true" tabindex="-1"></a>OutputTrimSno <span class="ot">&lt;-</span> <span class="fu">left_join</span>(OutputTrim, snow, <span class="at">by =</span> <span class="st">&quot;DATE&quot;</span>)</span>
<span id="cb287-3"><a href="modelingintro.html#cb287-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-4"><a href="modelingintro.html#cb287-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot modeled and measured snow</span></span>
<span id="cb287-5"><a href="modelingintro.html#cb287-5" aria-hidden="true" tabindex="-1"></a>OutputTrimSno <span class="sc">%&gt;%</span> <span class="fu">plot_ly</span>(<span class="at">x =</span> <span class="sc">~</span>DATE) <span class="sc">%&gt;%</span> </span>
<span id="cb287-6"><a href="modelingintro.html#cb287-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">add_trace</span>(<span class="at">y =</span> <span class="sc">~</span>SWE, <span class="at">name =</span> <span class="st">&#39;Modeled&#39;</span>, <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="at">mode =</span> <span class="st">&#39;lines&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb287-7"><a href="modelingintro.html#cb287-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">add_trace</span>(<span class="at">y =</span> <span class="sc">~</span>STA2, <span class="at">name =</span> <span class="st">&#39;Measured&#39;</span>, <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="at">mode =</span> <span class="st">&#39;markers&#39;</span>)</span></code></pre></div>
<pre><code>## Warning: Ignoring 698 observations</code></pre>
<div id="htmlwidget-6dad708fa6bff218431c" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-6dad708fa6bff218431c">{"x":{"visdat":{"11ce47f7c645e":["function () ","plotlyVisDat"]},"cur_data":"11ce47f7c645e","attrs":{"11ce47f7c645e":{"x":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"name":"Modeled","type":"scatter","mode":"lines","inherit":true},"11ce47f7c645e.1":{"x":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"name":"Measured","type":"scatter","mode":"markers","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"DATE"},"yaxis":{"domain":[0,1],"automargin":true,"title":"SWE"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["2011-01-01","2011-01-02","2011-01-03","2011-01-04","2011-01-05","2011-01-06","2011-01-07","2011-01-08","2011-01-09","2011-01-10","2011-01-11","2011-01-12","2011-01-13","2011-01-14","2011-01-15","2011-01-16","2011-01-17","2011-01-18","2011-01-19","2011-01-20","2011-01-21","2011-01-22","2011-01-23","2011-01-24","2011-01-25","2011-01-26","2011-01-27","2011-01-28","2011-01-29","2011-01-30","2011-01-31","2011-02-01","2011-02-02","2011-02-03","2011-02-04","2011-02-05","2011-02-06","2011-02-07","2011-02-08","2011-02-09","2011-02-10","2011-02-11","2011-02-12","2011-02-13","2011-02-14","2011-02-15","2011-02-16","2011-02-17","2011-02-18","2011-02-19","2011-02-20","2011-02-21","2011-02-22","2011-02-23","2011-02-24","2011-02-25","2011-02-26","2011-02-27","2011-02-28","2011-03-01","2011-03-02","2011-03-03","2011-03-04","2011-03-05","2011-03-06","2011-03-07","2011-03-08","2011-03-09","2011-03-10","2011-03-11","2011-03-12","2011-03-13","2011-03-14","2011-03-15","2011-03-16","2011-03-17","2011-03-18","2011-03-19","2011-03-20","2011-03-21","2011-03-22","2011-03-23","2011-03-24","2011-03-25","2011-03-26","2011-03-27","2011-03-28","2011-03-29","2011-03-30","2011-03-31","2011-04-01","2011-04-02","2011-04-03","2011-04-04","2011-04-05","2011-04-06","2011-04-07","2011-04-08","2011-04-09","2011-04-10","2011-04-11","2011-04-12","2011-04-13","2011-04-14","2011-04-15","2011-04-16","2011-04-17","2011-04-18","2011-04-19","2011-04-20","2011-04-21","2011-04-22","2011-04-23","2011-04-24","2011-04-25","2011-04-26","2011-04-27","2011-04-28","2011-04-29","2011-04-30","2011-05-01","2011-05-02","2011-05-03","2011-05-04","2011-05-05","2011-05-06","2011-05-07","2011-05-08","2011-05-09","2011-05-10","2011-05-11","2011-05-12","2011-05-13","2011-05-14","2011-05-15","2011-05-16","2011-05-17","2011-05-18","2011-05-19","2011-05-20","2011-05-21","2011-05-22","2011-05-23","2011-05-24","2011-05-25","2011-05-26","2011-05-27","2011-05-28","2011-05-29","2011-05-30","2011-05-31","2011-06-01","2011-06-02","2011-06-03","2011-06-04","2011-06-05","2011-06-06","2011-06-07","2011-06-08","2011-06-09","2011-06-10","2011-06-11","2011-06-12","2011-06-13","2011-06-14","2011-06-15","2011-06-16","2011-06-17","2011-06-18","2011-06-19","2011-06-20","2011-06-21","2011-06-22","2011-06-23","2011-06-24","2011-06-25","2011-06-26","2011-06-27","2011-06-28","2011-06-29","2011-06-30","2011-07-01","2011-07-02","2011-07-03","2011-07-04","2011-07-05","2011-07-06","2011-07-07","2011-07-08","2011-07-09","2011-07-10","2011-07-11","2011-07-12","2011-07-13","2011-07-14","2011-07-15","2011-07-16","2011-07-17","2011-07-18","2011-07-19","2011-07-20","2011-07-21","2011-07-22","2011-07-23","2011-07-24","2011-07-25","2011-07-26","2011-07-27","2011-07-28","2011-07-29","2011-07-30","2011-07-31","2011-08-01","2011-08-02","2011-08-03","2011-08-04","2011-08-05","2011-08-06","2011-08-07","2011-08-08","2011-08-09","2011-08-10","2011-08-11","2011-08-12","2011-08-13","2011-08-14","2011-08-15","2011-08-16","2011-08-17","2011-08-18","2011-08-19","2011-08-20","2011-08-21","2011-08-22","2011-08-23","2011-08-24","2011-08-25","2011-08-26","2011-08-27","2011-08-28","2011-08-29","2011-08-30","2011-08-31","2011-09-01","2011-09-02","2011-09-03","2011-09-04","2011-09-05","2011-09-06","2011-09-07","2011-09-08","2011-09-09","2011-09-10","2011-09-11","2011-09-12","2011-09-13","2011-09-14","2011-09-15","2011-09-16","2011-09-17","2011-09-18","2011-09-19","2011-09-20","2011-09-21","2011-09-22","2011-09-23","2011-09-24","2011-09-25","2011-09-26","2011-09-27","2011-09-28","2011-09-29","2011-09-30","2011-10-01","2011-10-02","2011-10-03","2011-10-04","2011-10-05","2011-10-06","2011-10-07","2011-10-08","2011-10-09","2011-10-10","2011-10-11","2011-10-12","2011-10-13","2011-10-14","2011-10-15","2011-10-16","2011-10-17","2011-10-18","2011-10-19","2011-10-20","2011-10-21","2011-10-22","2011-10-23","2011-10-24","2011-10-25","2011-10-26","2011-10-27","2011-10-28","2011-10-29","2011-10-30","2011-10-31","2011-11-01","2011-11-02","2011-11-03","2011-11-04","2011-11-05","2011-11-06","2011-11-07","2011-11-08","2011-11-09","2011-11-10","2011-11-11","2011-11-12","2011-11-13","2011-11-14","2011-11-15","2011-11-16","2011-11-17","2011-11-18","2011-11-19","2011-11-20","2011-11-21","2011-11-22","2011-11-23","2011-11-24","2011-11-25","2011-11-26","2011-11-27","2011-11-28","2011-11-29","2011-11-30","2011-12-01","2011-12-02","2011-12-03","2011-12-04","2011-12-05","2011-12-06","2011-12-07","2011-12-08","2011-12-09","2011-12-10","2011-12-11","2011-12-12","2011-12-13","2011-12-14","2011-12-15","2011-12-16","2011-12-17","2011-12-18","2011-12-19","2011-12-20","2011-12-21","2011-12-22","2011-12-23","2011-12-24","2011-12-25","2011-12-26","2011-12-27","2011-12-28","2011-12-29","2011-12-30","2011-12-31","2012-01-01","2012-01-02","2012-01-03","2012-01-04","2012-01-05","2012-01-06","2012-01-07","2012-01-08","2012-01-09","2012-01-10","2012-01-11","2012-01-12","2012-01-13","2012-01-14","2012-01-15","2012-01-16","2012-01-17","2012-01-18","2012-01-19","2012-01-20","2012-01-21","2012-01-22","2012-01-23","2012-01-24","2012-01-25","2012-01-26","2012-01-27","2012-01-28","2012-01-29","2012-01-30","2012-01-31","2012-02-01","2012-02-02","2012-02-03","2012-02-04","2012-02-05","2012-02-06","2012-02-07","2012-02-08","2012-02-09","2012-02-10","2012-02-11","2012-02-12","2012-02-13","2012-02-14","2012-02-15","2012-02-16","2012-02-17","2012-02-18","2012-02-19","2012-02-20","2012-02-21","2012-02-22","2012-02-23","2012-02-24","2012-02-25","2012-02-26","2012-02-27","2012-02-28","2012-02-29","2012-03-01","2012-03-02","2012-03-03","2012-03-04","2012-03-05","2012-03-06","2012-03-07","2012-03-08","2012-03-09","2012-03-10","2012-03-11","2012-03-12","2012-03-13","2012-03-14","2012-03-15","2012-03-16","2012-03-17","2012-03-18","2012-03-19","2012-03-20","2012-03-21","2012-03-22","2012-03-23","2012-03-24","2012-03-25","2012-03-26","2012-03-27","2012-03-28","2012-03-29","2012-03-30","2012-03-31","2012-04-01","2012-04-02","2012-04-03","2012-04-04","2012-04-05","2012-04-06","2012-04-07","2012-04-08","2012-04-09","2012-04-10","2012-04-11","2012-04-12","2012-04-13","2012-04-14","2012-04-15","2012-04-16","2012-04-17","2012-04-18","2012-04-19","2012-04-20","2012-04-21","2012-04-22","2012-04-23","2012-04-24","2012-04-25","2012-04-26","2012-04-27","2012-04-28","2012-04-29","2012-04-30","2012-05-01","2012-05-02","2012-05-03","2012-05-04","2012-05-05","2012-05-06","2012-05-07","2012-05-08","2012-05-09","2012-05-10","2012-05-11","2012-05-12","2012-05-13","2012-05-14","2012-05-15","2012-05-16","2012-05-17","2012-05-18","2012-05-19","2012-05-20","2012-05-21","2012-05-22","2012-05-23","2012-05-24","2012-05-25","2012-05-26","2012-05-27","2012-05-28","2012-05-29","2012-05-30","2012-05-31","2012-06-01","2012-06-02","2012-06-03","2012-06-04","2012-06-05","2012-06-06","2012-06-07","2012-06-08","2012-06-09","2012-06-10","2012-06-11","2012-06-12","2012-06-13","2012-06-14","2012-06-15","2012-06-16","2012-06-17","2012-06-18","2012-06-19","2012-06-20","2012-06-21","2012-06-22","2012-06-23","2012-06-24","2012-06-25","2012-06-26","2012-06-27","2012-06-28","2012-06-29","2012-06-30","2012-07-01","2012-07-02","2012-07-03","2012-07-04","2012-07-05","2012-07-06","2012-07-07","2012-07-08","2012-07-09","2012-07-10","2012-07-11","2012-07-12","2012-07-13","2012-07-14","2012-07-15","2012-07-16","2012-07-17","2012-07-18","2012-07-19","2012-07-20","2012-07-21","2012-07-22","2012-07-23","2012-07-24","2012-07-25","2012-07-26","2012-07-27","2012-07-28","2012-07-29","2012-07-30","2012-07-31","2012-08-01","2012-08-02","2012-08-03","2012-08-04","2012-08-05","2012-08-06","2012-08-07","2012-08-08","2012-08-09","2012-08-10","2012-08-11","2012-08-12","2012-08-13","2012-08-14","2012-08-15","2012-08-16","2012-08-17","2012-08-18","2012-08-19","2012-08-20","2012-08-21","2012-08-22","2012-08-23","2012-08-24","2012-08-25","2012-08-26","2012-08-27","2012-08-28","2012-08-29","2012-08-30","2012-08-31","2012-09-01","2012-09-02","2012-09-03","2012-09-04","2012-09-05","2012-09-06","2012-09-07","2012-09-08","2012-09-09","2012-09-10","2012-09-11","2012-09-12","2012-09-13","2012-09-14","2012-09-15","2012-09-16","2012-09-17","2012-09-18","2012-09-19","2012-09-20","2012-09-21","2012-09-22","2012-09-23","2012-09-24","2012-09-25","2012-09-26","2012-09-27","2012-09-28","2012-09-29","2012-09-30","2012-10-01","2012-10-02","2012-10-03","2012-10-04","2012-10-05","2012-10-06","2012-10-07","2012-10-08","2012-10-09","2012-10-10","2012-10-11","2012-10-12","2012-10-13","2012-10-14","2012-10-15","2012-10-16","2012-10-17","2012-10-18","2012-10-19","2012-10-20","2012-10-21","2012-10-22","2012-10-23","2012-10-24","2012-10-25","2012-10-26","2012-10-27","2012-10-28","2012-10-29","2012-10-30","2012-10-31","2012-11-01","2012-11-02","2012-11-03","2012-11-04","2012-11-05","2012-11-06","2012-11-07","2012-11-08","2012-11-09","2012-11-10","2012-11-11","2012-11-12","2012-11-13","2012-11-14","2012-11-15","2012-11-16","2012-11-17","2012-11-18","2012-11-19","2012-11-20","2012-11-21","2012-11-22","2012-11-23","2012-11-24","2012-11-25","2012-11-26","2012-11-27","2012-11-28","2012-11-29","2012-11-30","2012-12-01","2012-12-02","2012-12-03","2012-12-04","2012-12-05","2012-12-06","2012-12-07","2012-12-08","2012-12-09","2012-12-10","2012-12-11","2012-12-12","2012-12-13","2012-12-14","2012-12-15","2012-12-16","2012-12-17","2012-12-18","2012-12-19","2012-12-20","2012-12-21","2012-12-22","2012-12-23","2012-12-24","2012-12-25","2012-12-26","2012-12-27","2012-12-28","2012-12-29","2012-12-30","2012-12-31"],"y":[3.828,0,0,0.44,1.24,1.28,1.28,1.64,2.32,2.32,2.32,10.08,10.36,10.36,10.92,11.68,11.68,24,25.2,25.56,27.44,27.44,27.44,27.68,27.84,27.84,27.84,27.84,28.04,28.32,28.32,30.92,40.36,40.4,40.4,46.6,50.71,50.16,52.44,52.44,52.44,52.44,54.08,54.16,54.88,54.88,54.88,54.4445,47.2945,49.0145,49.0145,49.4145,49.4145,49.4145,49.4145,60.3745,60.5345,62.7745,70.4945,70.4945,71.4545,71.4545,71.4545,71.6545,74.96995,90.32995,90.32995,90.32995,92.08995,91.82195,91.27195,90.72195,90.72195,90.72195,95.00195,89.51745,81.26745,81.38745,81.38745,87.14745,87.94745,88.18745,88.54745,88.54745,88.54745,88.54745,88.54745,88.54745,88.54745,88.64745,92.88745,91.46445,88.71445,87.06445,82.11445,81.56445,78.81445,73.86445,64.51445,52.96445,41.41445,30.96445,27.11445,23.26445,23.26445,26.06445,21.50445,15.45445,8.30445000000003,4.45445000000003,1.70445000000003,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.08,0,0,0,0,0,0,0,0,0,0,0,0,0,5.2,5.2,5.28,5.28,4.158,1.408,0.858,0,0,0,0,0,0,4.24,0,4.76,4.76,5.2,6.52,15.68,20.48,20.48,20.68,19.998,15.048,18.368,18.368,18.368,18.368,18.888,18.888,18.888,18.888,18.888,18.888,24.448,27.168,27.728,27.728,27.728,29.728,30.528,31.928,33.048,33.568,33.568,43.488,45.488,45.688,47.0393,46.4893,43.7393,44.2193,44.2193,45.5793,43.6458,43.6458,43.6458,43.8858,43.8858,43.8858,43.8858,43.8858,43.8858,43.2223,43.6623,43.6623,43.6623,43.6623,43.5963,40.8463,36.9963,35.3463,35.3463,35.3463,35.7063,31.2598,28.5098,27.9598,30.1598,30.1598,30.3998,30.6798,31.0798,34.0798,34.4798,36.2593,35.7093,35.7093,35.7093,32.6293,21.0793,19.4293,20.9893,18.4228,5.77279999999999,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.16,0.16,0.16,0.28,1.32,1.32,2.8,2.53,0,0,0,0,0,0,0,0,0,0,0,0,0,3.12,6.64,4.554,2.904,2.354,0,0.28,0.32,0.52,1.52,1.52,6.92,7.72,10.76,12.08,12.08],"name":"Modeled","type":"scatter","mode":"lines","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2011-01-04","2011-01-10","2011-01-20","2011-01-25","2011-01-31","2011-02-07","2011-02-14","2011-02-22","2011-03-01","2011-03-08","2011-03-14","2011-03-21","2011-03-28","2011-04-06","2011-04-12","2011-04-18","2011-04-25","2011-05-02","2011-05-10","2011-12-27","2012-01-03","2012-01-09","2012-01-18","2012-01-23","2012-01-30","2012-02-06","2012-02-13","2012-02-21","2012-02-27","2012-03-06","2012-03-12","2012-03-19","2012-03-26"],"y":[0,0,22,26,31,46,49,44,60,46,65,48,52,56,0,0,0,0,0,0,0,0,9,12,21,16,19,19,27,36,34,0,0],"name":"Measured","type":"scatter","mode":"markers","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="modelingintro.html#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Drop rows where there isn&#39;t a measured snow amount</span></span>
<span id="cb289-2"><a href="modelingintro.html#cb289-2" aria-hidden="true" tabindex="-1"></a>CompareSnow <span class="ot">&lt;-</span> <span class="fu">drop_na</span>(OutputTrimSno, STA2)</span>
<span id="cb289-3"><a href="modelingintro.html#cb289-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-4"><a href="modelingintro.html#cb289-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate NSE for snow, SWE is modeled, STA2 is measured</span></span>
<span id="cb289-5"><a href="modelingintro.html#cb289-5" aria-hidden="true" tabindex="-1"></a>NSEsno <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> ((<span class="fu">sum</span>((CompareSnow<span class="sc">$</span>SWE <span class="sc">-</span> CompareSnow<span class="sc">$</span>STA2) <span class="sc">^</span> <span class="dv">2</span>)) <span class="sc">/</span> </span>
<span id="cb289-6"><a href="modelingintro.html#cb289-6" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">sum</span>((CompareSnow<span class="sc">$</span>STA2 <span class="sc">-</span> <span class="fu">mean</span>(CompareSnow<span class="sc">$</span>STA2)) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb289-7"><a href="modelingintro.html#cb289-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-8"><a href="modelingintro.html#cb289-8" aria-hidden="true" tabindex="-1"></a>NSEsno</span></code></pre></div>
<pre><code>## [1] 0.1339054</code></pre>
</div>
<div id="calibrate-hbv-manually" class="section level2 hasAnchor" number="17.12">
<h2><span class="header-section-number">17.12</span> Calibrate HBV manually<a href="modelingintro.html#calibrate-hbv-manually" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Woohoo! We can now run our model and assess how well it is working!</p>
<p>Now, let’s see how well we can get it to work. The code below runs the model, produces a plot, and calculates the NSE based on discharge.</p>
<p>By changing the parameters, see how well you can get the model to fit. Take note of how the discharge changes when you change certain parameters. Let’s see who can get the highest NSE!</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="modelingintro.html#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="co">#when this term = 1, then triangular routing is invoked, or for no routing, routing = 0</span></span>
<span id="cb291-2"><a href="modelingintro.html#cb291-2" aria-hidden="true" tabindex="-1"></a><span class="co">#if routing = 0 then MAXBAS doesn&#39;t do anything</span></span>
<span id="cb291-3"><a href="modelingintro.html#cb291-3" aria-hidden="true" tabindex="-1"></a>routing <span class="ot">&lt;-</span> <span class="dv">0</span>      </span>
<span id="cb291-4"><a href="modelingintro.html#cb291-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-5"><a href="modelingintro.html#cb291-5" aria-hidden="true" tabindex="-1"></a><span class="co">#hard code parameters </span></span>
<span id="cb291-6"><a href="modelingintro.html#cb291-6" aria-hidden="true" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">40</span>,     <span class="co">#FCM ax soil moisture storage, field capacity</span></span>
<span id="cb291-7"><a href="modelingintro.html#cb291-7" aria-hidden="true" tabindex="-1"></a>            <span class="dv">1</span>,      <span class="co">#beta Shape coefficient governing fate of water input to soil moisture storage</span></span>
<span id="cb291-8"><a href="modelingintro.html#cb291-8" aria-hidden="true" tabindex="-1"></a>            <span class="fl">0.3</span>,    <span class="co">#LP Threshold for reduction of evap</span></span>
<span id="cb291-9"><a href="modelingintro.html#cb291-9" aria-hidden="true" tabindex="-1"></a>            <span class="fl">0.4</span>,    <span class="co">#SFCF Snowfall correction factor</span></span>
<span id="cb291-10"><a href="modelingintro.html#cb291-10" aria-hidden="true" tabindex="-1"></a>            <span class="sc">-</span><span class="fl">1.5</span>,   <span class="co">#TT Threshold temperature</span></span>
<span id="cb291-11"><a href="modelingintro.html#cb291-11" aria-hidden="true" tabindex="-1"></a>            <span class="dv">1</span>,      <span class="co">#CFMAX Degree-day factor</span></span>
<span id="cb291-12"><a href="modelingintro.html#cb291-12" aria-hidden="true" tabindex="-1"></a>            <span class="fl">0.05</span>,   <span class="co">#k0 Recession constant (upper storage, near surface)</span></span>
<span id="cb291-13"><a href="modelingintro.html#cb291-13" aria-hidden="true" tabindex="-1"></a>            <span class="fl">0.01</span>,   <span class="co">#k1 Recession constant (upper storage)</span></span>
<span id="cb291-14"><a href="modelingintro.html#cb291-14" aria-hidden="true" tabindex="-1"></a>            <span class="fl">0.001</span>,  <span class="co">#k2 Recession constant (lower storage)</span></span>
<span id="cb291-15"><a href="modelingintro.html#cb291-15" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span>,      <span class="co">#UZL Threshold for shallow storage</span></span>
<span id="cb291-16"><a href="modelingintro.html#cb291-16" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span>,      <span class="co">#PERC Percolation, max flow from upper to lower storage</span></span>
<span id="cb291-17"><a href="modelingintro.html#cb291-17" aria-hidden="true" tabindex="-1"></a>            <span class="dv">1</span>       <span class="co">#MAXBAS base of the triangular routing function, days</span></span>
<span id="cb291-18"><a href="modelingintro.html#cb291-18" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb291-19"><a href="modelingintro.html#cb291-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-20"><a href="modelingintro.html#cb291-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Run the model</span></span>
<span id="cb291-21"><a href="modelingintro.html#cb291-21" aria-hidden="true" tabindex="-1"></a>Out <span class="ot">&lt;-</span> <span class="fu">HBV</span>(params, P, Temp, PET, routing)</span>
<span id="cb291-22"><a href="modelingintro.html#cb291-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-23"><a href="modelingintro.html#cb291-23" aria-hidden="true" tabindex="-1"></a><span class="co">#Add observed output</span></span>
<span id="cb291-24"><a href="modelingintro.html#cb291-24" aria-hidden="true" tabindex="-1"></a>Out <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(Out, Qobs1)</span>
<span id="cb291-25"><a href="modelingintro.html#cb291-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-26"><a href="modelingintro.html#cb291-26" aria-hidden="true" tabindex="-1"></a><span class="co">#Trim out the warm up period</span></span>
<span id="cb291-27"><a href="modelingintro.html#cb291-27" aria-hidden="true" tabindex="-1"></a>OutTrim <span class="ot">&lt;-</span> <span class="fu">filter</span>(Out, DATE <span class="sc">&gt;=</span> <span class="fu">mdy</span>(<span class="st">&quot;01-01-2011&quot;</span>))</span>
<span id="cb291-28"><a href="modelingintro.html#cb291-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-29"><a href="modelingintro.html#cb291-29" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate NSE</span></span>
<span id="cb291-30"><a href="modelingintro.html#cb291-30" aria-hidden="true" tabindex="-1"></a>NSE <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> ((<span class="fu">sum</span>((OutTrim<span class="sc">$</span>q <span class="sc">-</span> OutTrim<span class="sc">$</span>WS_3) <span class="sc">^</span> <span class="dv">2</span>)) <span class="sc">/</span> </span>
<span id="cb291-31"><a href="modelingintro.html#cb291-31" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">sum</span>((OutTrim<span class="sc">$</span>WS_3 <span class="sc">-</span> <span class="fu">mean</span>(OutTrim<span class="sc">$</span>WS_3)) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb291-32"><a href="modelingintro.html#cb291-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-33"><a href="modelingintro.html#cb291-33" aria-hidden="true" tabindex="-1"></a><span class="co">#Create plot with NSE in title</span></span>
<span id="cb291-34"><a href="modelingintro.html#cb291-34" aria-hidden="true" tabindex="-1"></a>OutTrim <span class="sc">%&gt;%</span> <span class="fu">plot_ly</span>(<span class="at">x =</span> <span class="sc">~</span>DATE) <span class="sc">%&gt;%</span> </span>
<span id="cb291-35"><a href="modelingintro.html#cb291-35" aria-hidden="true" tabindex="-1"></a>        <span class="fu">add_trace</span>(<span class="at">y =</span> <span class="sc">~</span>q, <span class="at">name =</span> <span class="st">&#39;Modeled&#39;</span>,  <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="at">mode =</span> <span class="st">&#39;lines&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb291-36"><a href="modelingintro.html#cb291-36" aria-hidden="true" tabindex="-1"></a>        <span class="fu">add_trace</span>(<span class="at">y =</span> <span class="sc">~</span>WS_3, <span class="at">name =</span> <span class="st">&#39;Measured&#39;</span>, <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="at">mode =</span> <span class="st">&#39;lines&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb291-37"><a href="modelingintro.html#cb291-37" aria-hidden="true" tabindex="-1"></a>        <span class="fu">layout</span>(<span class="at">title=</span><span class="fu">paste</span>(<span class="st">&quot;NSE: &quot;</span>, <span class="fu">round</span>(NSE,<span class="dv">2</span>)))</span></code></pre></div>
<div id="htmlwidget-b0eb3990ffab8bc64a6c" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-b0eb3990ffab8bc64a6c">{"x":{"visdat":{"11ce4a30b3b6":["function () ","plotlyVisDat"]},"cur_data":"11ce4a30b3b6","attrs":{"11ce4a30b3b6":{"x":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"name":"Modeled","type":"scatter","mode":"lines","inherit":true},"11ce4a30b3b6.1":{"x":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"name":"Measured","type":"scatter","mode":"lines","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"NSE:  0.21","xaxis":{"domain":[0,1],"automargin":true,"title":"DATE"},"yaxis":{"domain":[0,1],"automargin":true,"title":"q"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["2011-01-01","2011-01-02","2011-01-03","2011-01-04","2011-01-05","2011-01-06","2011-01-07","2011-01-08","2011-01-09","2011-01-10","2011-01-11","2011-01-12","2011-01-13","2011-01-14","2011-01-15","2011-01-16","2011-01-17","2011-01-18","2011-01-19","2011-01-20","2011-01-21","2011-01-22","2011-01-23","2011-01-24","2011-01-25","2011-01-26","2011-01-27","2011-01-28","2011-01-29","2011-01-30","2011-01-31","2011-02-01","2011-02-02","2011-02-03","2011-02-04","2011-02-05","2011-02-06","2011-02-07","2011-02-08","2011-02-09","2011-02-10","2011-02-11","2011-02-12","2011-02-13","2011-02-14","2011-02-15","2011-02-16","2011-02-17","2011-02-18","2011-02-19","2011-02-20","2011-02-21","2011-02-22","2011-02-23","2011-02-24","2011-02-25","2011-02-26","2011-02-27","2011-02-28","2011-03-01","2011-03-02","2011-03-03","2011-03-04","2011-03-05","2011-03-06","2011-03-07","2011-03-08","2011-03-09","2011-03-10","2011-03-11","2011-03-12","2011-03-13","2011-03-14","2011-03-15","2011-03-16","2011-03-17","2011-03-18","2011-03-19","2011-03-20","2011-03-21","2011-03-22","2011-03-23","2011-03-24","2011-03-25","2011-03-26","2011-03-27","2011-03-28","2011-03-29","2011-03-30","2011-03-31","2011-04-01","2011-04-02","2011-04-03","2011-04-04","2011-04-05","2011-04-06","2011-04-07","2011-04-08","2011-04-09","2011-04-10","2011-04-11","2011-04-12","2011-04-13","2011-04-14","2011-04-15","2011-04-16","2011-04-17","2011-04-18","2011-04-19","2011-04-20","2011-04-21","2011-04-22","2011-04-23","2011-04-24","2011-04-25","2011-04-26","2011-04-27","2011-04-28","2011-04-29","2011-04-30","2011-05-01","2011-05-02","2011-05-03","2011-05-04","2011-05-05","2011-05-06","2011-05-07","2011-05-08","2011-05-09","2011-05-10","2011-05-11","2011-05-12","2011-05-13","2011-05-14","2011-05-15","2011-05-16","2011-05-17","2011-05-18","2011-05-19","2011-05-20","2011-05-21","2011-05-22","2011-05-23","2011-05-24","2011-05-25","2011-05-26","2011-05-27","2011-05-28","2011-05-29","2011-05-30","2011-05-31","2011-06-01","2011-06-02","2011-06-03","2011-06-04","2011-06-05","2011-06-06","2011-06-07","2011-06-08","2011-06-09","2011-06-10","2011-06-11","2011-06-12","2011-06-13","2011-06-14","2011-06-15","2011-06-16","2011-06-17","2011-06-18","2011-06-19","2011-06-20","2011-06-21","2011-06-22","2011-06-23","2011-06-24","2011-06-25","2011-06-26","2011-06-27","2011-06-28","2011-06-29","2011-06-30","2011-07-01","2011-07-02","2011-07-03","2011-07-04","2011-07-05","2011-07-06","2011-07-07","2011-07-08","2011-07-09","2011-07-10","2011-07-11","2011-07-12","2011-07-13","2011-07-14","2011-07-15","2011-07-16","2011-07-17","2011-07-18","2011-07-19","2011-07-20","2011-07-21","2011-07-22","2011-07-23","2011-07-24","2011-07-25","2011-07-26","2011-07-27","2011-07-28","2011-07-29","2011-07-30","2011-07-31","2011-08-01","2011-08-02","2011-08-03","2011-08-04","2011-08-05","2011-08-06","2011-08-07","2011-08-08","2011-08-09","2011-08-10","2011-08-11","2011-08-12","2011-08-13","2011-08-14","2011-08-15","2011-08-16","2011-08-17","2011-08-18","2011-08-19","2011-08-20","2011-08-21","2011-08-22","2011-08-23","2011-08-24","2011-08-25","2011-08-26","2011-08-27","2011-08-28","2011-08-29","2011-08-30","2011-08-31","2011-09-01","2011-09-02","2011-09-03","2011-09-04","2011-09-05","2011-09-06","2011-09-07","2011-09-08","2011-09-09","2011-09-10","2011-09-11","2011-09-12","2011-09-13","2011-09-14","2011-09-15","2011-09-16","2011-09-17","2011-09-18","2011-09-19","2011-09-20","2011-09-21","2011-09-22","2011-09-23","2011-09-24","2011-09-25","2011-09-26","2011-09-27","2011-09-28","2011-09-29","2011-09-30","2011-10-01","2011-10-02","2011-10-03","2011-10-04","2011-10-05","2011-10-06","2011-10-07","2011-10-08","2011-10-09","2011-10-10","2011-10-11","2011-10-12","2011-10-13","2011-10-14","2011-10-15","2011-10-16","2011-10-17","2011-10-18","2011-10-19","2011-10-20","2011-10-21","2011-10-22","2011-10-23","2011-10-24","2011-10-25","2011-10-26","2011-10-27","2011-10-28","2011-10-29","2011-10-30","2011-10-31","2011-11-01","2011-11-02","2011-11-03","2011-11-04","2011-11-05","2011-11-06","2011-11-07","2011-11-08","2011-11-09","2011-11-10","2011-11-11","2011-11-12","2011-11-13","2011-11-14","2011-11-15","2011-11-16","2011-11-17","2011-11-18","2011-11-19","2011-11-20","2011-11-21","2011-11-22","2011-11-23","2011-11-24","2011-11-25","2011-11-26","2011-11-27","2011-11-28","2011-11-29","2011-11-30","2011-12-01","2011-12-02","2011-12-03","2011-12-04","2011-12-05","2011-12-06","2011-12-07","2011-12-08","2011-12-09","2011-12-10","2011-12-11","2011-12-12","2011-12-13","2011-12-14","2011-12-15","2011-12-16","2011-12-17","2011-12-18","2011-12-19","2011-12-20","2011-12-21","2011-12-22","2011-12-23","2011-12-24","2011-12-25","2011-12-26","2011-12-27","2011-12-28","2011-12-29","2011-12-30","2011-12-31","2012-01-01","2012-01-02","2012-01-03","2012-01-04","2012-01-05","2012-01-06","2012-01-07","2012-01-08","2012-01-09","2012-01-10","2012-01-11","2012-01-12","2012-01-13","2012-01-14","2012-01-15","2012-01-16","2012-01-17","2012-01-18","2012-01-19","2012-01-20","2012-01-21","2012-01-22","2012-01-23","2012-01-24","2012-01-25","2012-01-26","2012-01-27","2012-01-28","2012-01-29","2012-01-30","2012-01-31","2012-02-01","2012-02-02","2012-02-03","2012-02-04","2012-02-05","2012-02-06","2012-02-07","2012-02-08","2012-02-09","2012-02-10","2012-02-11","2012-02-12","2012-02-13","2012-02-14","2012-02-15","2012-02-16","2012-02-17","2012-02-18","2012-02-19","2012-02-20","2012-02-21","2012-02-22","2012-02-23","2012-02-24","2012-02-25","2012-02-26","2012-02-27","2012-02-28","2012-02-29","2012-03-01","2012-03-02","2012-03-03","2012-03-04","2012-03-05","2012-03-06","2012-03-07","2012-03-08","2012-03-09","2012-03-10","2012-03-11","2012-03-12","2012-03-13","2012-03-14","2012-03-15","2012-03-16","2012-03-17","2012-03-18","2012-03-19","2012-03-20","2012-03-21","2012-03-22","2012-03-23","2012-03-24","2012-03-25","2012-03-26","2012-03-27","2012-03-28","2012-03-29","2012-03-30","2012-03-31","2012-04-01","2012-04-02","2012-04-03","2012-04-04","2012-04-05","2012-04-06","2012-04-07","2012-04-08","2012-04-09","2012-04-10","2012-04-11","2012-04-12","2012-04-13","2012-04-14","2012-04-15","2012-04-16","2012-04-17","2012-04-18","2012-04-19","2012-04-20","2012-04-21","2012-04-22","2012-04-23","2012-04-24","2012-04-25","2012-04-26","2012-04-27","2012-04-28","2012-04-29","2012-04-30","2012-05-01","2012-05-02","2012-05-03","2012-05-04","2012-05-05","2012-05-06","2012-05-07","2012-05-08","2012-05-09","2012-05-10","2012-05-11","2012-05-12","2012-05-13","2012-05-14","2012-05-15","2012-05-16","2012-05-17","2012-05-18","2012-05-19","2012-05-20","2012-05-21","2012-05-22","2012-05-23","2012-05-24","2012-05-25","2012-05-26","2012-05-27","2012-05-28","2012-05-29","2012-05-30","2012-05-31","2012-06-01","2012-06-02","2012-06-03","2012-06-04","2012-06-05","2012-06-06","2012-06-07","2012-06-08","2012-06-09","2012-06-10","2012-06-11","2012-06-12","2012-06-13","2012-06-14","2012-06-15","2012-06-16","2012-06-17","2012-06-18","2012-06-19","2012-06-20","2012-06-21","2012-06-22","2012-06-23","2012-06-24","2012-06-25","2012-06-26","2012-06-27","2012-06-28","2012-06-29","2012-06-30","2012-07-01","2012-07-02","2012-07-03","2012-07-04","2012-07-05","2012-07-06","2012-07-07","2012-07-08","2012-07-09","2012-07-10","2012-07-11","2012-07-12","2012-07-13","2012-07-14","2012-07-15","2012-07-16","2012-07-17","2012-07-18","2012-07-19","2012-07-20","2012-07-21","2012-07-22","2012-07-23","2012-07-24","2012-07-25","2012-07-26","2012-07-27","2012-07-28","2012-07-29","2012-07-30","2012-07-31","2012-08-01","2012-08-02","2012-08-03","2012-08-04","2012-08-05","2012-08-06","2012-08-07","2012-08-08","2012-08-09","2012-08-10","2012-08-11","2012-08-12","2012-08-13","2012-08-14","2012-08-15","2012-08-16","2012-08-17","2012-08-18","2012-08-19","2012-08-20","2012-08-21","2012-08-22","2012-08-23","2012-08-24","2012-08-25","2012-08-26","2012-08-27","2012-08-28","2012-08-29","2012-08-30","2012-08-31","2012-09-01","2012-09-02","2012-09-03","2012-09-04","2012-09-05","2012-09-06","2012-09-07","2012-09-08","2012-09-09","2012-09-10","2012-09-11","2012-09-12","2012-09-13","2012-09-14","2012-09-15","2012-09-16","2012-09-17","2012-09-18","2012-09-19","2012-09-20","2012-09-21","2012-09-22","2012-09-23","2012-09-24","2012-09-25","2012-09-26","2012-09-27","2012-09-28","2012-09-29","2012-09-30","2012-10-01","2012-10-02","2012-10-03","2012-10-04","2012-10-05","2012-10-06","2012-10-07","2012-10-08","2012-10-09","2012-10-10","2012-10-11","2012-10-12","2012-10-13","2012-10-14","2012-10-15","2012-10-16","2012-10-17","2012-10-18","2012-10-19","2012-10-20","2012-10-21","2012-10-22","2012-10-23","2012-10-24","2012-10-25","2012-10-26","2012-10-27","2012-10-28","2012-10-29","2012-10-30","2012-10-31","2012-11-01","2012-11-02","2012-11-03","2012-11-04","2012-11-05","2012-11-06","2012-11-07","2012-11-08","2012-11-09","2012-11-10","2012-11-11","2012-11-12","2012-11-13","2012-11-14","2012-11-15","2012-11-16","2012-11-17","2012-11-18","2012-11-19","2012-11-20","2012-11-21","2012-11-22","2012-11-23","2012-11-24","2012-11-25","2012-11-26","2012-11-27","2012-11-28","2012-11-29","2012-11-30","2012-12-01","2012-12-02","2012-12-03","2012-12-04","2012-12-05","2012-12-06","2012-12-07","2012-12-08","2012-12-09","2012-12-10","2012-12-11","2012-12-12","2012-12-13","2012-12-14","2012-12-15","2012-12-16","2012-12-17","2012-12-18","2012-12-19","2012-12-20","2012-12-21","2012-12-22","2012-12-23","2012-12-24","2012-12-25","2012-12-26","2012-12-27","2012-12-28","2012-12-29","2012-12-30","2012-12-31"],"y":[2.20774117508333,2.2971839203006,2.15935288508256,2.02979171197761,1.90800420925895,1.79352395670341,1.68591251930121,1.58475776814314,1.48967230205455,1.40029196393128,1.3162744460954,1.23729797932968,1.16306010056989,1.0932764945357,1.02767990486356,0.966019110571745,0.90805796393744,0.853574486101194,0.802360016935122,0.754218415919015,0.708965310963874,0.666427392306042,0.626441748767679,0.588855243841619,0.553523929211121,0.520312493458454,0.489093743850947,0.45974811921989,0.432163232066697,0.406233438142695,0.381859431854133,0.358947865942885,0.337410993986312,0.317166334347133,0.298136354286305,0.280248173029127,0.421425976692089,0.524024999661504,0.492583499681814,0.463028489700905,0.435246780318851,0.40913197349972,0.384584055089736,0.361509011784352,0.339818471077291,0.319429362812654,0.300263601043894,0.307054781375343,0.703481965849635,0.661273047898657,0.621596665024737,0.584300865123253,0.549242813215858,0.516288244422906,0.485310949757532,0.45619229277208,0.428820755205755,0.40309150989341,0.378906019299805,0.356171658141817,0.334801358653308,0.314713277134109,0.295830480506063,0.278080651675699,3.63376858768835,3.41574247242705,3.21079792408142,3.01815004863654,2.83706104571835,3.65292121086508,3.65139230943902,3.60233517799904,3.38619506731909,3.18302336327995,2.99204196148315,3.13990239824514,3.4623031825916,3.2545649916361,3.05929109213794,2.87573362660966,2.70318960901308,2.5409982324723,2.38853833852396,2.24522603821252,2.11051247591977,1.98388172736458,1.86484882372271,1.75295789429935,1.64778042064139,1.5489135954029,1.45597877967873,1.45367775296415,1.5308653810262,2.10000914710574,2.65944638966799,2.71846972799602,2.72007681062466,2.85340670644027,3.24246749819308,4.3877303024394,6.31652309936375,6.58838290764232,6.92795441494659,6.86922887112862,6.4570751388609,6.06965063052925,7.3529228014864,7.31072447881726,7.30106027616031,7.627967831854,7.45528119053912,7.11022848900892,7.51413567278283,7.12048819288825,7.25362140067021,8.22903404239332,7.80019728865122,7.73274838919321,7.28839833082813,6.85109443097844,6.44002876511973,6.05362703921255,5.69420478821519,6.05499637057883,5.74181094714845,5.39730229031955,5.07346415290037,4.76905630372635,4.48291292550277,4.2139381499726,3.96110186097425,3.72343574931579,3.50002960435685,3.53053363109293,4.50584860250118,4.29428212896979,4.18592824913648,4.19521342687021,4.6392366514223,4.50878252714017,4.93607990488426,4.68149003452559,4.83253463156086,4.54258255366721,4.27002760044718,4.14819539489195,3.94759269175695,3.71073713025153,3.48809290243644,3.34228244115663,3.14174549468723,2.953240765006,2.78117357486966,2.61430316037748,2.45744497075483,2.30999827250954,2.17139837615897,2.04111447358943,1.91921895125468,1.82766565046289,1.71800571143511,1.87675593099792,1.88033713007371,2.25025606391997,2.23360113559758,2.14332674331392,2.02571744979947,2.00428691467014,1.98363409776484,1.88910581244743,1.77575946370058,1.66921389587855,1.65359932666852,1.88101471874002,2.45795764458041,2.34645092834782,2.3451591266491,2.21676783507688,2.11167589792057,1.98497534404534,1.87526405331316,1.77010353376309,1.6638973217373,1.5954819021931,1.49975298806151,1.40976780877782,1.46321294192839,1.37542016541269,1.29613081316795,1.33823022886882,1.25793641513669,1.18246023022849,1.11151261641478,1.04813793251462,0.98524965656374,0.926134677169916,0.870566596539721,0.818332600747338,0.845767861573868,0.795021789879436,0.74732048248667,0.70248125353747,0.660332378325221,0.620712435625708,0.583469689488166,0.59654750506735,0.602451355536488,0.566304274204299,0.532326017752041,0.612623881557175,0.587681863371946,0.55242095156963,0.519275694475452,0.503387849955011,0.479516188102603,0.469420003001994,0.441254802821875,0.419518181460668,0.540509803240937,0.524160994832656,0.579944491911108,0.850985953812835,0.799926796584065,0.751931188789021,0.70681531746168,1.26991121280771,3.19867277467407,3.80588239332448,3.57752944972501,3.38032965838552,3.18917743213173,2.99782678620382,4.36304472171253,4.34364907241743,4.08303012807238,3.83804832038804,3.95328947070578,3.71609210246343,3.61335380851222,9.61576045966751,9.11572682348777,8.56878321407851,8.0546562212338,7.57137684795977,7.11709423708218,6.69006858285725,6.64773345769638,7.11175054734351,7.05045513174939,7.46642918878307,7.39094982231766,6.9474928329786,6.53064326299988,6.13880466721989,5.7704763871867,5.42424780395549,5.09879293571816,5.31859515281319,4.99947944364439,4.69951067702573,4.41754003640419,4.15248763421994,3.95820646621026,3.72071407823765,3.81266034247257,3.69696203415491,3.57278352707865,3.35841651545393,3.15691152452669,2.96749683305509,2.78944702307179,3.51194948074047,4.59740050249884,4.80467345899222,6.27445547966822,6.03942596145149,5.717235860622,5.4706416532466,5.14240315405181,4.8338589648087,4.54382742692018,4.27119778130496,4.01492591442667,3.77403035956107,3.5475885379874,3.47046613972193,5.22631930895635,5.30312119029803,5.2456703923009,5.00318668997873,4.70299548858,4.59749855909345,4.67217383308621,4.39184340310104,4.15866007844223,3.9091404737357,3.77727198006081,3.55063566125716,3.33759752158173,3.46912897013091,3.34307079545995,3.45096803129834,3.45011310399836,3.24310631775846,3.04851993869295,2.86560874237137,2.69367221782909,2.53205188475934,2.38012877167378,2.23732104537336,2.10308178265095,1.9768968756919,1.85828306315038,2.27438003287883,2.17149814874274,2.04120825981818,1.91873576422908,1.99213960658381,1.89769527989475,2.0818459890858,2.01014479885974,1.88953611092816,1.77616394427247,1.66959410761612,1.56941846115915,1.4818875482743,2.6476219637863,2.48876464595912,2.35246377705524,2.21131595043193,2.07863699340601,1.95391877380165,2.04775315226985,3.17895089609691,3.00791339330131,2.82743858970323,2.65779227432103,2.49832473786177,2.34842525359007,2.45225706967553,3.1247071508549,2.93722472180361,2.76099123849539,2.59533176418567,2.43961185833453,2.3481848367764,2.34340876376396,2.2302910920021,3.14789788386536,3.05467868412039,2.87139796307317,2.69911408528878,2.53716724017145,2.38493720576116,2.24184097341549,2.42467042362989,2.2791901982121,2.14243878631937,2.01389245914021,1.8930589115918,1.77947537689629,1.67270685428251,1.57234444302556,1.47800377644403,1.52537247984005,1.98912027991854,1.86977306312343,1.75758667933602,1.65213147857586,1.55300358986131,1.45982337446963,1.37223397200145,1.28989993368137,1.21250593766048,1.13975558140085,1.0713702465168,1.0070880317258,0.946662749822247,0.889862984832913,0.836471205742938,0.786282933398362,0.73910595739446,0.694759599950792,0.653074023953745,0.61388958251652,0.577056207565529,0.542432835111597,0.509886865004901,0.479293653104607,0.450536033918331,0.656229074020844,2.42803986291425,2.44019293558588,2.29378135945073,2.15615447788368,2.02678520921066,2.1433097299651,2.01471114616719,1.89382847739716,1.78019876875333,1.67338684262813,1.57298363207044,1.47860461414622,1.38988833729744,1.3064950370596,1.26642953523993,1.19044376312553,1.119017137338,1.05187610909772,0.988763542551857,0.933252385376154,1.09429677175311,1.491058180414,1.49792346545737,1.40804805752993,1.32356517407813,1.24415126363345,1.4647690888635,1.59688567267242,2.28767508824638,2.1504145829516,2.0213897079745,1.90010632549603,1.78609994596627,1.67893394920829,1.57819791225579,1.48350603752045,2.06480334699589,1.98541096460833,1.86628630673183,1.75430912832792,1.83187181721759,2.68872838237568,3.08499596743502,2.89989620938892,2.87909018741867,3.46206653194824,3.59952982210477,3.4412663642376,3.31356735317395,3.46906513237247,3.26092122443012,3.06526595096432,2.88134999390646,2.70846899427207,2.54596085461575,2.3932032033388,2.24961101113847,2.14997315734537,2.19147953450885,2.18444738767673,2.05338054441613,2.00572640380514,1.97568260736705,1.88474539328155,1.77166066968466,1.69099628894403,1.58953651160739,1.49416432091094,1.40451446165629,1.32024359395691,1.24102897831949,1.16656723962032,1.10939264264323,1.3813238378006,1.29844440753256,1.22053774308061,1.14730547849577,1.07846714978603,1.01375912079886,0.952933573550932,0.895757559137876,0.842012105589603,0.791491379254227,0.744001896498974,0.699361782709035,0.816949045525737,1.35176317863778,2.66483286602772,2.60687021690865,2.45045800389413,2.82392246537879,2.78625100420667,2.61907594395427,2.46193138731701,2.31421550407799,2.97469191616594,2.86827425172172,2.80072659339931,3.32474695829686,3.16565082053646,2.97571177130428,2.79716906502602,3.60759633986132,3.63832504470801,4.37435792371112,4.28350598832635,4.02649562902677,3.78490589128517,3.65879310813106,5.89055781903046,6.07218503902957,5.81351382041413,5.46470299118928,5.13682081171793,4.82861156301485,4.59531369557878,4.39654041203473,4.13274798731265,3.88478310807389,3.75852709793384,3.53301547205781,3.32103454373434,3.13267409609997,5.05314952135079,4.76820416336566,4.48211191356372,4.2131851987499,6.20818321128726,6.20536025851358,6.10263581882132,5.75955651332837,5.78770823187815,5.47866816351186,5.52610268197738,5.19843187757933,4.88652596492457,4.5933344070291,4.88480742316116,5.51183169931457,5.1811217973557,4.87025448951436,4.57803922014349,4.30335686693488,4.04515545491879,3.80244612762366,3.57429935996624,3.35984139836827,3.15825091446617,2.9687558595982,2.79063050802231,3.47908750688768,3.30064011213794,3.24872651597683,3.05380292501822,2.87057474951713,2.6983402645461,2.55356821369744,2.40404907144001,2.25980612715361,2.40531455738712,2.2609956839439,2.12533594290726,1.99781578633283,1.87794683915286,1.76527002880368,1.65935382707546,1.55979259745094,1.46620504160388,1.37823273910765,1.29553877476119,1.2199562110841,1.15162075220408,1.14070623127011,1.07424054133921,1.00978610885886,0.949198942327328,0.892247005787689,0.838712185440427,0.835392181099506,0.944562064028619,0.887888340186902,0.920558656315304,0.886563032906523,1.0206626317892,1.41566348382241,1.33072367479307,1.25088025430549,1.29595249129093,1.21819534181347,1.14510362130467,1.07639740402639,1.26817400394645,1.19208356370966,1.12055854988708,1.05332503689386,2.23457974277863,6.04204065411857,6.14250840735466,6.04911141291423,5.68616472813937,5.34499484445101,5.31823254064463,4.99913858820595,4.76799137786073,4.48191189518909,4.21299718147774,3.96021735058908,3.72260430955373,3.49924805098051,3.28929316792168,3.09193557784638,2.90641944317559,2.73203427658506,2.73963177461672,3.22251706515042,3.02916604124139,2.84741607876691,2.69592481434186,2.53416932548134,2.5900067372666,2.4346063330306,2.53076857237605,2.87723074327225,2.70459689867591,2.54232108475536,3.08484194599656,2.89975142923677,2.72576634348256,2.56222036287361,2.40848714110119,2.26397791263512,2.12813923787701,2.00045088360439,1.88042383058813,1.76759840075284,4.62716877971383,4.53512344437524,4.26301603771272,4.00723507544996,3.92285440704684,3.80859104050032,3.5800755780703,3.36527104338608,3.20191686042894,3.03297893138996,3.23214522332511,3.10057180861891,3.0325785053369,3.24268030680363,3.04811948839542,3.39117568929634,3.33997604944504,3.14726336091734,3.25781847220165,3.21538498267861,3.05649941940178,2.87310945423768,3.02147343703168,2.85149501344629,2.82794986974937,2.65827287756441,2.84283455297959,2.79456707261432,2.65347483802002,2.49426634773882,2.34461036687449,3.49877939932098,3.52388786899367,3.37022094772895,3.16800769086521,2.9779272294133,2.7992515956485,2.63129649990959,2.47341870991501,2.32501358732011,2.18551277208091,2.71447026798776,4.39677555650369,4.25254678936768,3.99739398200562,3.77163083261461,3.54533298265774,3.33261300369827,3.13265622347638,2.94469685006779,2.76801503906373,2.68336179582444,2.54664210130407,2.39384357522583,2.25021296071228,2.11520018306954,2.54523985613781,2.39252546476954,2.24897393688337,2.11403550067037,1.98719337063015,1.86796176839234,1.7558840622888,1.65053101855147,1.55149915743838,1.45840920799208,1.38041590475236,1.35004042457723,1.26903799910259,1.19289571915644,1.12132197600705,1.05404265744663,0.99080009799983,0.93135209211984,0.87547096659265,1.53267686609211,1.60447354485833,1.53386061993155,1.86253596814951,1.75078381006054,1.64573678145691,1.58610406471865,1.49950203949537,2.5800761790585,2.42527160831499,2.27975531181609,2.14296999310713,2.0143917935207,1.89352828590946,1.77991658875489,1.6731215934296,2.45948236807952,2.56590893946603,2.44052501249821,3.54241601570315,3.32987105476096,3.1300787914753,2.94227406398679,2.76573762014758,2.59979336293872,2.4438057611624,2.29717741549266,2.1593467705631,2.02978596432931,1.90799880646955],"name":"Modeled","type":"scatter","mode":"lines","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2011-01-01","2011-01-02","2011-01-03","2011-01-04","2011-01-05","2011-01-06","2011-01-07","2011-01-08","2011-01-09","2011-01-10","2011-01-11","2011-01-12","2011-01-13","2011-01-14","2011-01-15","2011-01-16","2011-01-17","2011-01-18","2011-01-19","2011-01-20","2011-01-21","2011-01-22","2011-01-23","2011-01-24","2011-01-25","2011-01-26","2011-01-27","2011-01-28","2011-01-29","2011-01-30","2011-01-31","2011-02-01","2011-02-02","2011-02-03","2011-02-04","2011-02-05","2011-02-06","2011-02-07","2011-02-08","2011-02-09","2011-02-10","2011-02-11","2011-02-12","2011-02-13","2011-02-14","2011-02-15","2011-02-16","2011-02-17","2011-02-18","2011-02-19","2011-02-20","2011-02-21","2011-02-22","2011-02-23","2011-02-24","2011-02-25","2011-02-26","2011-02-27","2011-02-28","2011-03-01","2011-03-02","2011-03-03","2011-03-04","2011-03-05","2011-03-06","2011-03-07","2011-03-08","2011-03-09","2011-03-10","2011-03-11","2011-03-12","2011-03-13","2011-03-14","2011-03-15","2011-03-16","2011-03-17","2011-03-18","2011-03-19","2011-03-20","2011-03-21","2011-03-22","2011-03-23","2011-03-24","2011-03-25","2011-03-26","2011-03-27","2011-03-28","2011-03-29","2011-03-30","2011-03-31","2011-04-01","2011-04-02","2011-04-03","2011-04-04","2011-04-05","2011-04-06","2011-04-07","2011-04-08","2011-04-09","2011-04-10","2011-04-11","2011-04-12","2011-04-13","2011-04-14","2011-04-15","2011-04-16","2011-04-17","2011-04-18","2011-04-19","2011-04-20","2011-04-21","2011-04-22","2011-04-23","2011-04-24","2011-04-25","2011-04-26","2011-04-27","2011-04-28","2011-04-29","2011-04-30","2011-05-01","2011-05-02","2011-05-03","2011-05-04","2011-05-05","2011-05-06","2011-05-07","2011-05-08","2011-05-09","2011-05-10","2011-05-11","2011-05-12","2011-05-13","2011-05-14","2011-05-15","2011-05-16","2011-05-17","2011-05-18","2011-05-19","2011-05-20","2011-05-21","2011-05-22","2011-05-23","2011-05-24","2011-05-25","2011-05-26","2011-05-27","2011-05-28","2011-05-29","2011-05-30","2011-05-31","2011-06-01","2011-06-02","2011-06-03","2011-06-04","2011-06-05","2011-06-06","2011-06-07","2011-06-08","2011-06-09","2011-06-10","2011-06-11","2011-06-12","2011-06-13","2011-06-14","2011-06-15","2011-06-16","2011-06-17","2011-06-18","2011-06-19","2011-06-20","2011-06-21","2011-06-22","2011-06-23","2011-06-24","2011-06-25","2011-06-26","2011-06-27","2011-06-28","2011-06-29","2011-06-30","2011-07-01","2011-07-02","2011-07-03","2011-07-04","2011-07-05","2011-07-06","2011-07-07","2011-07-08","2011-07-09","2011-07-10","2011-07-11","2011-07-12","2011-07-13","2011-07-14","2011-07-15","2011-07-16","2011-07-17","2011-07-18","2011-07-19","2011-07-20","2011-07-21","2011-07-22","2011-07-23","2011-07-24","2011-07-25","2011-07-26","2011-07-27","2011-07-28","2011-07-29","2011-07-30","2011-07-31","2011-08-01","2011-08-02","2011-08-03","2011-08-04","2011-08-05","2011-08-06","2011-08-07","2011-08-08","2011-08-09","2011-08-10","2011-08-11","2011-08-12","2011-08-13","2011-08-14","2011-08-15","2011-08-16","2011-08-17","2011-08-18","2011-08-19","2011-08-20","2011-08-21","2011-08-22","2011-08-23","2011-08-24","2011-08-25","2011-08-26","2011-08-27","2011-08-28","2011-08-29","2011-08-30","2011-08-31","2011-09-01","2011-09-02","2011-09-03","2011-09-04","2011-09-05","2011-09-06","2011-09-07","2011-09-08","2011-09-09","2011-09-10","2011-09-11","2011-09-12","2011-09-13","2011-09-14","2011-09-15","2011-09-16","2011-09-17","2011-09-18","2011-09-19","2011-09-20","2011-09-21","2011-09-22","2011-09-23","2011-09-24","2011-09-25","2011-09-26","2011-09-27","2011-09-28","2011-09-29","2011-09-30","2011-10-01","2011-10-02","2011-10-03","2011-10-04","2011-10-05","2011-10-06","2011-10-07","2011-10-08","2011-10-09","2011-10-10","2011-10-11","2011-10-12","2011-10-13","2011-10-14","2011-10-15","2011-10-16","2011-10-17","2011-10-18","2011-10-19","2011-10-20","2011-10-21","2011-10-22","2011-10-23","2011-10-24","2011-10-25","2011-10-26","2011-10-27","2011-10-28","2011-10-29","2011-10-30","2011-10-31","2011-11-01","2011-11-02","2011-11-03","2011-11-04","2011-11-05","2011-11-06","2011-11-07","2011-11-08","2011-11-09","2011-11-10","2011-11-11","2011-11-12","2011-11-13","2011-11-14","2011-11-15","2011-11-16","2011-11-17","2011-11-18","2011-11-19","2011-11-20","2011-11-21","2011-11-22","2011-11-23","2011-11-24","2011-11-25","2011-11-26","2011-11-27","2011-11-28","2011-11-29","2011-11-30","2011-12-01","2011-12-02","2011-12-03","2011-12-04","2011-12-05","2011-12-06","2011-12-07","2011-12-08","2011-12-09","2011-12-10","2011-12-11","2011-12-12","2011-12-13","2011-12-14","2011-12-15","2011-12-16","2011-12-17","2011-12-18","2011-12-19","2011-12-20","2011-12-21","2011-12-22","2011-12-23","2011-12-24","2011-12-25","2011-12-26","2011-12-27","2011-12-28","2011-12-29","2011-12-30","2011-12-31","2012-01-01","2012-01-02","2012-01-03","2012-01-04","2012-01-05","2012-01-06","2012-01-07","2012-01-08","2012-01-09","2012-01-10","2012-01-11","2012-01-12","2012-01-13","2012-01-14","2012-01-15","2012-01-16","2012-01-17","2012-01-18","2012-01-19","2012-01-20","2012-01-21","2012-01-22","2012-01-23","2012-01-24","2012-01-25","2012-01-26","2012-01-27","2012-01-28","2012-01-29","2012-01-30","2012-01-31","2012-02-01","2012-02-02","2012-02-03","2012-02-04","2012-02-05","2012-02-06","2012-02-07","2012-02-08","2012-02-09","2012-02-10","2012-02-11","2012-02-12","2012-02-13","2012-02-14","2012-02-15","2012-02-16","2012-02-17","2012-02-18","2012-02-19","2012-02-20","2012-02-21","2012-02-22","2012-02-23","2012-02-24","2012-02-25","2012-02-26","2012-02-27","2012-02-28","2012-02-29","2012-03-01","2012-03-02","2012-03-03","2012-03-04","2012-03-05","2012-03-06","2012-03-07","2012-03-08","2012-03-09","2012-03-10","2012-03-11","2012-03-12","2012-03-13","2012-03-14","2012-03-15","2012-03-16","2012-03-17","2012-03-18","2012-03-19","2012-03-20","2012-03-21","2012-03-22","2012-03-23","2012-03-24","2012-03-25","2012-03-26","2012-03-27","2012-03-28","2012-03-29","2012-03-30","2012-03-31","2012-04-01","2012-04-02","2012-04-03","2012-04-04","2012-04-05","2012-04-06","2012-04-07","2012-04-08","2012-04-09","2012-04-10","2012-04-11","2012-04-12","2012-04-13","2012-04-14","2012-04-15","2012-04-16","2012-04-17","2012-04-18","2012-04-19","2012-04-20","2012-04-21","2012-04-22","2012-04-23","2012-04-24","2012-04-25","2012-04-26","2012-04-27","2012-04-28","2012-04-29","2012-04-30","2012-05-01","2012-05-02","2012-05-03","2012-05-04","2012-05-05","2012-05-06","2012-05-07","2012-05-08","2012-05-09","2012-05-10","2012-05-11","2012-05-12","2012-05-13","2012-05-14","2012-05-15","2012-05-16","2012-05-17","2012-05-18","2012-05-19","2012-05-20","2012-05-21","2012-05-22","2012-05-23","2012-05-24","2012-05-25","2012-05-26","2012-05-27","2012-05-28","2012-05-29","2012-05-30","2012-05-31","2012-06-01","2012-06-02","2012-06-03","2012-06-04","2012-06-05","2012-06-06","2012-06-07","2012-06-08","2012-06-09","2012-06-10","2012-06-11","2012-06-12","2012-06-13","2012-06-14","2012-06-15","2012-06-16","2012-06-17","2012-06-18","2012-06-19","2012-06-20","2012-06-21","2012-06-22","2012-06-23","2012-06-24","2012-06-25","2012-06-26","2012-06-27","2012-06-28","2012-06-29","2012-06-30","2012-07-01","2012-07-02","2012-07-03","2012-07-04","2012-07-05","2012-07-06","2012-07-07","2012-07-08","2012-07-09","2012-07-10","2012-07-11","2012-07-12","2012-07-13","2012-07-14","2012-07-15","2012-07-16","2012-07-17","2012-07-18","2012-07-19","2012-07-20","2012-07-21","2012-07-22","2012-07-23","2012-07-24","2012-07-25","2012-07-26","2012-07-27","2012-07-28","2012-07-29","2012-07-30","2012-07-31","2012-08-01","2012-08-02","2012-08-03","2012-08-04","2012-08-05","2012-08-06","2012-08-07","2012-08-08","2012-08-09","2012-08-10","2012-08-11","2012-08-12","2012-08-13","2012-08-14","2012-08-15","2012-08-16","2012-08-17","2012-08-18","2012-08-19","2012-08-20","2012-08-21","2012-08-22","2012-08-23","2012-08-24","2012-08-25","2012-08-26","2012-08-27","2012-08-28","2012-08-29","2012-08-30","2012-08-31","2012-09-01","2012-09-02","2012-09-03","2012-09-04","2012-09-05","2012-09-06","2012-09-07","2012-09-08","2012-09-09","2012-09-10","2012-09-11","2012-09-12","2012-09-13","2012-09-14","2012-09-15","2012-09-16","2012-09-17","2012-09-18","2012-09-19","2012-09-20","2012-09-21","2012-09-22","2012-09-23","2012-09-24","2012-09-25","2012-09-26","2012-09-27","2012-09-28","2012-09-29","2012-09-30","2012-10-01","2012-10-02","2012-10-03","2012-10-04","2012-10-05","2012-10-06","2012-10-07","2012-10-08","2012-10-09","2012-10-10","2012-10-11","2012-10-12","2012-10-13","2012-10-14","2012-10-15","2012-10-16","2012-10-17","2012-10-18","2012-10-19","2012-10-20","2012-10-21","2012-10-22","2012-10-23","2012-10-24","2012-10-25","2012-10-26","2012-10-27","2012-10-28","2012-10-29","2012-10-30","2012-10-31","2012-11-01","2012-11-02","2012-11-03","2012-11-04","2012-11-05","2012-11-06","2012-11-07","2012-11-08","2012-11-09","2012-11-10","2012-11-11","2012-11-12","2012-11-13","2012-11-14","2012-11-15","2012-11-16","2012-11-17","2012-11-18","2012-11-19","2012-11-20","2012-11-21","2012-11-22","2012-11-23","2012-11-24","2012-11-25","2012-11-26","2012-11-27","2012-11-28","2012-11-29","2012-11-30","2012-12-01","2012-12-02","2012-12-03","2012-12-04","2012-12-05","2012-12-06","2012-12-07","2012-12-08","2012-12-09","2012-12-10","2012-12-11","2012-12-12","2012-12-13","2012-12-14","2012-12-15","2012-12-16","2012-12-17","2012-12-18","2012-12-19","2012-12-20","2012-12-21","2012-12-22","2012-12-23","2012-12-24","2012-12-25","2012-12-26","2012-12-27","2012-12-28","2012-12-29","2012-12-30","2012-12-31"],"y":[2.793,5.399,3.435,2.377,1.942,1.647,1.46,1.334,1.181,1.072,1.053,1.003,0.945,0.8,0.718,0.701,0.763,0.83,0.866,0.872,0.817,0.795,0.76,0.723,0.694,0.659,0.617,0.603,0.591,0.581,0.595,0.613,0.622,0.639,0.649,0.604,0.618,0.622,0.61,0.6,0.597,0.596,0.593,0.606,0.595,0.559,0.556,0.771,1.816,1.711,1.143,0.941,0.894,0.806,0.768,0.757,0.734,0.769,0.826,0.721,0.667,0.656,0.692,0.69,20.072,35.229,9.098,5.066,3.885,9.084,9.595,5.179,3.889,3.298,3.212,3.847,13.622,10.723,6.062,4.849,3.79,3.125,2.739,2.353,2.129,2.023,1.777,1.673,1.738,1.871,1.821,1.856,2.232,2.573,3.455,3.297,3.201,4.419,7.254,16.446,54.427,33.419,18.191,16.396,10.761,6.962,27.681,11.052,7.386,7.512,6.176,5.309,4.929,10.734,9.581,30.516,11.822,9.907,8.569,5.303,3.948,3.218,2.751,4.437,4.76,3.427,2.813,2.418,2.1,1.835,1.693,1.566,1.452,1.735,9.302,9.21,5.657,5.255,11.735,6.777,8.116,6.566,7.713,7.815,4.795,3.521,3.272,2.736,2.457,1.999,1.396,1.1,0.915,0.892,0.772,0.648,0.427,0.349,0.274,0.234,0.203,0.546,1.285,1.61,3.157,1.357,0.824,0.558,1.021,0.77,0.535,0.334,0.277,1.009,3.865,4.349,2.339,1.856,1.088,0.789,0.595,0.54,0.375,0.5,0.558,0.327,0.349,0.504,0.301,0.521,0.353,0.235,0.25,0.244,0.256,0.18,0.14,0.144,0.184,0.181,0.079,0.078,0.062,0.062,0.067,0.073,0.152,0.085,0.092,0.122,0.167,0.089,0.079,0.087,0.091,0.072,0.076,0.08,0.203,0.149,0.089,0.408,0.259,0.131,0.103,0.557,3.556,6.615,1.895,0.675,0.362,0.217,1.105,8.194,1.687,0.771,0.913,1.363,0.665,70.594,18.438,5.086,2.57,1.608,1.138,0.859,0.843,3.67,8.085,8.756,11.075,4.923,2.704,1.81,1.361,0.95,0.731,2.328,1.913,1.165,0.832,0.646,0.679,0.711,1.704,3.06,4.273,2.37,1.435,0.96,0.768,5.311,11.334,19.193,22.093,13.334,6.617,4.483,3.238,2.459,1.972,1.586,1.343,1.164,1.071,1.604,11.522,14.451,6.472,4.439,3.308,2.774,3.765,2.974,2.471,2.185,1.935,1.848,1.695,1.672,1.744,1.658,1.572,1.672,2.305,2.309,1.937,1.63,1.428,1.289,1.256,1.168,1.034,1.648,2.685,1.767,1.558,1.487,2.145,1.923,2.788,2.057,1.717,1.576,1.396,1.277,1.405,1.286,1.659,3.155,4.457,5.312,3.781,21.773,6.944,4.398,3.367,2.812,2.447,4.378,9.479,4.739,3.551,2.88,2.456,2.178,2.006,3.54,6.687,5.106,3.488,2.621,2.339,2.059,2.409,4.094,3.4,2.582,2.268,2.07,3.854,19.039,6.486,4.18,3.446,3.975,7.375,4.134,2.863,2.456,2.108,1.97,1.774,1.612,1.47,1.312,2.459,1.334,1.131,1.124,1.115,1.122,1.076,0.948,0.893,0.866,0.821,1.25,8.871,3.599,2.392,3.556,3.68,2.474,1.99,1.781,1.997,2.219,1.776,1.627,1.464,1.412,1.338,1.247,1.217,1.146,1.145,1.126,1.16,1.067,0.87,0.784,0.79,0.766,0.76,0.734,0.775,0.798,0.825,0.837,0.856,0.806,0.719,0.695,0.706,0.711,0.699,0.73,0.768,0.787,0.786,1.018,3.463,7.184,3.231,2.489,4.08,12.631,12.704,7.638,6.216,12.118,19.133,16.104,11.335,7.399,5.325,4.083,3.22,3.672,3.335,2.477,2.263,2.204,2.086,3.453,1.992,1.578,1.43,1.358,1.265,1.118,1.013,1.038,1.898,2.095,1.693,1.462,1.294,1.224,1.139,1.117,1.03,0.95,0.927,0.918,1.431,4.066,19.152,9.82,5.496,3.89,6.778,3.972,3.04,2.52,6.379,5.353,4.756,8.827,5.861,4.166,3.317,27.385,18.61,12.629,7.319,4.799,3.597,2.992,13.381,11.137,8.26,5.562,3.95,2.876,2.107,1.972,1.62,1.346,1.715,1.764,1.227,1.001,15.039,12.596,4.444,2.711,20.044,17.601,7.196,4.387,3.801,4.092,3.137,3.226,2.099,1.571,1.681,13.289,5.063,3.035,2.263,1.856,1.359,1.227,0.914,0.658,0.472,0.355,0.29,2.826,2.535,1.636,1.15,0.784,0.507,1.435,0.382,0.246,0.559,0.736,0.457,0.328,0.234,0.175,0.145,0.121,0.104,0.092,0.08,0.072,0.087,0.073,0.113,0.081,0.078,0.074,0.072,0.087,0.255,0.1,0.088,0.194,0.205,0.522,0.356,0.15,0.138,0.316,0.146,0.093,0.163,0.382,0.149,0.098,2.295,28.957,11.403,5.286,2.951,1.67,1.827,1.52,0.972,0.685,0.45,0.301,0.2,0.153,0.11,0.097,0.083,0.108,0.236,1.943,0.609,0.313,0.185,0.165,0.281,0.237,0.533,3.651,1.376,0.739,1.595,2.942,1.283,0.763,0.483,0.341,0.252,0.203,0.175,0.157,18.486,20.958,4.84,2.684,1.988,2.137,1.435,1.15,1.021,0.973,1.533,2.167,1.864,3.319,2.318,4.109,4.352,3.433,2.968,2.786,2.811,2.078,2.304,2.963,2.276,1.91,2.829,2.874,2.651,2.069,1.738,7.919,13.908,6.11,4.052,2.872,2.384,2.038,1.83,1.69,1.554,1.797,17.857,18.49,7.325,4.669,3.419,2.741,2.311,1.972,1.786,1.694,1.548,1.49,1.382,1.308,2.84,2.446,1.901,1.595,1.372,1.194,1.18,1.157,1.104,1.045,1.05,1.014,0.956,0.877,0.804,0.809,0.766,0.722,0.67,1.567,5.631,2.947,4.107,2.723,2.102,1.866,1.662,6.493,7.312,3.684,2.651,2.228,1.883,1.62,1.543,3.026,4.714,2.924,7.174,8.398,4.226,2.967,2.399,2.017,1.9,1.685,1.557,1.457,1.334],"name":"Measured","type":"scatter","mode":"lines","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="rgeowatersheds.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modelingcalibration.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Hydroinformatics_Bookdown.pdf", "Hydroinformatics_Bookdown.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
