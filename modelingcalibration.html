<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 18 Intro to Modeling - Calibrate HBV | Hydroinformatics at VT</title>
  <meta name="description" content="This bookdown contains notes and exercises for a course in hydroinformatics at Virginia Tech." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 18 Intro to Modeling - Calibrate HBV | Hydroinformatics at VT" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This bookdown contains notes and exercises for a course in hydroinformatics at Virginia Tech." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 18 Intro to Modeling - Calibrate HBV | Hydroinformatics at VT" />
  
  <meta name="twitter:description" content="This bookdown contains notes and exercises for a course in hydroinformatics at Virginia Tech." />
  

<meta name="author" content="JP Gannon" />


<meta name="date" content="2021-04-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modelingintro.html"/>

<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script>
<script src="libs/rglWebGL-binding-0.105.22/rglWebGL.js"></script>
<link href="libs/rglwidgetClass-0.105.22/rgl.css" rel="stylesheet" />
<script src="libs/rglwidgetClass-0.105.22/rglClass.min.js"></script>
<script src="libs/CanvasMatrix4-0.105.22/CanvasMatrix.min.js"></script>
<script src="libs/plotly-binding-4.9.3/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GBDXSZFFSR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-GBDXSZFFSR');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Hydroinformatics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#how-to-use-these-materials"><i class="fa fa-check"></i><b>1.1</b> How to use these materials</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#table-of-contents"><i class="fa fa-check"></i><b>1.2</b> Table of contents:</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Plotting.html"><a href="Plotting.html"><i class="fa fa-check"></i><b>2</b> Intro to Plotting</a>
<ul>
<li class="chapter" data-level="2.1" data-path="Plotting.html"><a href="Plotting.html#download-and-install-tidyverse-library"><i class="fa fa-check"></i><b>2.1</b> Download and install tidyverse library</a></li>
<li class="chapter" data-level="2.2" data-path="Plotting.html"><a href="Plotting.html#reading-data"><i class="fa fa-check"></i><b>2.2</b> Reading data</a></li>
<li class="chapter" data-level="2.3" data-path="Plotting.html"><a href="Plotting.html#our-first-ggplot"><i class="fa fa-check"></i><b>2.3</b> Our first ggplot</a></li>
<li class="chapter" data-level="2.4" data-path="Plotting.html"><a href="Plotting.html#change-point-type"><i class="fa fa-check"></i><b>2.4</b> Change point type</a></li>
<li class="chapter" data-level="2.5" data-path="Plotting.html"><a href="Plotting.html#set-colors"><i class="fa fa-check"></i><b>2.5</b> Set colors</a></li>
<li class="chapter" data-level="2.6" data-path="Plotting.html"><a href="Plotting.html#controlling-color-with-a-third-variable-and-other-functions"><i class="fa fa-check"></i><b>2.6</b> Controlling color with a third variable and other functions</a></li>
<li class="chapter" data-level="2.7" data-path="Plotting.html"><a href="Plotting.html#plotting-multiple-groups"><i class="fa fa-check"></i><b>2.7</b> Plotting multiple groups</a></li>
<li class="chapter" data-level="2.8" data-path="Plotting.html"><a href="Plotting.html#facets"><i class="fa fa-check"></i><b>2.8</b> Facets</a></li>
<li class="chapter" data-level="2.9" data-path="Plotting.html"><a href="Plotting.html#two-variable-faceting"><i class="fa fa-check"></i><b>2.9</b> Two variable faceting</a></li>
<li class="chapter" data-level="2.10" data-path="Plotting.html"><a href="Plotting.html#boxplots"><i class="fa fa-check"></i><b>2.10</b> Boxplots</a></li>
<li class="chapter" data-level="2.11" data-path="Plotting.html"><a href="Plotting.html#more-about-color-size-etc"><i class="fa fa-check"></i><b>2.11</b> More about color, size, etc</a></li>
<li class="chapter" data-level="2.12" data-path="Plotting.html"><a href="Plotting.html#multiple-geoms"><i class="fa fa-check"></i><b>2.12</b> Multiple geoms</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Programming.html"><a href="Programming.html"><i class="fa fa-check"></i><b>3</b> R Tidyverse Programming Basics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="Programming.html"><a href="Programming.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="Programming.html"><a href="Programming.html#you-can-use-r-as-a-calculator"><i class="fa fa-check"></i><b>3.2</b> You can use R as a calculator</a></li>
<li class="chapter" data-level="3.3" data-path="Programming.html"><a href="Programming.html#you-can-create-new-objects-using--"><i class="fa fa-check"></i><b>3.3</b> You can create new objects using &lt;-</a></li>
<li class="chapter" data-level="3.4" data-path="Programming.html"><a href="Programming.html#using-functions"><i class="fa fa-check"></i><b>3.4</b> Using functions</a></li>
<li class="chapter" data-level="3.5" data-path="Programming.html"><a href="Programming.html#read-in-some-data."><i class="fa fa-check"></i><b>3.5</b> Read in some data.</a></li>
<li class="chapter" data-level="3.6" data-path="Programming.html"><a href="Programming.html#wait-hold-up.-what-is-a-tibble"><i class="fa fa-check"></i><b>3.6</b> Wait, hold up. What is a tibble?</a></li>
<li class="chapter" data-level="3.7" data-path="Programming.html"><a href="Programming.html#data-wrangling-in-dplyr"><i class="fa fa-check"></i><b>3.7</b> Data wrangling in dplyr</a></li>
<li class="chapter" data-level="3.8" data-path="Programming.html"><a href="Programming.html#filter"><i class="fa fa-check"></i><b>3.8</b> Filter</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="Programming.html"><a href="Programming.html#multiple-conditions"><i class="fa fa-check"></i><b>3.8.1</b> Multiple conditions</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="Programming.html"><a href="Programming.html#arrange"><i class="fa fa-check"></i><b>3.9</b> Arrange</a></li>
<li class="chapter" data-level="3.10" data-path="Programming.html"><a href="Programming.html#select"><i class="fa fa-check"></i><b>3.10</b> Select</a></li>
<li class="chapter" data-level="3.11" data-path="Programming.html"><a href="Programming.html#mutate"><i class="fa fa-check"></i><b>3.11</b> Mutate</a></li>
<li class="chapter" data-level="3.12" data-path="Programming.html"><a href="Programming.html#summarize"><i class="fa fa-check"></i><b>3.12</b> Summarize</a></li>
<li class="chapter" data-level="3.13" data-path="Programming.html"><a href="Programming.html#multiple-operations-with-pipes"><i class="fa fa-check"></i><b>3.13</b> Multiple operations with pipes</a>
<ul>
<li class="chapter" data-level="3.13.1" data-path="Programming.html"><a href="Programming.html#lets-say-we-want-to-tell-r-to-make-a-pbj-sandwich-by-using-the-pbbread-jbread-and-joinslices-functions-and-the-data-ingredients.-if-we-do-this-saving-each-step-if-would-look-like-this"><i class="fa fa-check"></i><b>3.13.1</b> Let’s say we want to tell R to make a PB&amp;J sandwich by using the pbbread(), jbread(), and joinslices() functions and the data “ingredients.” If we do this saving each step if would look like this:</a></li>
<li class="chapter" data-level="3.13.2" data-path="Programming.html"><a href="Programming.html#if-we-nest-the-functions-together-we-get-this"><i class="fa fa-check"></i><b>3.13.2</b> If we nest the functions together we get this</a></li>
<li class="chapter" data-level="3.13.3" data-path="Programming.html"><a href="Programming.html#using-the-pipe-it-would-look-like-this"><i class="fa fa-check"></i><b>3.13.3</b> Using the pipe it would look like this</a></li>
<li class="chapter" data-level="3.13.4" data-path="Programming.html"><a href="Programming.html#when-you-use-the-pipe-it-basically-takes-whatever-came-out-of-the-first-function-and-puts-it-into-the-data-argument-for-the-next-one"><i class="fa fa-check"></i><b>3.13.4</b> When you use the pipe, it basically takes whatever came out of the first function and puts it into the data argument for the next one</a></li>
</ul></li>
<li class="chapter" data-level="3.14" data-path="Programming.html"><a href="Programming.html#save-your-results-to-a-new-tibble"><i class="fa fa-check"></i><b>3.14</b> Save your results to a new tibble</a></li>
<li class="chapter" data-level="3.15" data-path="Programming.html"><a href="Programming.html#what-about-nas"><i class="fa fa-check"></i><b>3.15</b> What about NAs?</a></li>
<li class="chapter" data-level="3.16" data-path="Programming.html"><a href="Programming.html#what-are-some-things-you-think-ill-ask-you-to-do-for-the-activity-next-class"><i class="fa fa-check"></i><b>3.16</b> What are some things you think I’ll ask you to do for the activity next class?</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introactivity.html"><a href="introactivity.html"><i class="fa fa-check"></i><b>4</b> ACTIVITY Intro Skills</a>
<ul>
<li class="chapter" data-level="4.1" data-path="introactivity.html"><a href="introactivity.html#problem-1"><i class="fa fa-check"></i><b>4.1</b> Problem 1</a></li>
<li class="chapter" data-level="4.2" data-path="introactivity.html"><a href="introactivity.html#problem-2"><i class="fa fa-check"></i><b>4.2</b> Problem 2</a></li>
<li class="chapter" data-level="4.3" data-path="introactivity.html"><a href="introactivity.html#problem-3"><i class="fa fa-check"></i><b>4.3</b> Problem 3</a></li>
<li class="chapter" data-level="4.4" data-path="introactivity.html"><a href="introactivity.html#problem-4"><i class="fa fa-check"></i><b>4.4</b> Problem 4</a></li>
<li class="chapter" data-level="4.5" data-path="introactivity.html"><a href="introactivity.html#problem-5"><i class="fa fa-check"></i><b>4.5</b> Problem 5</a></li>
<li class="chapter" data-level="4.6" data-path="introactivity.html"><a href="introactivity.html#problem-6"><i class="fa fa-check"></i><b>4.6</b> Problem 6</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="stats.html"><a href="stats.html"><i class="fa fa-check"></i><b>5</b> Introduction to Basic Statistics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="stats.html"><a href="stats.html#reading-for-this-section-statistical-methods-in-water-resources-chapter-1"><i class="fa fa-check"></i><b>5.1</b> Reading for this section: Statistical Methods in Water Resources: Chapter 1</a></li>
<li class="chapter" data-level="5.2" data-path="stats.html"><a href="stats.html#questions-for-today"><i class="fa fa-check"></i><b>5.2</b> Questions for today:</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="stats.html"><a href="stats.html#stack-plots-to-compare-histogram-and-pdf"><i class="fa fa-check"></i><b>5.2.1</b> Stack plots to compare histogram and pdf</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="stats.html"><a href="stats.html#what-is-the-difference-between-a-sample-and-a-population."><i class="fa fa-check"></i><b>5.3</b> What is the difference between a sample and a population.</a></li>
<li class="chapter" data-level="5.4" data-path="stats.html"><a href="stats.html#measuring-our-sample-distribution-central-tendency."><i class="fa fa-check"></i><b>5.4</b> Measuring our sample distribution: central tendency.</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="stats.html"><a href="stats.html#so-whats-a-weighted-average"><i class="fa fa-check"></i><b>5.4.1</b> So what’s a weighted average?</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="stats.html"><a href="stats.html#measures-of-variability"><i class="fa fa-check"></i><b>5.5</b> Measures of variability</a></li>
<li class="chapter" data-level="5.6" data-path="stats.html"><a href="stats.html#what-is-a-normal-distribution-and-how-can-we-determine-if-we-have-one"><i class="fa fa-check"></i><b>5.6</b> What is a normal distribution and how can we determine if we have one?</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="statsactivity.html"><a href="statsactivity.html"><i class="fa fa-check"></i><b>6</b> ACTIVITY Intro Stats</a>
<ul>
<li class="chapter" data-level="6.1" data-path="statsactivity.html"><a href="statsactivity.html#problem-1-1"><i class="fa fa-check"></i><b>6.1</b> Problem 1</a></li>
<li class="chapter" data-level="6.2" data-path="statsactivity.html"><a href="statsactivity.html#problem-2-1"><i class="fa fa-check"></i><b>6.2</b> Problem 2</a></li>
<li class="chapter" data-level="6.3" data-path="statsactivity.html"><a href="statsactivity.html#problem-3-1"><i class="fa fa-check"></i><b>6.3</b> Problem 3</a></li>
<li class="chapter" data-level="6.4" data-path="statsactivity.html"><a href="statsactivity.html#problem-4-1"><i class="fa fa-check"></i><b>6.4</b> Problem 4</a></li>
<li class="chapter" data-level="6.5" data-path="statsactivity.html"><a href="statsactivity.html#problem-5-1"><i class="fa fa-check"></i><b>6.5</b> Problem 5</a></li>
<li class="chapter" data-level="6.6" data-path="statsactivity.html"><a href="statsactivity.html#problem-6-1"><i class="fa fa-check"></i><b>6.6</b> Problem 6</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="getdata.html"><a href="getdata.html"><i class="fa fa-check"></i><b>7</b> Joins, Pivots, and USGS dataRetrieval</a>
<ul>
<li class="chapter" data-level="7.1" data-path="getdata.html"><a href="getdata.html#goals-for-today"><i class="fa fa-check"></i><b>7.1</b> Goals for today</a></li>
<li class="chapter" data-level="7.2" data-path="getdata.html"><a href="getdata.html#exploring-what-dataretrieval-can-do."><i class="fa fa-check"></i><b>7.2</b> Exploring what dataRetrieval can do.</a></li>
<li class="chapter" data-level="7.3" data-path="getdata.html"><a href="getdata.html#joins"><i class="fa fa-check"></i><b>7.3</b> Joins</a></li>
<li class="chapter" data-level="7.4" data-path="getdata.html"><a href="getdata.html#join-example"><i class="fa fa-check"></i><b>7.4</b> Join example</a></li>
<li class="chapter" data-level="7.5" data-path="getdata.html"><a href="getdata.html#finding-ids-to-download-usgs-data"><i class="fa fa-check"></i><b>7.5</b> Finding IDs to download USGS data</a></li>
<li class="chapter" data-level="7.6" data-path="getdata.html"><a href="getdata.html#ok-lets-download-some-data"><i class="fa fa-check"></i><b>7.6</b> OK let’s download some data!</a></li>
<li class="chapter" data-level="7.7" data-path="getdata.html"><a href="getdata.html#pivoting-wide-and-long-data"><i class="fa fa-check"></i><b>7.7</b> Pivoting: wide and long data</a></li>
<li class="chapter" data-level="7.8" data-path="getdata.html"><a href="getdata.html#pivot-examples"><i class="fa fa-check"></i><b>7.8</b> Pivot Examples</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="joinpivotDR.html"><a href="joinpivotDR.html"><i class="fa fa-check"></i><b>8</b> ACTIVITY Joins Pivots dataRetrieval</a>
<ul>
<li class="chapter" data-level="8.1" data-path="joinpivotDR.html"><a href="joinpivotDR.html#load-the-tidyverse-dataretrieval-and-patchwork-packages."><i class="fa fa-check"></i><b>8.1</b> Load the tidyverse, dataRetrieval, and patchwork packages.</a></li>
<li class="chapter" data-level="8.2" data-path="joinpivotDR.html"><a href="joinpivotDR.html#problem-1-2"><i class="fa fa-check"></i><b>8.2</b> Problem 1</a></li>
<li class="chapter" data-level="8.3" data-path="joinpivotDR.html"><a href="joinpivotDR.html#problem-2-2"><i class="fa fa-check"></i><b>8.3</b> Problem 2</a></li>
<li class="chapter" data-level="8.4" data-path="joinpivotDR.html"><a href="joinpivotDR.html#problem-3-2"><i class="fa fa-check"></i><b>8.4</b> Problem 3</a></li>
<li class="chapter" data-level="8.5" data-path="joinpivotDR.html"><a href="joinpivotDR.html#problem-4-2"><i class="fa fa-check"></i><b>8.5</b> Problem 4</a></li>
<li class="chapter" data-level="8.6" data-path="joinpivotDR.html"><a href="joinpivotDR.html#problem-5-2"><i class="fa fa-check"></i><b>8.6</b> Problem 5</a></li>
<li class="chapter" data-level="8.7" data-path="joinpivotDR.html"><a href="joinpivotDR.html#problem-6-2"><i class="fa fa-check"></i><b>8.7</b> Problem 6</a></li>
<li class="chapter" data-level="8.8" data-path="joinpivotDR.html"><a href="joinpivotDR.html#problem-7"><i class="fa fa-check"></i><b>8.8</b> Problem 7</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Summative1.html"><a href="Summative1.html"><i class="fa fa-check"></i><b>9</b> ACTIVITY Summative 1</a>
<ul>
<li class="chapter" data-level="9.0.1" data-path="Summative1.html"><a href="Summative1.html#instructions"><i class="fa fa-check"></i><b>9.0.1</b> Instructions</a></li>
<li class="chapter" data-level="9.1" data-path="Summative1.html"><a href="Summative1.html#problem-1-3"><i class="fa fa-check"></i><b>9.1</b> Problem 1</a></li>
<li class="chapter" data-level="9.2" data-path="Summative1.html"><a href="Summative1.html#problem-2-3"><i class="fa fa-check"></i><b>9.2</b> Problem 2</a></li>
<li class="chapter" data-level="9.3" data-path="Summative1.html"><a href="Summative1.html#problem-3-3"><i class="fa fa-check"></i><b>9.3</b> Problem 3</a></li>
<li class="chapter" data-level="9.4" data-path="Summative1.html"><a href="Summative1.html#problem-4-3"><i class="fa fa-check"></i><b>9.4</b> Problem 4</a></li>
<li class="chapter" data-level="9.5" data-path="Summative1.html"><a href="Summative1.html#problem-5-3"><i class="fa fa-check"></i><b>9.5</b> Problem 5</a></li>
<li class="chapter" data-level="9.6" data-path="Summative1.html"><a href="Summative1.html#problem-6-3"><i class="fa fa-check"></i><b>9.6</b> Problem 6</a></li>
<li class="chapter" data-level="9.7" data-path="Summative1.html"><a href="Summative1.html#problem-7-1"><i class="fa fa-check"></i><b>9.7</b> Problem 7</a></li>
<li class="chapter" data-level="9.8" data-path="Summative1.html"><a href="Summative1.html#problem-8"><i class="fa fa-check"></i><b>9.8</b> Problem 8</a></li>
<li class="chapter" data-level="9.9" data-path="Summative1.html"><a href="Summative1.html#problem-9"><i class="fa fa-check"></i><b>9.9</b> Problem 9</a></li>
<li class="chapter" data-level="9.10" data-path="Summative1.html"><a href="Summative1.html#problem-10"><i class="fa fa-check"></i><b>9.10</b> Problem 10</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="fdcs.html"><a href="fdcs.html"><i class="fa fa-check"></i><b>10</b> Flow Duration Curves</a>
<ul>
<li class="chapter" data-level="10.1" data-path="fdcs.html"><a href="fdcs.html#get-data"><i class="fa fa-check"></i><b>10.1</b> Get data</a></li>
<li class="chapter" data-level="10.2" data-path="fdcs.html"><a href="fdcs.html#review-describe-the-distribution"><i class="fa fa-check"></i><b>10.2</b> Review: describe the distribution</a></li>
<li class="chapter" data-level="10.3" data-path="fdcs.html"><a href="fdcs.html#ecdfs"><i class="fa fa-check"></i><b>10.3</b> ECDFs</a></li>
<li class="chapter" data-level="10.4" data-path="fdcs.html"><a href="fdcs.html#calculate-flow-exceedence-probabilities"><i class="fa fa-check"></i><b>10.4</b> Calculate flow exceedence probabilities</a></li>
<li class="chapter" data-level="10.5" data-path="fdcs.html"><a href="fdcs.html#plot-a-flow-duration-curve-using-the-probabilities"><i class="fa fa-check"></i><b>10.5</b> Plot a Flow Duration Curve using the probabilities</a></li>
<li class="chapter" data-level="10.6" data-path="fdcs.html"><a href="fdcs.html#make-an-almost-fdc-with-stat_ecdf"><i class="fa fa-check"></i><b>10.6</b> Make an almost FDC with stat_ecdf</a></li>
<li class="chapter" data-level="10.7" data-path="fdcs.html"><a href="fdcs.html#example-use-of-an-fdc"><i class="fa fa-check"></i><b>10.7</b> Example use of an FDC</a></li>
<li class="chapter" data-level="10.8" data-path="fdcs.html"><a href="fdcs.html#compare-to-a-boxplot-of-the-same-data"><i class="fa fa-check"></i><b>10.8</b> Compare to a boxplot of the same data</a></li>
<li class="chapter" data-level="10.9" data-path="fdcs.html"><a href="fdcs.html#challenge-examining-flow-regime-change-at-the-grand-canyon"><i class="fa fa-check"></i><b>10.9</b> Challenge: Examining flow regime change at the Grand Canyon</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="lfas.html"><a href="lfas.html"><i class="fa fa-check"></i><b>11</b> Low Flow Analysis</a>
<ul>
<li class="chapter" data-level="11.1" data-path="lfas.html"><a href="lfas.html#what-are-low-flow-statistics"><i class="fa fa-check"></i><b>11.1</b> What are low flow statistics?</a></li>
<li class="chapter" data-level="11.2" data-path="lfas.html"><a href="lfas.html#get-data-1"><i class="fa fa-check"></i><b>11.2</b> Get data</a></li>
<li class="chapter" data-level="11.3" data-path="lfas.html"><a href="lfas.html#create-the-x-days-average-flow-record"><i class="fa fa-check"></i><b>11.3</b> Create the X days average flow record</a></li>
<li class="chapter" data-level="11.4" data-path="lfas.html"><a href="lfas.html#look-at-what-a-rolling-mean-does."><i class="fa fa-check"></i><b>11.4</b> Look at what a rolling mean does.</a></li>
<li class="chapter" data-level="11.5" data-path="lfas.html"><a href="lfas.html#calculate-yearly-minimums"><i class="fa fa-check"></i><b>11.5</b> Calculate yearly minimums</a></li>
<li class="chapter" data-level="11.6" data-path="lfas.html"><a href="lfas.html#calculate-return-interval"><i class="fa fa-check"></i><b>11.6</b> Calculate return interval</a></li>
<li class="chapter" data-level="11.7" data-path="lfas.html"><a href="lfas.html#fit-to-pearson-type-iii-distribution"><i class="fa fa-check"></i><b>11.7</b> Fit to Pearson Type III distribution</a></li>
<li class="chapter" data-level="11.8" data-path="lfas.html"><a href="lfas.html#distribution-free-method"><i class="fa fa-check"></i><b>11.8</b> Distribution-free method</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="floods.html"><a href="floods.html"><i class="fa fa-check"></i><b>12</b> Flood Frequency Analysis and Creating Functions</a>
<ul>
<li class="chapter" data-level="12.1" data-path="floods.html"><a href="floods.html#template-repository"><i class="fa fa-check"></i><b>12.1</b> Template Repository</a></li>
<li class="chapter" data-level="12.2" data-path="floods.html"><a href="floods.html#introduction-2"><i class="fa fa-check"></i><b>12.2</b> Introduction</a></li>
<li class="chapter" data-level="12.3" data-path="floods.html"><a href="floods.html#download-and-plot-peak-flow-data"><i class="fa fa-check"></i><b>12.3</b> Download and plot peak flow data</a></li>
<li class="chapter" data-level="12.4" data-path="floods.html"><a href="floods.html#compute-ranks-for-peak-flows"><i class="fa fa-check"></i><b>12.4</b> Compute ranks for peak flows</a></li>
<li class="chapter" data-level="12.5" data-path="floods.html"><a href="floods.html#calculate-exceedance-probability-and-return-period"><i class="fa fa-check"></i><b>12.5</b> Calculate exceedance probability and return period</a></li>
<li class="chapter" data-level="12.6" data-path="floods.html"><a href="floods.html#calculate-gumbel-distribution-parameters"><i class="fa fa-check"></i><b>12.6</b> Calculate Gumbel distribution parameters</a></li>
<li class="chapter" data-level="12.7" data-path="floods.html"><a href="floods.html#calculate-return-interval-for-peak-flows-according-to-gumbel-distribution"><i class="fa fa-check"></i><b>12.7</b> Calculate return interval for peak flows according to Gumbel distribution</a></li>
<li class="chapter" data-level="12.8" data-path="floods.html"><a href="floods.html#plot-gumbel-distribution-fit-with-peak-flow-data"><i class="fa fa-check"></i><b>12.8</b> Plot Gumbel distribution fit with peak flow data</a></li>
<li class="chapter" data-level="12.9" data-path="floods.html"><a href="floods.html#calculate-magnitude-of-1-in-100-chance-flood"><i class="fa fa-check"></i><b>12.9</b> Calculate magnitude of 1 in 100 chance flood</a></li>
<li class="chapter" data-level="12.10" data-path="floods.html"><a href="floods.html#how-to-create-your-own-functions"><i class="fa fa-check"></i><b>12.10</b> How to create your own functions</a></li>
<li class="chapter" data-level="12.11" data-path="floods.html"><a href="floods.html#create-a-return-period-function"><i class="fa fa-check"></i><b>12.11</b> Create a return period function</a></li>
<li class="chapter" data-level="12.12" data-path="floods.html"><a href="floods.html#challenge-create-a-function-to-compute-the-1-in-100-chance-flood-for-any-usgs-gage"><i class="fa fa-check"></i><b>12.12</b> Challenge: Create a function to compute the 1 in 100 chance flood for any USGS gage</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="rgeospatial.html"><a href="rgeospatial.html"><i class="fa fa-check"></i><b>13</b> Geospatial data in R - Vector</a>
<ul>
<li class="chapter" data-level="13.1" data-path="rgeospatial.html"><a href="rgeospatial.html#goals"><i class="fa fa-check"></i><b>13.1</b> Goals</a></li>
<li class="chapter" data-level="13.2" data-path="rgeospatial.html"><a href="rgeospatial.html#intro-to-tmap"><i class="fa fa-check"></i><b>13.2</b> Intro to tmap</a></li>
<li class="chapter" data-level="13.3" data-path="rgeospatial.html"><a href="rgeospatial.html#data-wrangling-with-tidyverse-principles"><i class="fa fa-check"></i><b>13.3</b> Data wrangling with tidyverse principles</a></li>
<li class="chapter" data-level="13.4" data-path="rgeospatial.html"><a href="rgeospatial.html#add-non-spatial-data-to-spatial-data-with-a-join"><i class="fa fa-check"></i><b>13.4</b> Add non-spatial data to spatial data with a join</a></li>
<li class="chapter" data-level="13.5" data-path="rgeospatial.html"><a href="rgeospatial.html#plot-maps-side-by-side"><i class="fa fa-check"></i><b>13.5</b> Plot maps side by side</a></li>
<li class="chapter" data-level="13.6" data-path="rgeospatial.html"><a href="rgeospatial.html#built-in-styles-like-themes-in-ggplot"><i class="fa fa-check"></i><b>13.6</b> Built in styles, like themes in ggplot</a></li>
<li class="chapter" data-level="13.7" data-path="rgeospatial.html"><a href="rgeospatial.html#interactive-maps"><i class="fa fa-check"></i><b>13.7</b> Interactive Maps</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="rgeospatial.html"><a href="rgeospatial.html#tmap"><i class="fa fa-check"></i><b>13.7.1</b> tmap</a></li>
<li class="chapter" data-level="13.7.2" data-path="rgeospatial.html"><a href="rgeospatial.html#leaflet"><i class="fa fa-check"></i><b>13.7.2</b> Leaflet</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="summative2.html"><a href="summative2.html"><i class="fa fa-check"></i><b>14</b> Summative Assessment 2</a>
<ul>
<li class="chapter" data-level="14.1" data-path="summative2.html"><a href="summative2.html#info-for-assessment"><i class="fa fa-check"></i><b>14.1</b> Info for assessment</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="rgeoraster.html"><a href="rgeoraster.html"><i class="fa fa-check"></i><b>15</b> Geospatial R Raster - Hydro Analyses</a>
<ul>
<li class="chapter" data-level="15.1" data-path="rgeoraster.html"><a href="rgeoraster.html#introduction-3"><i class="fa fa-check"></i><b>15.1</b> Introduction</a></li>
<li class="chapter" data-level="15.2" data-path="rgeoraster.html"><a href="rgeoraster.html#read-in-dem"><i class="fa fa-check"></i><b>15.2</b> Read in DEM</a></li>
<li class="chapter" data-level="15.3" data-path="rgeoraster.html"><a href="rgeoraster.html#plot-dem"><i class="fa fa-check"></i><b>15.3</b> Plot DEM</a></li>
<li class="chapter" data-level="15.4" data-path="rgeoraster.html"><a href="rgeoraster.html#generate-a-hillshade"><i class="fa fa-check"></i><b>15.4</b> Generate a hillshade</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="rgeoraster.html"><a href="rgeoraster.html#how-whitebox-tools-functions-work"><i class="fa fa-check"></i><b>15.4.1</b> How whitebox tools functions work</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="rgeoraster.html"><a href="rgeoraster.html#prepare-dem-for-hydrology-analyses"><i class="fa fa-check"></i><b>15.5</b> Prepare DEM for Hydrology Analyses</a></li>
<li class="chapter" data-level="15.6" data-path="rgeoraster.html"><a href="rgeoraster.html#visualize-filled-sinks-and-breached-depressions"><i class="fa fa-check"></i><b>15.6</b> Visualize filled sinks and breached depressions</a></li>
<li class="chapter" data-level="15.7" data-path="rgeoraster.html"><a href="rgeoraster.html#d8-flow-accumulation"><i class="fa fa-check"></i><b>15.7</b> D8 Flow Accumulation</a></li>
<li class="chapter" data-level="15.8" data-path="rgeoraster.html"><a href="rgeoraster.html#d-infinity-flow-accumulation"><i class="fa fa-check"></i><b>15.8</b> D infinity flow accumulation</a></li>
<li class="chapter" data-level="15.9" data-path="rgeoraster.html"><a href="rgeoraster.html#topographic-wetness-index"><i class="fa fa-check"></i><b>15.9</b> Topographic Wetness Index</a></li>
<li class="chapter" data-level="15.10" data-path="rgeoraster.html"><a href="rgeoraster.html#downslope-twi"><i class="fa fa-check"></i><b>15.10</b> Downslope TWI</a></li>
<li class="chapter" data-level="15.11" data-path="rgeoraster.html"><a href="rgeoraster.html#map-stream-network"><i class="fa fa-check"></i><b>15.11</b> Map Stream Network</a></li>
<li class="chapter" data-level="15.12" data-path="rgeoraster.html"><a href="rgeoraster.html#extract-raster-values-to-point-locations"><i class="fa fa-check"></i><b>15.12</b> Extract raster values to point locations</a>
<ul>
<li class="chapter" data-level="15.12.1" data-path="rgeoraster.html"><a href="rgeoraster.html#import-and-plot-points"><i class="fa fa-check"></i><b>15.12.1</b> Import and plot points</a></li>
<li class="chapter" data-level="15.12.2" data-path="rgeoraster.html"><a href="rgeoraster.html#extract-values-from-multiple-rasters-at-once"><i class="fa fa-check"></i><b>15.12.2</b> Extract values from multiple rasters at once</a></li>
</ul></li>
<li class="chapter" data-level="15.13" data-path="rgeoraster.html"><a href="rgeoraster.html#view-raster-data-as-a-pdf-or-histogram"><i class="fa fa-check"></i><b>15.13</b> View raster data as a PDF or histogram</a></li>
<li class="chapter" data-level="15.14" data-path="rgeoraster.html"><a href="rgeoraster.html#subsetting-a-raster-for-visualization"><i class="fa fa-check"></i><b>15.14</b> Subsetting a raster for visualization</a></li>
<li class="chapter" data-level="15.15" data-path="rgeoraster.html"><a href="rgeoraster.html#raster-math"><i class="fa fa-check"></i><b>15.15</b> Raster Math</a></li>
<li class="chapter" data-level="15.16" data-path="rgeoraster.html"><a href="rgeoraster.html#extra-plot-topo-characteristics-against-one-another"><i class="fa fa-check"></i><b>15.16</b> Extra: plot topo characteristics against one another</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html"><i class="fa fa-check"></i><b>16</b> Geospatial R Raster - Watershed Delineation</a>
<ul>
<li class="chapter" data-level="16.1" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#introduction-4"><i class="fa fa-check"></i><b>16.1</b> Introduction</a></li>
<li class="chapter" data-level="16.2" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#the-watershed-delineation-toolprocess"><i class="fa fa-check"></i><b>16.2</b> The watershed delineation tool/process</a></li>
<li class="chapter" data-level="16.3" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#read-in-dem-1"><i class="fa fa-check"></i><b>16.3</b> Read in DEM</a></li>
<li class="chapter" data-level="16.4" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#generate-a-hillshade-1"><i class="fa fa-check"></i><b>16.4</b> Generate a hillshade</a></li>
<li class="chapter" data-level="16.5" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#prepare-dem-for-hydrology-analyses-1"><i class="fa fa-check"></i><b>16.5</b> Prepare DEM for Hydrology Analyses</a></li>
<li class="chapter" data-level="16.6" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#create-flow-accumulation-and-pointer-grids"><i class="fa fa-check"></i><b>16.6</b> Create flow accumulation and pointer grids</a></li>
<li class="chapter" data-level="16.7" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#setting-pour-points"><i class="fa fa-check"></i><b>16.7</b> Setting pour points</a></li>
<li class="chapter" data-level="16.8" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#delineate-watersheds"><i class="fa fa-check"></i><b>16.8</b> Delineate watersheds</a></li>
<li class="chapter" data-level="16.9" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#convert-watersheds-to-shapefiles"><i class="fa fa-check"></i><b>16.9</b> Convert watersheds to shapefiles</a></li>
<li class="chapter" data-level="16.10" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#extract-data-based-on-watershed-outline"><i class="fa fa-check"></i><b>16.10</b> Extract data based on watershed outline</a></li>
<li class="chapter" data-level="16.11" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#bonus-make-a-3d-map-of-your-watershed-with-rayshader"><i class="fa fa-check"></i><b>16.11</b> BONUS: Make a 3d map of your watershed with rayshader</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="modelingintro.html"><a href="modelingintro.html"><i class="fa fa-check"></i><b>17</b> Intro to Modeling - Getting Started with HBV</a>
<ul>
<li class="chapter" data-level="17.1" data-path="modelingintro.html"><a href="modelingintro.html#introduction-5"><i class="fa fa-check"></i><b>17.1</b> Introduction</a></li>
<li class="chapter" data-level="17.2" data-path="modelingintro.html"><a href="modelingintro.html#creating-the-hbv-model-function"><i class="fa fa-check"></i><b>17.2</b> Creating the HBV model function</a></li>
<li class="chapter" data-level="17.3" data-path="modelingintro.html"><a href="modelingintro.html#read-in-precip-and-temp"><i class="fa fa-check"></i><b>17.3</b> Read in Precip and Temp</a></li>
<li class="chapter" data-level="17.4" data-path="modelingintro.html"><a href="modelingintro.html#calculate-pet"><i class="fa fa-check"></i><b>17.4</b> Calculate PET</a></li>
<li class="chapter" data-level="17.5" data-path="modelingintro.html"><a href="modelingintro.html#hbv-parameters"><i class="fa fa-check"></i><b>17.5</b> HBV Parameters</a></li>
<li class="chapter" data-level="17.6" data-path="modelingintro.html"><a href="modelingintro.html#first-model-run"><i class="fa fa-check"></i><b>17.6</b> First model run</a></li>
<li class="chapter" data-level="17.7" data-path="modelingintro.html"><a href="modelingintro.html#import-observed-streamflow-data"><i class="fa fa-check"></i><b>17.7</b> Import observed streamflow data</a></li>
<li class="chapter" data-level="17.8" data-path="modelingintro.html"><a href="modelingintro.html#compare-observed-and-modeled-discharge-graphically"><i class="fa fa-check"></i><b>17.8</b> Compare observed and modeled discharge graphically</a></li>
<li class="chapter" data-level="17.9" data-path="modelingintro.html"><a href="modelingintro.html#compare-observed-and-modelled-discharge-with-interactive-graph"><i class="fa fa-check"></i><b>17.9</b> Compare observed and modelled discharge with interactive graph</a></li>
<li class="chapter" data-level="17.10" data-path="modelingintro.html"><a href="modelingintro.html#measure-how-well-the-model-fits-with-nse"><i class="fa fa-check"></i><b>17.10</b> Measure how well the model fits with NSE</a></li>
<li class="chapter" data-level="17.11" data-path="modelingintro.html"><a href="modelingintro.html#assess-model-fit-with-a-different-measure-snow"><i class="fa fa-check"></i><b>17.11</b> Assess model fit with a different measure: Snow</a></li>
<li class="chapter" data-level="17.12" data-path="modelingintro.html"><a href="modelingintro.html#calibrate-hbv-manually"><i class="fa fa-check"></i><b>17.12</b> Calibrate HBV manually</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="modelingcalibration.html"><a href="modelingcalibration.html"><i class="fa fa-check"></i><b>18</b> Intro to Modeling - Calibrate HBV</a>
<ul>
<li class="chapter" data-level="18.1" data-path="modelingcalibration.html"><a href="modelingcalibration.html#introduction-6"><i class="fa fa-check"></i><b>18.1</b> Introduction</a></li>
<li class="chapter" data-level="18.2" data-path="modelingcalibration.html"><a href="modelingcalibration.html#prep-data"><i class="fa fa-check"></i><b>18.2</b> Prep data</a></li>
<li class="chapter" data-level="18.3" data-path="modelingcalibration.html"><a href="modelingcalibration.html#calculate-pet-1"><i class="fa fa-check"></i><b>18.3</b> Calculate PET</a></li>
<li class="chapter" data-level="18.4" data-path="modelingcalibration.html"><a href="modelingcalibration.html#hbv-parameters-1"><i class="fa fa-check"></i><b>18.4</b> HBV Parameters</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Hydroinformatics at VT</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelingcalibration" class="section level1" number="18">
<h1><span class="header-section-number">Chapter 18</span> Intro to Modeling - Calibrate HBV</h1>
<div id="introduction-6" class="section level2" number="18.1">
<h2><span class="header-section-number">18.1</span> Introduction</h2>
<p>The following activity is available as a template github repository at the following link:</p>
<p><em>Goals for this activity:</em></p>
<ul>
<li>Learn how for loops work</li>
<li>Use for loops to run calibrate the HBV model using the Monte Carlo technique</li>
<li>Assess the results of the calibration, discuss equifinality</li>
</ul>
<p>We saw in the last activity that coming up with the parameters that create a model that fits our watershed discharge best is hard. For this reason, there are several ways people have devised for automating this process. We are going to explore one: a Monte Carlo calibration.</p>
<p>To use this approach, we will create a ton of random parameter sets, run the model for each, and then see which one fits best. The idea is that by creating a bunch of random sets of parameters, we will end up with at least one that works well. As you might guess, this can take a while. We will just do this for 100 or 1000 runs here in this activity, but we will also explore some output from a 100,000 run Monte Carlo that I ran and saved.</p>
<p>There is one new package this time, just for creating a parallel coordinate plot to look at the results of the 100k run Monte Carlo at the end.</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="modelingcalibration.html#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb319-2"><a href="modelingcalibration.html#cb319-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb319-3"><a href="modelingcalibration.html#cb319-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb319-4"><a href="modelingcalibration.html#cb319-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb319-5"><a href="modelingcalibration.html#cb319-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally) <span class="co">#for making parallel coordinate plot</span></span>
<span id="cb319-6"><a href="modelingcalibration.html#cb319-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb319-7"><a href="modelingcalibration.html#cb319-7" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>())</span></code></pre></div>
<p>In order to do what we are going to do, we need for loops</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="modelingcalibration.html#cb320-1" aria-hidden="true" tabindex="-1"></a>val <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb320-2"><a href="modelingcalibration.html#cb320-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-3"><a href="modelingcalibration.html#cb320-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(x <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb320-4"><a href="modelingcalibration.html#cb320-4" aria-hidden="true" tabindex="-1"></a>  val[x] <span class="ot">&lt;-</span> x</span>
<span id="cb320-5"><a href="modelingcalibration.html#cb320-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb320-6"><a href="modelingcalibration.html#cb320-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-7"><a href="modelingcalibration.html#cb320-7" aria-hidden="true" tabindex="-1"></a>val</span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="modelingcalibration.html#cb322-1" aria-hidden="true" tabindex="-1"></a>days <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;mon&quot;</span>,<span class="st">&quot;tues&quot;</span>,<span class="st">&quot;wednes&quot;</span>)</span>
<span id="cb322-2"><a href="modelingcalibration.html#cb322-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-3"><a href="modelingcalibration.html#cb322-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(x <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(days)){</span>
<span id="cb322-4"><a href="modelingcalibration.html#cb322-4" aria-hidden="true" tabindex="-1"></a>  days[x] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(days[x], <span class="st">&quot;day&quot;</span>)</span>
<span id="cb322-5"><a href="modelingcalibration.html#cb322-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb322-6"><a href="modelingcalibration.html#cb322-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-7"><a href="modelingcalibration.html#cb322-7" aria-hidden="true" tabindex="-1"></a>days</span></code></pre></div>
<pre><code>## [1] &quot;monday&quot;    &quot;tuesday&quot;   &quot;wednesday&quot;</code></pre>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="modelingcalibration.html#cb324-1" aria-hidden="true" tabindex="-1"></a>gages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;123&quot;</span>,<span class="st">&quot;ABC&quot;</span>,<span class="st">&quot;001&quot;</span>)</span>
<span id="cb324-2"><a href="modelingcalibration.html#cb324-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-3"><a href="modelingcalibration.html#cb324-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(g <span class="cf">in</span> gages){</span>
<span id="cb324-4"><a href="modelingcalibration.html#cb324-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(g)</span>
<span id="cb324-5"><a href="modelingcalibration.html#cb324-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;123&quot;
## [1] &quot;ABC&quot;
## [1] &quot;001&quot;</code></pre>
</div>
<div id="prep-data" class="section level2" number="18.2">
<h2><span class="header-section-number">18.2</span> Prep data</h2>
<p>Import data
Make P, Qobs, Temp as vectors</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="modelingcalibration.html#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Precip</span></span>
<span id="cb326-2"><a href="modelingcalibration.html#cb326-2" aria-hidden="true" tabindex="-1"></a>P1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;HBV/Pwd2009-2012.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb326-3"><a href="modelingcalibration.html#cb326-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">select</span>(DATE, WS_3) <span class="sc">%&gt;%</span></span>
<span id="cb326-4"><a href="modelingcalibration.html#cb326-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">DATE =</span> <span class="fu">ymd</span>(DATE)) <span class="sc">%&gt;%</span></span>
<span id="cb326-5"><a href="modelingcalibration.html#cb326-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">filter</span>(DATE <span class="sc">&gt;=</span> start <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end)</span></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   DATE = col_character(),
##   WS_1 = col_double(),
##   WS_2 = col_double(),
##   WS_3 = col_double(),
##   WS_4 = col_double(),
##   WS_5 = col_double(),
##   WS_6 = col_double(),
##   WS_7 = col_double(),
##   WS_8 = col_double(),
##   WS_9 = col_double()
## )</code></pre>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="modelingcalibration.html#cb328-1" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> P1<span class="sc">$</span>WS_3</span>
<span id="cb328-2"><a href="modelingcalibration.html#cb328-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-3"><a href="modelingcalibration.html#cb328-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Streamflow mm/d</span></span>
<span id="cb328-4"><a href="modelingcalibration.html#cb328-4" aria-hidden="true" tabindex="-1"></a>Qobs1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;HBV/SWD2009-2012.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb328-5"><a href="modelingcalibration.html#cb328-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">select</span>(DATE, WS_3) <span class="sc">%&gt;%</span></span>
<span id="cb328-6"><a href="modelingcalibration.html#cb328-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">DATE =</span> <span class="fu">ymd</span>(DATE)) <span class="sc">%&gt;%</span></span>
<span id="cb328-7"><a href="modelingcalibration.html#cb328-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">filter</span>(DATE <span class="sc">&gt;=</span> start <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end)</span></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   DATE = col_character(),
##   WS_1 = col_double(),
##   WS_2 = col_double(),
##   WS_3 = col_double(),
##   WS_4 = col_double(),
##   WS_5 = col_double(),
##   WS_6 = col_double(),
##   WS_7 = col_double(),
##   WS_8 = col_double(),
##   WS_9 = col_double()
## )</code></pre>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="modelingcalibration.html#cb330-1" aria-hidden="true" tabindex="-1"></a>Qobs <span class="ot">&lt;-</span> Qobs1<span class="sc">$</span>WS_3</span>
<span id="cb330-2"><a href="modelingcalibration.html#cb330-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb330-3"><a href="modelingcalibration.html#cb330-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Temp in deg C</span></span>
<span id="cb330-4"><a href="modelingcalibration.html#cb330-4" aria-hidden="true" tabindex="-1"></a>Temp1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;HBV/Tdm2009-2012.csv&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb330-5"><a href="modelingcalibration.html#cb330-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">select</span>(DATE, STA_1) <span class="sc">%&gt;%</span></span>
<span id="cb330-6"><a href="modelingcalibration.html#cb330-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">DATE =</span> <span class="fu">ymd</span>(DATE)) <span class="sc">%&gt;%</span></span>
<span id="cb330-7"><a href="modelingcalibration.html#cb330-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">filter</span>(DATE <span class="sc">&gt;=</span> start <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end)</span></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   DATE = col_character(),
##   STA_1 = col_double(),
##   STA_6 = col_double(),
##   STA_14 = col_double(),
##   STA_INT = col_double(),
##   STA_HQ = col_double(),
##   STA_23 = col_double(),
##   STA_17 = col_double(),
##   STA_24 = col_double()
## )</code></pre>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="modelingcalibration.html#cb332-1" aria-hidden="true" tabindex="-1"></a>Temp <span class="ot">&lt;-</span> Temp1<span class="sc">$</span>STA_1</span>
<span id="cb332-2"><a href="modelingcalibration.html#cb332-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-3"><a href="modelingcalibration.html#cb332-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Snow in SWE, mm</span></span>
<span id="cb332-4"><a href="modelingcalibration.html#cb332-4" aria-hidden="true" tabindex="-1"></a>snow <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;HBV/sno2009-2012.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb332-5"><a href="modelingcalibration.html#cb332-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">select</span>(DATE, STA2) <span class="sc">%&gt;%</span></span>
<span id="cb332-6"><a href="modelingcalibration.html#cb332-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">DATE =</span> <span class="fu">ymd</span>(DATE)) <span class="sc">%&gt;%</span></span>
<span id="cb332-7"><a href="modelingcalibration.html#cb332-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">filter</span>(DATE <span class="sc">&gt;=</span> start <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end)</span></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   .default = col_double(),
##   DATE = col_character()
## )
## ℹ Use `spec()` for the full column specifications.</code></pre>
<pre><code>## Warning: 76 parsing failures.
## row col   expected     actual                   file
##   1  -- 22 columns 25 columns &#39;HBV/sno2009-2012.csv&#39;
##   2  -- 22 columns 25 columns &#39;HBV/sno2009-2012.csv&#39;
##   3  -- 22 columns 25 columns &#39;HBV/sno2009-2012.csv&#39;
##   4  -- 22 columns 25 columns &#39;HBV/sno2009-2012.csv&#39;
##   5  -- 22 columns 25 columns &#39;HBV/sno2009-2012.csv&#39;
## ... ... .......... .......... ......................
## See problems(...) for more details.</code></pre>
<pre><code>## Warning: 8 failed to parse.</code></pre>
</div>
<div id="calculate-pet-1" class="section level2" number="18.3">
<h2><span class="header-section-number">18.3</span> Calculate PET</h2>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="modelingcalibration.html#cb336-1" aria-hidden="true" tabindex="-1"></a>lat <span class="ot">&lt;-</span> <span class="dv">43</span> <span class="sc">+</span> <span class="dv">57</span><span class="sc">/</span><span class="dv">60</span> <span class="co">#43 degrees and 57 minutes</span></span>
<span id="cb336-2"><a href="modelingcalibration.html#cb336-2" aria-hidden="true" tabindex="-1"></a>latrad <span class="ot">&lt;-</span> (lat<span class="sc">/</span><span class="dv">360</span>) <span class="sc">*</span> <span class="dv">2</span> <span class="sc">*</span> pi <span class="co">#convert to radians</span></span>
<span id="cb336-3"><a href="modelingcalibration.html#cb336-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb336-4"><a href="modelingcalibration.html#cb336-4" aria-hidden="true" tabindex="-1"></a>PET1 <span class="ot">&lt;-</span> <span class="fu">select</span>(Temp1, DATE) <span class="sc">%&gt;%</span></span>
<span id="cb336-5"><a href="modelingcalibration.html#cb336-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">DOY =</span> <span class="fu">yday</span>(DATE)) <span class="sc">%&gt;%</span> <span class="co">#DOY for dates</span></span>
<span id="cb336-6"><a href="modelingcalibration.html#cb336-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">tempvar =</span> (<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">365</span>) <span class="sc">*</span> DOY) <span class="sc">%&gt;%</span></span>
<span id="cb336-7"><a href="modelingcalibration.html#cb336-7" aria-hidden="true" tabindex="-1"></a>         <span class="co">#declination of the sun above the celestial equator in </span></span>
<span id="cb336-8"><a href="modelingcalibration.html#cb336-8" aria-hidden="true" tabindex="-1"></a>         <span class="co">#radians on day JulDay of the year</span></span>
<span id="cb336-9"><a href="modelingcalibration.html#cb336-9" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">delta_h =</span> <span class="fl">0.4093</span> <span class="sc">*</span> <span class="fu">sin</span>(tempvar <span class="sc">-</span> <span class="fl">1.405</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb336-10"><a href="modelingcalibration.html#cb336-10" aria-hidden="true" tabindex="-1"></a>         <span class="co">#day length in h</span></span>
<span id="cb336-11"><a href="modelingcalibration.html#cb336-11" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">daylen =</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">acos</span>(<span class="sc">-</span><span class="fu">tan</span>(delta_h) <span class="sc">*</span> <span class="fu">tan</span>(latrad)) <span class="sc">/</span> <span class="fl">0.2618</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb336-12"><a href="modelingcalibration.html#cb336-12" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(</span>
<span id="cb336-13"><a href="modelingcalibration.html#cb336-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">PET =</span> <span class="fl">29.8</span> <span class="sc">*</span> daylen <span class="sc">*</span> <span class="fl">0.611</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">17.3</span> <span class="sc">*</span> Temp <span class="sc">/</span> </span>
<span id="cb336-14"><a href="modelingcalibration.html#cb336-14" aria-hidden="true" tabindex="-1"></a>                  (Temp <span class="sc">+</span> <span class="fl">237.3</span>)) <span class="sc">/</span> (Temp <span class="sc">+</span> <span class="fl">273.2</span>))  <span class="co">#PET Hamon method</span></span>
<span id="cb336-15"><a href="modelingcalibration.html#cb336-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb336-16"><a href="modelingcalibration.html#cb336-16" aria-hidden="true" tabindex="-1"></a>PET <span class="ot">&lt;-</span> PET1<span class="sc">$</span>PET</span></code></pre></div>
</div>
<div id="hbv-parameters-1" class="section level2" number="18.4">
<h2><span class="header-section-number">18.4</span> HBV Parameters</h2>
<p>The table below shows the parameters of the HBV model, the minimum and maximum for those values, and a description of their function in the model.</p>
<table>
<colgroup>
<col width="32%" />
<col width="17%" />
<col width="14%" />
<col width="35%" />
</colgroup>
<thead>
<tr class="header">
<th>Object Name</th>
<th>Min</th>
<th>Max</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>FC</td>
<td>40</td>
<td>400</td>
<td>Max soil moisture storage, field capacity</td>
</tr>
<tr class="even">
<td>beta</td>
<td>1</td>
<td>6</td>
<td>Shape coefficient governing fate of water input to soil moisture storage</td>
</tr>
<tr class="odd">
<td>LP</td>
<td>.3</td>
<td>1</td>
<td>Threshold for reduction of evaporation</td>
</tr>
<tr class="even">
<td>SFCF</td>
<td>0.4</td>
<td>1.2</td>
<td>Snowfall correction factor</td>
</tr>
<tr class="odd">
<td>TT</td>
<td>-1.5</td>
<td>1.2</td>
<td>Threshold temperature</td>
</tr>
<tr class="even">
<td>CFMAX</td>
<td>1</td>
<td>8</td>
<td>Degree-day factor</td>
</tr>
<tr class="odd">
<td>k0</td>
<td>0.05</td>
<td>0.5</td>
<td>Recession constant (upper storage, near surface)</td>
</tr>
<tr class="even">
<td>k1</td>
<td>0.01</td>
<td>0.3</td>
<td>Recession constant (upper storage)</td>
</tr>
<tr class="odd">
<td>k2</td>
<td>0.001</td>
<td>0.15</td>
<td>Recession constant (lower storage)</td>
</tr>
<tr class="even">
<td>UZL</td>
<td>0</td>
<td>70</td>
<td>Threshold for shallow storage</td>
</tr>
<tr class="odd">
<td>PERC</td>
<td>0</td>
<td>4</td>
<td>Percolation, max flow from upper to lower storage</td>
</tr>
<tr class="even">
<td>MAXBAS</td>
<td>1</td>
<td>3</td>
<td>base of the triangular routing function, days"</td>
</tr>
</tbody>
</table>
<p>To pass a set of parameters to the model, we just put them into a single vector in the order they are in the table above. In the chunk below, I’ve structured this to make it easy to see a description of each parameter, but you could also just do it in one line without all the comments. Just be sure to get the order right!</p>
<p>The code below sets the routing to 0, which is what we want for a small catchment.</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="modelingcalibration.html#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="co">#number of runs</span></span>
<span id="cb337-2"><a href="modelingcalibration.html#cb337-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb337-3"><a href="modelingcalibration.html#cb337-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-4"><a href="modelingcalibration.html#cb337-4" aria-hidden="true" tabindex="-1"></a><span class="co"># PARAMETERS RANGE and generate set</span></span>
<span id="cb337-5"><a href="modelingcalibration.html#cb337-5" aria-hidden="true" tabindex="-1"></a>FC    <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="dv">40</span>   , <span class="at">max =</span> <span class="dv">400</span>)  <span class="co">#Max soil moisture storage, field capacity</span></span>
<span id="cb337-6"><a href="modelingcalibration.html#cb337-6" aria-hidden="true" tabindex="-1"></a>beta  <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="dv">1</span>    , <span class="at">max =</span> <span class="dv">6</span>)    <span class="co">#Shape coefficient governing fate of water input to soil moisture storage</span></span>
<span id="cb337-7"><a href="modelingcalibration.html#cb337-7" aria-hidden="true" tabindex="-1"></a>LP    <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="fl">0.3</span>   , <span class="at">max =</span> <span class="dv">1</span>)    <span class="co">#Threshold for reduction of evap</span></span>
<span id="cb337-8"><a href="modelingcalibration.html#cb337-8" aria-hidden="true" tabindex="-1"></a>SFCF  <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="fl">0.4</span>  , <span class="at">max =</span> <span class="fl">1.2</span>)  <span class="co">#Snowfall correction factor</span></span>
<span id="cb337-9"><a href="modelingcalibration.html#cb337-9" aria-hidden="true" tabindex="-1"></a>TT    <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="sc">-</span><span class="fl">1.5</span> , <span class="at">max =</span> <span class="fl">1.2</span>)  <span class="co">#Threshold temperature</span></span>
<span id="cb337-10"><a href="modelingcalibration.html#cb337-10" aria-hidden="true" tabindex="-1"></a>CFMAX <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="dv">1</span>    , <span class="at">max =</span> <span class="dv">8</span>)    <span class="co">#Degree-day factor</span></span>
<span id="cb337-11"><a href="modelingcalibration.html#cb337-11" aria-hidden="true" tabindex="-1"></a>k0    <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="fl">0.05</span> , <span class="at">max =</span> <span class="fl">0.5</span>)  <span class="co">#Recession constant (upper storage, near surface)</span></span>
<span id="cb337-12"><a href="modelingcalibration.html#cb337-12" aria-hidden="true" tabindex="-1"></a>k1    <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="fl">0.01</span> , <span class="at">max =</span> <span class="fl">0.3</span>)  <span class="co">#Recession constant (upper storage)</span></span>
<span id="cb337-13"><a href="modelingcalibration.html#cb337-13" aria-hidden="true" tabindex="-1"></a>k2    <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="fl">0.001</span>, <span class="at">max =</span> <span class="fl">0.15</span>) <span class="co">#Recession constant (lower storage)</span></span>
<span id="cb337-14"><a href="modelingcalibration.html#cb337-14" aria-hidden="true" tabindex="-1"></a>UZL   <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="dv">0</span>    , <span class="at">max =</span> <span class="dv">70</span>)   <span class="co">#Threshold for shallow storage</span></span>
<span id="cb337-15"><a href="modelingcalibration.html#cb337-15" aria-hidden="true" tabindex="-1"></a>PERC  <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="dv">0</span>    , <span class="at">max =</span> <span class="dv">4</span>)    <span class="co">#Percolation, max flow from upper to lower storage</span></span>
<span id="cb337-16"><a href="modelingcalibration.html#cb337-16" aria-hidden="true" tabindex="-1"></a>MAXBAS<span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, N)   <span class="co">#base of the triangular routing function, days</span></span>
<span id="cb337-17"><a href="modelingcalibration.html#cb337-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-18"><a href="modelingcalibration.html#cb337-18" aria-hidden="true" tabindex="-1"></a>NSE <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, N) <span class="co">#create NSE column, to be filled in for loop</span></span>
<span id="cb337-19"><a href="modelingcalibration.html#cb337-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-20"><a href="modelingcalibration.html#cb337-20" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">&lt;-</span> <span class="fu">cbind</span>(FC, beta, LP, SFCF, </span>
<span id="cb337-21"><a href="modelingcalibration.html#cb337-21" aria-hidden="true" tabindex="-1"></a>               TT, CFMAX, k0, k1, </span>
<span id="cb337-22"><a href="modelingcalibration.html#cb337-22" aria-hidden="true" tabindex="-1"></a>               k2, UZL, PERC, MAXBAS, NSE) </span></code></pre></div>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="modelingcalibration.html#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="co">#trim the first 40% (warm up) of Qobs off for NSE calculation </span></span>
<span id="cb338-2"><a href="modelingcalibration.html#cb338-2" aria-hidden="true" tabindex="-1"></a>EvalStart <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="fu">length</span>(Qobs)<span class="sc">*</span><span class="fl">0.4</span>)</span>
<span id="cb338-3"><a href="modelingcalibration.html#cb338-3" aria-hidden="true" tabindex="-1"></a>EvalEnd <span class="ot">&lt;-</span> <span class="fu">length</span>(Qobs)</span>
<span id="cb338-4"><a href="modelingcalibration.html#cb338-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-5"><a href="modelingcalibration.html#cb338-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-6"><a href="modelingcalibration.html#cb338-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb338-7"><a href="modelingcalibration.html#cb338-7" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb338-8"><a href="modelingcalibration.html#cb338-8" aria-hidden="true" tabindex="-1"></a>   <span class="co">#call model with i parameter set generated above</span></span>
<span id="cb338-9"><a href="modelingcalibration.html#cb338-9" aria-hidden="true" tabindex="-1"></a>   results <span class="ot">&lt;-</span> <span class="fu">HBV</span>(pars[i,<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>], P, Temp, PET, routing)</span>
<span id="cb338-10"><a href="modelingcalibration.html#cb338-10" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb338-11"><a href="modelingcalibration.html#cb338-11" aria-hidden="true" tabindex="-1"></a>   <span class="co">#add the Qobs to results</span></span>
<span id="cb338-12"><a href="modelingcalibration.html#cb338-12" aria-hidden="true" tabindex="-1"></a>   results <span class="ot">&lt;-</span> <span class="fu">cbind</span>(results, Qobs)</span>
<span id="cb338-13"><a href="modelingcalibration.html#cb338-13" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb338-14"><a href="modelingcalibration.html#cb338-14" aria-hidden="true" tabindex="-1"></a>   <span class="co">#trim the first 40% of the record so it isn&#39;t included in the NSE calculation</span></span>
<span id="cb338-15"><a href="modelingcalibration.html#cb338-15" aria-hidden="true" tabindex="-1"></a>   results <span class="ot">&lt;-</span> results[EvalStart<span class="sc">:</span>EvalEnd,]</span>
<span id="cb338-16"><a href="modelingcalibration.html#cb338-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb338-17"><a href="modelingcalibration.html#cb338-17" aria-hidden="true" tabindex="-1"></a>   <span class="co">#Calculate NSE and add to parameter set</span></span>
<span id="cb338-18"><a href="modelingcalibration.html#cb338-18" aria-hidden="true" tabindex="-1"></a>   pars[i,<span class="dv">13</span>]  <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> ((<span class="fu">sum</span>((results<span class="sc">$</span>Qobs <span class="sc">-</span> results<span class="sc">$</span>q) <span class="sc">^</span> <span class="dv">2</span>)) <span class="sc">/</span> <span class="fu">sum</span>((results<span class="sc">$</span>Qobs <span class="sc">-</span> <span class="fu">mean</span>(results<span class="sc">$</span>Qobs)) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb338-19"><a href="modelingcalibration.html#cb338-19" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb338-20"><a href="modelingcalibration.html#cb338-20" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="modelingcalibration.html#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="co">#find best parameters</span></span>
<span id="cb339-2"><a href="modelingcalibration.html#cb339-2" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(pars)</span>
<span id="cb339-3"><a href="modelingcalibration.html#cb339-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-4"><a href="modelingcalibration.html#cb339-4" aria-hidden="true" tabindex="-1"></a>bestparams <span class="ot">&lt;-</span> pars <span class="sc">%&gt;%</span> <span class="fu">filter</span>(NSE <span class="sc">==</span> <span class="fu">max</span>(NSE)) <span class="sc">%&gt;%</span></span>
<span id="cb339-5"><a href="modelingcalibration.html#cb339-5" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb339-6"><a href="modelingcalibration.html#cb339-6" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">as.numeric</span>()</span>
<span id="cb339-7"><a href="modelingcalibration.html#cb339-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-8"><a href="modelingcalibration.html#cb339-8" aria-hidden="true" tabindex="-1"></a><span class="co">#run with best parameters</span></span>
<span id="cb339-9"><a href="modelingcalibration.html#cb339-9" aria-hidden="true" tabindex="-1"></a>modeloutput <span class="ot">&lt;-</span>  <span class="fu">HBV</span>(bestparams, P, Temp, PET, routing)</span>
<span id="cb339-10"><a href="modelingcalibration.html#cb339-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-11"><a href="modelingcalibration.html#cb339-11" aria-hidden="true" tabindex="-1"></a><span class="co">#add observations for plotting</span></span>
<span id="cb339-12"><a href="modelingcalibration.html#cb339-12" aria-hidden="true" tabindex="-1"></a>modeloutput <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(modeloutput, Qobs1)</span>
<span id="cb339-13"><a href="modelingcalibration.html#cb339-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-14"><a href="modelingcalibration.html#cb339-14" aria-hidden="true" tabindex="-1"></a><span class="co">#trim out warm up period for plotting</span></span>
<span id="cb339-15"><a href="modelingcalibration.html#cb339-15" aria-hidden="true" tabindex="-1"></a>OutputTrim <span class="ot">&lt;-</span> <span class="fu">filter</span>(modeloutput, DATE <span class="sc">&gt;=</span> <span class="fu">mdy</span>(<span class="st">&quot;08-07-2010&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="modelingcalibration.html#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate NSE</span></span>
<span id="cb340-2"><a href="modelingcalibration.html#cb340-2" aria-hidden="true" tabindex="-1"></a>NSE <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> ((<span class="fu">sum</span>((OutputTrim<span class="sc">$</span>q <span class="sc">-</span> OutputTrim<span class="sc">$</span>WS_3) <span class="sc">^</span> <span class="dv">2</span>)) <span class="sc">/</span> </span>
<span id="cb340-3"><a href="modelingcalibration.html#cb340-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">sum</span>((OutputTrim<span class="sc">$</span>WS_3 <span class="sc">-</span> <span class="fu">mean</span>(OutputTrim<span class="sc">$</span>WS_3)) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb340-4"><a href="modelingcalibration.html#cb340-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-5"><a href="modelingcalibration.html#cb340-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Create plot with NSE in title</span></span>
<span id="cb340-6"><a href="modelingcalibration.html#cb340-6" aria-hidden="true" tabindex="-1"></a>OutputTrim <span class="sc">%&gt;%</span> <span class="fu">plot_ly</span>(<span class="at">x =</span> <span class="sc">~</span>DATE) <span class="sc">%&gt;%</span> </span>
<span id="cb340-7"><a href="modelingcalibration.html#cb340-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">add_trace</span>(<span class="at">y =</span> <span class="sc">~</span>q, <span class="at">name =</span> <span class="st">&#39;Modeled&#39;</span>,  <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="at">mode =</span> <span class="st">&#39;lines&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb340-8"><a href="modelingcalibration.html#cb340-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">add_trace</span>(<span class="at">y =</span> <span class="sc">~</span>WS_3, <span class="at">name =</span> <span class="st">&#39;Measured&#39;</span>, <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="at">mode =</span> <span class="st">&#39;lines&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb340-9"><a href="modelingcalibration.html#cb340-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">layout</span>(<span class="at">title=</span><span class="fu">paste</span>(<span class="st">&quot;NSE: &quot;</span>, <span class="fu">round</span>(NSE,<span class="dv">2</span>)))</span></code></pre></div>
<div id="htmlwidget-99dd9ac73bee3a4438d5" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-99dd9ac73bee3a4438d5">{"x":{"visdat":{"172aa5077c89f":["function () ","plotlyVisDat"]},"cur_data":"172aa5077c89f","attrs":{"172aa5077c89f":{"x":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"name":"Modeled","type":"scatter","mode":"lines","inherit":true},"172aa5077c89f.1":{"x":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"name":"Measured","type":"scatter","mode":"lines","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"NSE:  0.73","xaxis":{"domain":[0,1],"automargin":true,"title":"DATE"},"yaxis":{"domain":[0,1],"automargin":true,"title":"q"},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["2010-08-07","2010-08-08","2010-08-09","2010-08-10","2010-08-11","2010-08-12","2010-08-13","2010-08-14","2010-08-15","2010-08-16","2010-08-17","2010-08-18","2010-08-19","2010-08-20","2010-08-21","2010-08-22","2010-08-23","2010-08-24","2010-08-25","2010-08-26","2010-08-27","2010-08-28","2010-08-29","2010-08-30","2010-08-31","2010-09-01","2010-09-02","2010-09-03","2010-09-04","2010-09-05","2010-09-06","2010-09-07","2010-09-08","2010-09-09","2010-09-10","2010-09-11","2010-09-12","2010-09-13","2010-09-14","2010-09-15","2010-09-16","2010-09-17","2010-09-18","2010-09-19","2010-09-20","2010-09-21","2010-09-22","2010-09-23","2010-09-24","2010-09-25","2010-09-26","2010-09-27","2010-09-28","2010-09-29","2010-09-30","2010-10-01","2010-10-02","2010-10-03","2010-10-04","2010-10-05","2010-10-06","2010-10-07","2010-10-08","2010-10-09","2010-10-10","2010-10-11","2010-10-12","2010-10-13","2010-10-14","2010-10-15","2010-10-16","2010-10-17","2010-10-18","2010-10-19","2010-10-20","2010-10-21","2010-10-22","2010-10-23","2010-10-24","2010-10-25","2010-10-26","2010-10-27","2010-10-28","2010-10-29","2010-10-30","2010-10-31","2010-11-01","2010-11-02","2010-11-03","2010-11-04","2010-11-05","2010-11-06","2010-11-07","2010-11-08","2010-11-09","2010-11-10","2010-11-11","2010-11-12","2010-11-13","2010-11-14","2010-11-15","2010-11-16","2010-11-17","2010-11-18","2010-11-19","2010-11-20","2010-11-21","2010-11-22","2010-11-23","2010-11-24","2010-11-25","2010-11-26","2010-11-27","2010-11-28","2010-11-29","2010-11-30","2010-12-01","2010-12-02","2010-12-03","2010-12-04","2010-12-05","2010-12-06","2010-12-07","2010-12-08","2010-12-09","2010-12-10","2010-12-11","2010-12-12","2010-12-13","2010-12-14","2010-12-15","2010-12-16","2010-12-17","2010-12-18","2010-12-19","2010-12-20","2010-12-21","2010-12-22","2010-12-23","2010-12-24","2010-12-25","2010-12-26","2010-12-27","2010-12-28","2010-12-29","2010-12-30","2010-12-31","2011-01-01","2011-01-02","2011-01-03","2011-01-04","2011-01-05","2011-01-06","2011-01-07","2011-01-08","2011-01-09","2011-01-10","2011-01-11","2011-01-12","2011-01-13","2011-01-14","2011-01-15","2011-01-16","2011-01-17","2011-01-18","2011-01-19","2011-01-20","2011-01-21","2011-01-22","2011-01-23","2011-01-24","2011-01-25","2011-01-26","2011-01-27","2011-01-28","2011-01-29","2011-01-30","2011-01-31","2011-02-01","2011-02-02","2011-02-03","2011-02-04","2011-02-05","2011-02-06","2011-02-07","2011-02-08","2011-02-09","2011-02-10","2011-02-11","2011-02-12","2011-02-13","2011-02-14","2011-02-15","2011-02-16","2011-02-17","2011-02-18","2011-02-19","2011-02-20","2011-02-21","2011-02-22","2011-02-23","2011-02-24","2011-02-25","2011-02-26","2011-02-27","2011-02-28","2011-03-01","2011-03-02","2011-03-03","2011-03-04","2011-03-05","2011-03-06","2011-03-07","2011-03-08","2011-03-09","2011-03-10","2011-03-11","2011-03-12","2011-03-13","2011-03-14","2011-03-15","2011-03-16","2011-03-17","2011-03-18","2011-03-19","2011-03-20","2011-03-21","2011-03-22","2011-03-23","2011-03-24","2011-03-25","2011-03-26","2011-03-27","2011-03-28","2011-03-29","2011-03-30","2011-03-31","2011-04-01","2011-04-02","2011-04-03","2011-04-04","2011-04-05","2011-04-06","2011-04-07","2011-04-08","2011-04-09","2011-04-10","2011-04-11","2011-04-12","2011-04-13","2011-04-14","2011-04-15","2011-04-16","2011-04-17","2011-04-18","2011-04-19","2011-04-20","2011-04-21","2011-04-22","2011-04-23","2011-04-24","2011-04-25","2011-04-26","2011-04-27","2011-04-28","2011-04-29","2011-04-30","2011-05-01","2011-05-02","2011-05-03","2011-05-04","2011-05-05","2011-05-06","2011-05-07","2011-05-08","2011-05-09","2011-05-10","2011-05-11","2011-05-12","2011-05-13","2011-05-14","2011-05-15","2011-05-16","2011-05-17","2011-05-18","2011-05-19","2011-05-20","2011-05-21","2011-05-22","2011-05-23","2011-05-24","2011-05-25","2011-05-26","2011-05-27","2011-05-28","2011-05-29","2011-05-30","2011-05-31","2011-06-01","2011-06-02","2011-06-03","2011-06-04","2011-06-05","2011-06-06","2011-06-07","2011-06-08","2011-06-09","2011-06-10","2011-06-11","2011-06-12","2011-06-13","2011-06-14","2011-06-15","2011-06-16","2011-06-17","2011-06-18","2011-06-19","2011-06-20","2011-06-21","2011-06-22","2011-06-23","2011-06-24","2011-06-25","2011-06-26","2011-06-27","2011-06-28","2011-06-29","2011-06-30","2011-07-01","2011-07-02","2011-07-03","2011-07-04","2011-07-05","2011-07-06","2011-07-07","2011-07-08","2011-07-09","2011-07-10","2011-07-11","2011-07-12","2011-07-13","2011-07-14","2011-07-15","2011-07-16","2011-07-17","2011-07-18","2011-07-19","2011-07-20","2011-07-21","2011-07-22","2011-07-23","2011-07-24","2011-07-25","2011-07-26","2011-07-27","2011-07-28","2011-07-29","2011-07-30","2011-07-31","2011-08-01","2011-08-02","2011-08-03","2011-08-04","2011-08-05","2011-08-06","2011-08-07","2011-08-08","2011-08-09","2011-08-10","2011-08-11","2011-08-12","2011-08-13","2011-08-14","2011-08-15","2011-08-16","2011-08-17","2011-08-18","2011-08-19","2011-08-20","2011-08-21","2011-08-22","2011-08-23","2011-08-24","2011-08-25","2011-08-26","2011-08-27","2011-08-28","2011-08-29","2011-08-30","2011-08-31","2011-09-01","2011-09-02","2011-09-03","2011-09-04","2011-09-05","2011-09-06","2011-09-07","2011-09-08","2011-09-09","2011-09-10","2011-09-11","2011-09-12","2011-09-13","2011-09-14","2011-09-15","2011-09-16","2011-09-17","2011-09-18","2011-09-19","2011-09-20","2011-09-21","2011-09-22","2011-09-23","2011-09-24","2011-09-25","2011-09-26","2011-09-27","2011-09-28","2011-09-29","2011-09-30","2011-10-01","2011-10-02","2011-10-03","2011-10-04","2011-10-05","2011-10-06","2011-10-07","2011-10-08","2011-10-09","2011-10-10","2011-10-11","2011-10-12","2011-10-13","2011-10-14","2011-10-15","2011-10-16","2011-10-17","2011-10-18","2011-10-19","2011-10-20","2011-10-21","2011-10-22","2011-10-23","2011-10-24","2011-10-25","2011-10-26","2011-10-27","2011-10-28","2011-10-29","2011-10-30","2011-10-31","2011-11-01","2011-11-02","2011-11-03","2011-11-04","2011-11-05","2011-11-06","2011-11-07","2011-11-08","2011-11-09","2011-11-10","2011-11-11","2011-11-12","2011-11-13","2011-11-14","2011-11-15","2011-11-16","2011-11-17","2011-11-18","2011-11-19","2011-11-20","2011-11-21","2011-11-22","2011-11-23","2011-11-24","2011-11-25","2011-11-26","2011-11-27","2011-11-28","2011-11-29","2011-11-30","2011-12-01","2011-12-02","2011-12-03","2011-12-04","2011-12-05","2011-12-06","2011-12-07","2011-12-08","2011-12-09","2011-12-10","2011-12-11","2011-12-12","2011-12-13","2011-12-14","2011-12-15","2011-12-16","2011-12-17","2011-12-18","2011-12-19","2011-12-20","2011-12-21","2011-12-22","2011-12-23","2011-12-24","2011-12-25","2011-12-26","2011-12-27","2011-12-28","2011-12-29","2011-12-30","2011-12-31","2012-01-01","2012-01-02","2012-01-03","2012-01-04","2012-01-05","2012-01-06","2012-01-07","2012-01-08","2012-01-09","2012-01-10","2012-01-11","2012-01-12","2012-01-13","2012-01-14","2012-01-15","2012-01-16","2012-01-17","2012-01-18","2012-01-19","2012-01-20","2012-01-21","2012-01-22","2012-01-23","2012-01-24","2012-01-25","2012-01-26","2012-01-27","2012-01-28","2012-01-29","2012-01-30","2012-01-31","2012-02-01","2012-02-02","2012-02-03","2012-02-04","2012-02-05","2012-02-06","2012-02-07","2012-02-08","2012-02-09","2012-02-10","2012-02-11","2012-02-12","2012-02-13","2012-02-14","2012-02-15","2012-02-16","2012-02-17","2012-02-18","2012-02-19","2012-02-20","2012-02-21","2012-02-22","2012-02-23","2012-02-24","2012-02-25","2012-02-26","2012-02-27","2012-02-28","2012-02-29","2012-03-01","2012-03-02","2012-03-03","2012-03-04","2012-03-05","2012-03-06","2012-03-07","2012-03-08","2012-03-09","2012-03-10","2012-03-11","2012-03-12","2012-03-13","2012-03-14","2012-03-15","2012-03-16","2012-03-17","2012-03-18","2012-03-19","2012-03-20","2012-03-21","2012-03-22","2012-03-23","2012-03-24","2012-03-25","2012-03-26","2012-03-27","2012-03-28","2012-03-29","2012-03-30","2012-03-31","2012-04-01","2012-04-02","2012-04-03","2012-04-04","2012-04-05","2012-04-06","2012-04-07","2012-04-08","2012-04-09","2012-04-10","2012-04-11","2012-04-12","2012-04-13","2012-04-14","2012-04-15","2012-04-16","2012-04-17","2012-04-18","2012-04-19","2012-04-20","2012-04-21","2012-04-22","2012-04-23","2012-04-24","2012-04-25","2012-04-26","2012-04-27","2012-04-28","2012-04-29","2012-04-30","2012-05-01","2012-05-02","2012-05-03","2012-05-04","2012-05-05","2012-05-06","2012-05-07","2012-05-08","2012-05-09","2012-05-10","2012-05-11","2012-05-12","2012-05-13","2012-05-14","2012-05-15","2012-05-16","2012-05-17","2012-05-18","2012-05-19","2012-05-20","2012-05-21","2012-05-22","2012-05-23","2012-05-24","2012-05-25","2012-05-26","2012-05-27","2012-05-28","2012-05-29","2012-05-30","2012-05-31","2012-06-01","2012-06-02","2012-06-03","2012-06-04","2012-06-05","2012-06-06","2012-06-07","2012-06-08","2012-06-09","2012-06-10","2012-06-11","2012-06-12","2012-06-13","2012-06-14","2012-06-15","2012-06-16","2012-06-17","2012-06-18","2012-06-19","2012-06-20","2012-06-21","2012-06-22","2012-06-23","2012-06-24","2012-06-25","2012-06-26","2012-06-27","2012-06-28","2012-06-29","2012-06-30","2012-07-01","2012-07-02","2012-07-03","2012-07-04","2012-07-05","2012-07-06","2012-07-07","2012-07-08","2012-07-09","2012-07-10","2012-07-11","2012-07-12","2012-07-13","2012-07-14","2012-07-15","2012-07-16","2012-07-17","2012-07-18","2012-07-19","2012-07-20","2012-07-21","2012-07-22","2012-07-23","2012-07-24","2012-07-25","2012-07-26","2012-07-27","2012-07-28","2012-07-29","2012-07-30","2012-07-31","2012-08-01","2012-08-02","2012-08-03","2012-08-04","2012-08-05","2012-08-06","2012-08-07","2012-08-08","2012-08-09","2012-08-10","2012-08-11","2012-08-12","2012-08-13","2012-08-14","2012-08-15","2012-08-16","2012-08-17","2012-08-18","2012-08-19","2012-08-20","2012-08-21","2012-08-22","2012-08-23","2012-08-24","2012-08-25","2012-08-26","2012-08-27","2012-08-28","2012-08-29","2012-08-30","2012-08-31","2012-09-01","2012-09-02","2012-09-03","2012-09-04","2012-09-05","2012-09-06","2012-09-07","2012-09-08","2012-09-09","2012-09-10","2012-09-11","2012-09-12","2012-09-13","2012-09-14","2012-09-15","2012-09-16","2012-09-17","2012-09-18","2012-09-19","2012-09-20","2012-09-21","2012-09-22","2012-09-23","2012-09-24","2012-09-25","2012-09-26","2012-09-27","2012-09-28","2012-09-29","2012-09-30","2012-10-01","2012-10-02","2012-10-03","2012-10-04","2012-10-05","2012-10-06","2012-10-07","2012-10-08","2012-10-09","2012-10-10","2012-10-11","2012-10-12","2012-10-13","2012-10-14","2012-10-15","2012-10-16","2012-10-17","2012-10-18","2012-10-19","2012-10-20","2012-10-21","2012-10-22","2012-10-23","2012-10-24","2012-10-25","2012-10-26","2012-10-27","2012-10-28","2012-10-29","2012-10-30","2012-10-31","2012-11-01","2012-11-02","2012-11-03","2012-11-04","2012-11-05","2012-11-06","2012-11-07","2012-11-08","2012-11-09","2012-11-10","2012-11-11","2012-11-12","2012-11-13","2012-11-14","2012-11-15","2012-11-16","2012-11-17","2012-11-18","2012-11-19","2012-11-20","2012-11-21","2012-11-22","2012-11-23","2012-11-24","2012-11-25","2012-11-26","2012-11-27","2012-11-28","2012-11-29","2012-11-30","2012-12-01","2012-12-02","2012-12-03","2012-12-04","2012-12-05","2012-12-06","2012-12-07","2012-12-08","2012-12-09","2012-12-10","2012-12-11","2012-12-12","2012-12-13","2012-12-14","2012-12-15","2012-12-16","2012-12-17","2012-12-18","2012-12-19","2012-12-20","2012-12-21","2012-12-22","2012-12-23","2012-12-24","2012-12-25","2012-12-26","2012-12-27","2012-12-28","2012-12-29","2012-12-30","2012-12-31"],"y":[0.950444413198043,0.879934714120347,1.01070030575792,0.935720461142977,0.866303073634711,0.802035486615565,0.742535656824768,0.687449883274891,1.22347735588483,0.938106675153308,0.868512263897555,0.804080785820209,0.744429223398402,0.689202973659242,0.638073740217117,1.22312369151968,1.00407961656671,0.929590934607971,1.96981238557653,1.35917302465321,1.25834137197365,1.16499001944548,1.07856403328683,0.998549648050779,0.924471212509984,0.855888362113988,0.792393401210699,0.794228532540675,0.821404038726131,0.768563502936193,0.711546826777522,0.658759991546456,0.655641906866595,0.612416853795306,0.626323682593205,0.579859214212265,0.562856195297293,0.614417548934859,0.602703423085416,0.564711077920138,1.62670475910922,1.20132732095853,1.01306737838551,0.937911930046306,0.868331966157175,0.803913863653658,0.77805606940088,0.720335177408431,0.760883394845747,0.704436475426999,0.652177128944459,1.43069085292062,5.14579433897126,3.5751676316238,26.8112681443658,39.6272760376752,9.80414410568124,5.95357291259923,4.33856909380167,3.10482167259615,3.11559809417056,2.86541140821911,2.59490250302892,2.40239698446956,2.22417268635396,2.0591701416139,1.90640848083836,1.76497960142522,1.70716258065117,9.79589159697394,6.44308891805637,4.84888419227666,3.50030843354735,2.472118373654,2.26343752225549,2.09552207516648,1.94006360870709,1.84819361167746,1.7110834623756,3.42441536262099,3.28927464851172,5.02174029617013,3.6351106398454,2.82130381035232,2.35556842803116,2.18081815467373,2.01903191058206,1.86924794587403,1.73057585907444,1.60219130405992,4.62486644426403,3.67861724174044,2.55594517236807,2.05764292314135,2.46281465842939,2.10498508434643,1.94882459479092,1.80424903221639,1.67039895686612,1.54647868740815,1.43175157095079,1.35707583668612,6.74817871496418,4.88352758573401,3.46114530091732,2.38049727320212,1.98551383852764,1.83821644656537,2.38905860217961,1.9503880032093,1.80569645756876,1.67173900347586,1.54771932127802,1.43290016711744,1.32659899033228,1.22818387598554,11.8795772547007,5.75837597535047,4.1246360374048,2.88094397793127,2.05183805910422,1.89962033643193,1.75869504251285,1.62822443687294,1.50743292767929,1.39560246117906,1.29206825317764,16.5895128599571,17.8897649931767,6.49390131028454,4.72981693506041,3.38233544149661,2.35688286633379,2.13577326702156,1.97732872437949,1.83063855355239,1.69483074434376,1.56909797753291,1.4526928257082,1.34492331013141,1.24514878722075,1.15277614019925,1.06725625326983,0.98808074735714,0.914778958011885,0.846915137512383,0.966703396619644,3.1552690923995,2.43754115560842,1.56278196838167,1.44684537621015,1.33950965970541,1.24013675403522,1.14813592986498,1.0629602817251,0.984103476892306,0.911096745458627,0.843506093695207,0.780929724145588,0.722995647112026,0.669359469336177,0.61970234672877,0.573729088978153,0.531166404770401,0.491761277189585,0.455279459640644,0.421504083353773,0.390234368192533,0.36128442910199,0.334482171101731,0.309668266254964,0.286695206532218,0.265426426939326,0.245735493697067,0.227505352646537,0.210627633412335,0.195002005187135,0.180535580308032,0.167142362079199,0.154742733558384,0.143262984268313,0.132634872019495,0.122795217239647,0.113685527398224,0.105251649293384,0.0974434471344209,0.0902145045059689,0.0835218484423114,0.0773256939715152,0.0715892076108241,0.0662782884073903,0.0613613652227241,0.0568092090558076,0.0525947592892095,0.0834537262437132,2.27892571857356,1.23486454960057,0.746580946388929,0.691195068860438,0.639918049781173,0.592445069249218,0.548493920741469,0.507803333516808,0.470131419473519,0.435254235228194,0.402964450868298,0.373070117464696,0.345393526017538,0.319770151052413,0.296047672586924,0.274085070653667,24.7745377832345,6.15876323369643,4.31425389579758,2.91577436193338,1.86134005332594,3.8140202916288,2.61725929710646,1.89103213221356,1.75074396308226,1.62086321647062,1.50061780700485,2.46309836073721,5.14080171814029,3.67938025181307,2.56703520545409,2.10412688196582,1.94803005903906,1.80351343991877,1.66971793524179,1.54584818807542,1.43116784586135,1.32499518311528,1.2266990488611,1.1356951147088,1.05144240127269,0.973440062280753,0.901224407258234,0.834366145086502,0.772467832051326,0.715161509210339,1.1306244296786,0.931194979157167,0.930713930778503,1.84461602572911,5.16038673952688,20.198915098979,39.5420128737398,25.4747691376707,14.9148849066747,7.95259474710269,5.91629891318062,4.35334255195517,11.8678906293333,9.1558719669086,6.55747658321128,6.7515152179991,5.48353469481362,4.10760544639495,5.79831221834166,4.56695667501886,5.32552023487355,8.99876290822529,7.12034440026486,6.85137696664977,5.30372316959285,4.03877136582174,3.35470926496186,3.10583669810683,2.87973448327527,4.52959376648044,3.54745676824195,2.94376993488369,2.72538332607171,2.52319795307752,2.3360119105121,2.16271245757734,2.00226940329891,1.85372898248245,1.71620818598827,2.01581159994652,5.72774291476414,4.38361203921711,3.69889933019699,3.60373811862825,5.19236291077501,4.37906931335647,5.83054946814095,4.50553384649917,4.95315423427901,3.69377837766375,2.96404815344621,2.91329914055325,2.75924882903522,2.55455110877494,2.36503910001659,2.29525634359891,2.12498038443073,1.96733652291539,1.83757782421776,1.70125521805768,1.57504584503819,1.45819944452799,1.35002141475456,1.24986868369425,1.16103769905666,1.12417059038533,1.0407728356725,1.17732198637981,1.17633536384141,1.66476337157615,1.45817800077491,1.38974557738105,1.29705352555909,1.30197367684416,1.3116842441393,1.24231439507635,1.15015202035947,1.06482680646687,1.11100885316816,1.5699028843611,3.12864488451793,2.18906979373062,1.86383454526617,1.74013576184265,1.64590046936088,1.52379764546613,1.4255673155891,1.33322095034427,1.23431457906418,1.21082972767464,1.12100307548212,1.03784030612935,1.1625529921614,1.07630779938536,1.00117930822579,1.07826653619657,0.998274221088999,0.924216218381438,0.855652284987868,0.800848716462129,0.741436928439195,0.686432665187825,0.635508949936937,0.588363063024454,0.622680843809735,0.576486623181156,0.533719368454445,0.494124846629611,0.457467685243986,0.423529973183804,0.392109965296028,0.39604664188127,0.384745072102598,0.356202362104125,0.329777122485726,0.357242202465294,0.335949655839381,0.311026884123793,0.287953033933175,0.277521055843236,0.261154805924553,0.253454437534253,0.234651658673873,0.22082274633331,0.269623486579489,0.25631727066848,0.278805596279832,0.410431283156829,0.379983015098641,0.351793583210573,0.32569541340159,0.981055129430914,6.08611129025704,7.0159241636281,5.02153701231844,3.56309606047203,2.43922373644837,1.75114616322366,6.56504574195319,5.68500709720464,4.1342417290312,2.95009283340738,3.31714145846345,2.50204386198241,2.46694601570085,62.4820719872404,17.7594636855866,7.32566476888961,5.51482125227795,4.1207191557363,3.04951631499162,2.80850962660054,3.27413043807603,5.51188002444803,5.48063407384555,7.24962709954527,6.90168662458371,5.24535114831577,3.96687528127861,3.22587301722624,2.98655830029067,2.76499739245922,2.55987320909228,3.80283807775497,2.76188259010225,2.55698948156076,2.36729657960237,2.19167624122426,2.10364162899773,1.9475808050629,2.49330470290722,2.1935227941561,2.16075367111394,2.00045593142958,1.85205004489416,1.71465380211662,1.58745044131946,4.51617688626792,8.67620339598698,7.73348880198297,21.8543819205746,7.83511931370479,5.9968443723393,4.79187418655488,3.51677004757159,2.70358199949861,2.50301398040205,2.31732530666723,2.14541213871199,1.98625252643207,1.83890033414572,1.87110038252933,9.59892625722455,7.53129815472258,6.56574369688133,5.12413662221985,3.7520218222031,3.35551479695465,3.70853541443409,2.79447294409296,2.62431027503451,2.42962311057786,2.37472016842166,2.19854910345033,2.03544747063604,1.88444570067446,1.7446461527601,1.61521777849647,1.49539118166949,1.39458119803232,1.72084696249345,1.68305435654142,1.55819523320581,1.44259891271405,1.33557822448356,1.23649697639016,1.14476617287858,1.05984051363629,0.981215152016875,2.34963953402386,1.54160461555757,1.33925513082754,1.23990110764467,1.38849155328529,1.3174773925647,1.76848988088171,1.53587180260609,1.42193156883767,1.31644410882886,1.21878234484016,1.12836571954091,1.04465674484484,0.967157806773702,0.895408207355468,0.953929791560965,2.1034400841433,1.33036929427248,1.23167447603926,1.38515838289329,5.2322091977938,3.78184090266746,2.60851783802832,1.95636097614701,1.81122631934859,1.67685862675607,1.84932298423907,4.14367449967607,2.92688958225487,2.19314972886541,2.03044865422359,1.87981772661332,1.74036150972796,1.65138326862245,1.52887369760953,5.34108615902693,4.53628159513928,3.21316114237018,2.20803336361732,2.02508243820812,1.87484960886766,1.73576195692136,2.39147467238618,1.88773966651191,1.74769575234452,1.61804114039037,1.49800508954929,1.38687403694457,1.28398735609745,1.18873342978589,1.10054601424228,1.070826543394,2.9290658275627,1.87601111976859,1.47701930907453,1.36744510823898,1.2659997825068,1.17208028289438,1.0851282982289,1.00462693622777,0.930097650795473,0.861097397272182,0.797215998723103,0.73807370761241,0.683318948366888,0.632626227409836,0.585694198241255,0.542243870062053,0.502016949293322,0.464774304131706,0.430294543013321,0.398372698535792,0.368819009014893,0.341457790432659,0.316126392071201,0.292674229623892,0.270961890036203,0.250860302754849,0.232249972458658,0.215020268710112,0.1990687683048,0.18430064640937,0.170628112868535,0.157969890330224,0.146250731086557,0.135400969758477,0.125356109164921,0.116056436914727,0.107446670442059,0.0994756283752453,0.0920959262854591,0.0852636950065991,0.0789383198518975,0.0730821991770144,0.0676605208543771,0.0626410553300022,0.0579939640326099,0.0536916219961062,0.049708453640999,0.237204399933044,0.219607146872334,0.203315364179669,0.18823220418934,0.174268003979605,0.691770756523078,0.643207606843353,0.595490587127903,0.551313503735189,0.510413742838032,0.472548172886882,0.437491699296957,0.405035926357408,0.374987918408135,0.347169052919976,0.321413958660323,0.297569532632024,0.275494029941681,0.255056221187007,0.236134612354274,4.71276460773002,3.14739792458558,1.96905597457297,1.20384273358762,6.50121149053496,15.6415358101993,10.73558550822,7.187354474985,8.79797050008935,7.80876332679913,5.808904687617,4.273940921923,3.09885233172489,2.53149275424112,2.34369135329616,2.16982219297791,2.05514725898353,2.12604621498236,1.96832328372825,1.82230119080404,1.68711189745002,1.71931792203872,1.68783995431926,1.59465189055022,1.51267526026855,1.40045588591826,1.29656162159677,1.2003748604301,1.11132381334722,1.02887911003908,0.952550652078997,0.902555925745021,1.75252453623747,1.20784239697946,1.11823736299568,1.03527977087626,0.958476473290358,0.887370907550478,0.82154038154301,0.76059356100475,0.704168143208429,0.651928703228281,0.603564699982612,0.558788630200163,0.805591458406602,2.33336070687429,6.51040483120707,5.03544221026343,3.53895643453648,4.33724645020759,3.54023313406117,2.45422663262701,2.05554791949535,1.90305497700362,4.13995787429765,3.20064155238635,2.61132211020104,4.36936311126817,3.31961164812938,2.57160674777336,2.38082944884479,5.26031987162045,4.79616473507364,7.11998219698622,5.99014705985003,4.48072737210963,3.32060002593317,2.96605653499907,16.7210958405252,10.6222921296547,7.443747338826,5.66546248849066,4.29229688141857,3.30559226864871,3.12954173418881,2.99513330357317,2.77293625027898,2.56722311455658,2.54698654694066,2.35803572300404,2.18310241082429,2.04741505493736,11.3984979128577,6.41868074689189,4.74218095367035,3.45751402861351,16.0178005443165,8.55190194920493,7.47104067706786,5.72409229952575,5.66879729214061,4.40216978045031,4.66881929555705,3.51975792140112,3.05462161001215,2.82801135534878,4.18700618992148,6.57240396617875,4.96110033976907,3.71972460934125,3.05290753669072,2.82642444232459,2.61674322990777,2.42261743449847,2.24289306144219,2.07650172636809,1.92245430410182,1.77983504874028,1.64779614993467,3.47789179140452,2.47224421839955,2.11022950687751,1.95367995442746,1.8087441919905,1.67456063857609,1.57816560556321,1.468147427774,1.35923139660315,1.7309482258192,1.4842916027964,1.37417789935048,1.27223309456552,1.17785117026901,1.09047106637158,1.00957334560527,0.934677105691595,0.865337120583603,0.801141193787833,0.741707708032832,0.696549574038719,0.652576316419788,0.643963988403987,0.597319594625081,0.553006824424758,0.511981442785761,0.473999571397069,0.438835424311699,0.433155534823903,0.458567826854234,0.424548499654014,0.43150246266273,0.409618791365632,0.474661543467317,0.705863557955726,0.653498341883905,0.605017893375649,0.657063404546978,0.60831847818807,0.563189744466421,0.52140893240151,0.726582582663721,0.672680304374418,0.622776822194603,0.576575481310551,3.48228708802663,36.9778162180385,14.0924820747407,6.81978010810121,4.92847432738251,3.48617047320961,3.43335952381742,2.37336669249251,2.12907535843633,1.97112770705085,1.82489756508998,1.68951565703167,1.56417719545502,1.44813709692403,1.34070555278586,1.24124392855405,1.1491609675002,1.06390927588614,1.20710861937939,2.33763655699767,1.54732508792313,1.4325351803706,1.34691656597574,1.24699417132442,1.40417299894416,1.30000297675903,1.50096374911223,2.54133835667696,1.78020727195907,1.64814075939007,3.50710784756386,2.40469638411581,1.94390270758073,1.7996922802853,1.66618025227686,1.54257295176999,1.42813558633931,1.32218787489335,1.22410000369505,1.13328888238904,21.0925448719989,7.19658199108855,5.23028646836597,3.72903684815212,3.15696763438028,2.60734948644355,2.13388506950653,1.97558060474459,1.8760356308004,1.76535787039887,2.45468687837294,1.99936629389279,1.99736997759228,2.72233617427682,2.13491326425354,3.36040427633443,2.93029673079529,2.36784020876303,2.72873243700137,2.55751881260537,2.41055511856272,2.23172560085516,2.68885949422861,2.28523478116296,2.30188064273647,2.1311132531045,2.68642239100199,2.36256906597084,2.22084593105623,2.05609018508914,1.90355701406504,6.10683093905172,5.35530913763613,4.11555504678417,2.953546878156,2.40160719323779,2.22344148659931,2.05849318666721,1.90578174649259,1.7643993620133,1.63350557554784,3.43885138742443,12.6389756552291,6.7287797367128,4.95263159624367,3.64545811839803,2.59589461246458,2.34104124610401,2.16736868672112,2.00658020528125,1.85771998317359,1.71990311017683,1.67000965141874,1.54611826298691,1.43141788498698,1.32522667283049,2.71795025024148,1.74694512846888,1.58907949509486,1.47119199378095,1.36205009834072,1.26100500698225,1.1674560499437,1.08084711876909,1.00066336048177,0.926428117004209,0.869789001162125,0.872330663935629,0.807615913913176,0.747702094367675,0.692233043320034,0.640879021034921,0.593334749859364,0.549317599477938,0.508565906796673,0.470837420468102,0.608142933828849,0.774139210018949,1.74799513460622,1.12736325192133,1.04372864631956,1.22061910390965,1.16188162938183,5.06879552996905,3.55148933165333,2.40104812926024,1.78448777800184,1.65210371167715,1.52954069385317,1.41607013991746,1.31101751605856,3.71129901861126,2.51699732284243,1.78020670004624,6.64234264048654,4.85950148459981,3.49638035816591,2.45778953259582,2.21287886313523,2.04871416231906,1.89672818915176,1.7560174521616,1.62574548632355,1.50513788063319,1.39347767456518],"name":"Modeled","type":"scatter","mode":"lines","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2010-08-07","2010-08-08","2010-08-09","2010-08-10","2010-08-11","2010-08-12","2010-08-13","2010-08-14","2010-08-15","2010-08-16","2010-08-17","2010-08-18","2010-08-19","2010-08-20","2010-08-21","2010-08-22","2010-08-23","2010-08-24","2010-08-25","2010-08-26","2010-08-27","2010-08-28","2010-08-29","2010-08-30","2010-08-31","2010-09-01","2010-09-02","2010-09-03","2010-09-04","2010-09-05","2010-09-06","2010-09-07","2010-09-08","2010-09-09","2010-09-10","2010-09-11","2010-09-12","2010-09-13","2010-09-14","2010-09-15","2010-09-16","2010-09-17","2010-09-18","2010-09-19","2010-09-20","2010-09-21","2010-09-22","2010-09-23","2010-09-24","2010-09-25","2010-09-26","2010-09-27","2010-09-28","2010-09-29","2010-09-30","2010-10-01","2010-10-02","2010-10-03","2010-10-04","2010-10-05","2010-10-06","2010-10-07","2010-10-08","2010-10-09","2010-10-10","2010-10-11","2010-10-12","2010-10-13","2010-10-14","2010-10-15","2010-10-16","2010-10-17","2010-10-18","2010-10-19","2010-10-20","2010-10-21","2010-10-22","2010-10-23","2010-10-24","2010-10-25","2010-10-26","2010-10-27","2010-10-28","2010-10-29","2010-10-30","2010-10-31","2010-11-01","2010-11-02","2010-11-03","2010-11-04","2010-11-05","2010-11-06","2010-11-07","2010-11-08","2010-11-09","2010-11-10","2010-11-11","2010-11-12","2010-11-13","2010-11-14","2010-11-15","2010-11-16","2010-11-17","2010-11-18","2010-11-19","2010-11-20","2010-11-21","2010-11-22","2010-11-23","2010-11-24","2010-11-25","2010-11-26","2010-11-27","2010-11-28","2010-11-29","2010-11-30","2010-12-01","2010-12-02","2010-12-03","2010-12-04","2010-12-05","2010-12-06","2010-12-07","2010-12-08","2010-12-09","2010-12-10","2010-12-11","2010-12-12","2010-12-13","2010-12-14","2010-12-15","2010-12-16","2010-12-17","2010-12-18","2010-12-19","2010-12-20","2010-12-21","2010-12-22","2010-12-23","2010-12-24","2010-12-25","2010-12-26","2010-12-27","2010-12-28","2010-12-29","2010-12-30","2010-12-31","2011-01-01","2011-01-02","2011-01-03","2011-01-04","2011-01-05","2011-01-06","2011-01-07","2011-01-08","2011-01-09","2011-01-10","2011-01-11","2011-01-12","2011-01-13","2011-01-14","2011-01-15","2011-01-16","2011-01-17","2011-01-18","2011-01-19","2011-01-20","2011-01-21","2011-01-22","2011-01-23","2011-01-24","2011-01-25","2011-01-26","2011-01-27","2011-01-28","2011-01-29","2011-01-30","2011-01-31","2011-02-01","2011-02-02","2011-02-03","2011-02-04","2011-02-05","2011-02-06","2011-02-07","2011-02-08","2011-02-09","2011-02-10","2011-02-11","2011-02-12","2011-02-13","2011-02-14","2011-02-15","2011-02-16","2011-02-17","2011-02-18","2011-02-19","2011-02-20","2011-02-21","2011-02-22","2011-02-23","2011-02-24","2011-02-25","2011-02-26","2011-02-27","2011-02-28","2011-03-01","2011-03-02","2011-03-03","2011-03-04","2011-03-05","2011-03-06","2011-03-07","2011-03-08","2011-03-09","2011-03-10","2011-03-11","2011-03-12","2011-03-13","2011-03-14","2011-03-15","2011-03-16","2011-03-17","2011-03-18","2011-03-19","2011-03-20","2011-03-21","2011-03-22","2011-03-23","2011-03-24","2011-03-25","2011-03-26","2011-03-27","2011-03-28","2011-03-29","2011-03-30","2011-03-31","2011-04-01","2011-04-02","2011-04-03","2011-04-04","2011-04-05","2011-04-06","2011-04-07","2011-04-08","2011-04-09","2011-04-10","2011-04-11","2011-04-12","2011-04-13","2011-04-14","2011-04-15","2011-04-16","2011-04-17","2011-04-18","2011-04-19","2011-04-20","2011-04-21","2011-04-22","2011-04-23","2011-04-24","2011-04-25","2011-04-26","2011-04-27","2011-04-28","2011-04-29","2011-04-30","2011-05-01","2011-05-02","2011-05-03","2011-05-04","2011-05-05","2011-05-06","2011-05-07","2011-05-08","2011-05-09","2011-05-10","2011-05-11","2011-05-12","2011-05-13","2011-05-14","2011-05-15","2011-05-16","2011-05-17","2011-05-18","2011-05-19","2011-05-20","2011-05-21","2011-05-22","2011-05-23","2011-05-24","2011-05-25","2011-05-26","2011-05-27","2011-05-28","2011-05-29","2011-05-30","2011-05-31","2011-06-01","2011-06-02","2011-06-03","2011-06-04","2011-06-05","2011-06-06","2011-06-07","2011-06-08","2011-06-09","2011-06-10","2011-06-11","2011-06-12","2011-06-13","2011-06-14","2011-06-15","2011-06-16","2011-06-17","2011-06-18","2011-06-19","2011-06-20","2011-06-21","2011-06-22","2011-06-23","2011-06-24","2011-06-25","2011-06-26","2011-06-27","2011-06-28","2011-06-29","2011-06-30","2011-07-01","2011-07-02","2011-07-03","2011-07-04","2011-07-05","2011-07-06","2011-07-07","2011-07-08","2011-07-09","2011-07-10","2011-07-11","2011-07-12","2011-07-13","2011-07-14","2011-07-15","2011-07-16","2011-07-17","2011-07-18","2011-07-19","2011-07-20","2011-07-21","2011-07-22","2011-07-23","2011-07-24","2011-07-25","2011-07-26","2011-07-27","2011-07-28","2011-07-29","2011-07-30","2011-07-31","2011-08-01","2011-08-02","2011-08-03","2011-08-04","2011-08-05","2011-08-06","2011-08-07","2011-08-08","2011-08-09","2011-08-10","2011-08-11","2011-08-12","2011-08-13","2011-08-14","2011-08-15","2011-08-16","2011-08-17","2011-08-18","2011-08-19","2011-08-20","2011-08-21","2011-08-22","2011-08-23","2011-08-24","2011-08-25","2011-08-26","2011-08-27","2011-08-28","2011-08-29","2011-08-30","2011-08-31","2011-09-01","2011-09-02","2011-09-03","2011-09-04","2011-09-05","2011-09-06","2011-09-07","2011-09-08","2011-09-09","2011-09-10","2011-09-11","2011-09-12","2011-09-13","2011-09-14","2011-09-15","2011-09-16","2011-09-17","2011-09-18","2011-09-19","2011-09-20","2011-09-21","2011-09-22","2011-09-23","2011-09-24","2011-09-25","2011-09-26","2011-09-27","2011-09-28","2011-09-29","2011-09-30","2011-10-01","2011-10-02","2011-10-03","2011-10-04","2011-10-05","2011-10-06","2011-10-07","2011-10-08","2011-10-09","2011-10-10","2011-10-11","2011-10-12","2011-10-13","2011-10-14","2011-10-15","2011-10-16","2011-10-17","2011-10-18","2011-10-19","2011-10-20","2011-10-21","2011-10-22","2011-10-23","2011-10-24","2011-10-25","2011-10-26","2011-10-27","2011-10-28","2011-10-29","2011-10-30","2011-10-31","2011-11-01","2011-11-02","2011-11-03","2011-11-04","2011-11-05","2011-11-06","2011-11-07","2011-11-08","2011-11-09","2011-11-10","2011-11-11","2011-11-12","2011-11-13","2011-11-14","2011-11-15","2011-11-16","2011-11-17","2011-11-18","2011-11-19","2011-11-20","2011-11-21","2011-11-22","2011-11-23","2011-11-24","2011-11-25","2011-11-26","2011-11-27","2011-11-28","2011-11-29","2011-11-30","2011-12-01","2011-12-02","2011-12-03","2011-12-04","2011-12-05","2011-12-06","2011-12-07","2011-12-08","2011-12-09","2011-12-10","2011-12-11","2011-12-12","2011-12-13","2011-12-14","2011-12-15","2011-12-16","2011-12-17","2011-12-18","2011-12-19","2011-12-20","2011-12-21","2011-12-22","2011-12-23","2011-12-24","2011-12-25","2011-12-26","2011-12-27","2011-12-28","2011-12-29","2011-12-30","2011-12-31","2012-01-01","2012-01-02","2012-01-03","2012-01-04","2012-01-05","2012-01-06","2012-01-07","2012-01-08","2012-01-09","2012-01-10","2012-01-11","2012-01-12","2012-01-13","2012-01-14","2012-01-15","2012-01-16","2012-01-17","2012-01-18","2012-01-19","2012-01-20","2012-01-21","2012-01-22","2012-01-23","2012-01-24","2012-01-25","2012-01-26","2012-01-27","2012-01-28","2012-01-29","2012-01-30","2012-01-31","2012-02-01","2012-02-02","2012-02-03","2012-02-04","2012-02-05","2012-02-06","2012-02-07","2012-02-08","2012-02-09","2012-02-10","2012-02-11","2012-02-12","2012-02-13","2012-02-14","2012-02-15","2012-02-16","2012-02-17","2012-02-18","2012-02-19","2012-02-20","2012-02-21","2012-02-22","2012-02-23","2012-02-24","2012-02-25","2012-02-26","2012-02-27","2012-02-28","2012-02-29","2012-03-01","2012-03-02","2012-03-03","2012-03-04","2012-03-05","2012-03-06","2012-03-07","2012-03-08","2012-03-09","2012-03-10","2012-03-11","2012-03-12","2012-03-13","2012-03-14","2012-03-15","2012-03-16","2012-03-17","2012-03-18","2012-03-19","2012-03-20","2012-03-21","2012-03-22","2012-03-23","2012-03-24","2012-03-25","2012-03-26","2012-03-27","2012-03-28","2012-03-29","2012-03-30","2012-03-31","2012-04-01","2012-04-02","2012-04-03","2012-04-04","2012-04-05","2012-04-06","2012-04-07","2012-04-08","2012-04-09","2012-04-10","2012-04-11","2012-04-12","2012-04-13","2012-04-14","2012-04-15","2012-04-16","2012-04-17","2012-04-18","2012-04-19","2012-04-20","2012-04-21","2012-04-22","2012-04-23","2012-04-24","2012-04-25","2012-04-26","2012-04-27","2012-04-28","2012-04-29","2012-04-30","2012-05-01","2012-05-02","2012-05-03","2012-05-04","2012-05-05","2012-05-06","2012-05-07","2012-05-08","2012-05-09","2012-05-10","2012-05-11","2012-05-12","2012-05-13","2012-05-14","2012-05-15","2012-05-16","2012-05-17","2012-05-18","2012-05-19","2012-05-20","2012-05-21","2012-05-22","2012-05-23","2012-05-24","2012-05-25","2012-05-26","2012-05-27","2012-05-28","2012-05-29","2012-05-30","2012-05-31","2012-06-01","2012-06-02","2012-06-03","2012-06-04","2012-06-05","2012-06-06","2012-06-07","2012-06-08","2012-06-09","2012-06-10","2012-06-11","2012-06-12","2012-06-13","2012-06-14","2012-06-15","2012-06-16","2012-06-17","2012-06-18","2012-06-19","2012-06-20","2012-06-21","2012-06-22","2012-06-23","2012-06-24","2012-06-25","2012-06-26","2012-06-27","2012-06-28","2012-06-29","2012-06-30","2012-07-01","2012-07-02","2012-07-03","2012-07-04","2012-07-05","2012-07-06","2012-07-07","2012-07-08","2012-07-09","2012-07-10","2012-07-11","2012-07-12","2012-07-13","2012-07-14","2012-07-15","2012-07-16","2012-07-17","2012-07-18","2012-07-19","2012-07-20","2012-07-21","2012-07-22","2012-07-23","2012-07-24","2012-07-25","2012-07-26","2012-07-27","2012-07-28","2012-07-29","2012-07-30","2012-07-31","2012-08-01","2012-08-02","2012-08-03","2012-08-04","2012-08-05","2012-08-06","2012-08-07","2012-08-08","2012-08-09","2012-08-10","2012-08-11","2012-08-12","2012-08-13","2012-08-14","2012-08-15","2012-08-16","2012-08-17","2012-08-18","2012-08-19","2012-08-20","2012-08-21","2012-08-22","2012-08-23","2012-08-24","2012-08-25","2012-08-26","2012-08-27","2012-08-28","2012-08-29","2012-08-30","2012-08-31","2012-09-01","2012-09-02","2012-09-03","2012-09-04","2012-09-05","2012-09-06","2012-09-07","2012-09-08","2012-09-09","2012-09-10","2012-09-11","2012-09-12","2012-09-13","2012-09-14","2012-09-15","2012-09-16","2012-09-17","2012-09-18","2012-09-19","2012-09-20","2012-09-21","2012-09-22","2012-09-23","2012-09-24","2012-09-25","2012-09-26","2012-09-27","2012-09-28","2012-09-29","2012-09-30","2012-10-01","2012-10-02","2012-10-03","2012-10-04","2012-10-05","2012-10-06","2012-10-07","2012-10-08","2012-10-09","2012-10-10","2012-10-11","2012-10-12","2012-10-13","2012-10-14","2012-10-15","2012-10-16","2012-10-17","2012-10-18","2012-10-19","2012-10-20","2012-10-21","2012-10-22","2012-10-23","2012-10-24","2012-10-25","2012-10-26","2012-10-27","2012-10-28","2012-10-29","2012-10-30","2012-10-31","2012-11-01","2012-11-02","2012-11-03","2012-11-04","2012-11-05","2012-11-06","2012-11-07","2012-11-08","2012-11-09","2012-11-10","2012-11-11","2012-11-12","2012-11-13","2012-11-14","2012-11-15","2012-11-16","2012-11-17","2012-11-18","2012-11-19","2012-11-20","2012-11-21","2012-11-22","2012-11-23","2012-11-24","2012-11-25","2012-11-26","2012-11-27","2012-11-28","2012-11-29","2012-11-30","2012-12-01","2012-12-02","2012-12-03","2012-12-04","2012-12-05","2012-12-06","2012-12-07","2012-12-08","2012-12-09","2012-12-10","2012-12-11","2012-12-12","2012-12-13","2012-12-14","2012-12-15","2012-12-16","2012-12-17","2012-12-18","2012-12-19","2012-12-20","2012-12-21","2012-12-22","2012-12-23","2012-12-24","2012-12-25","2012-12-26","2012-12-27","2012-12-28","2012-12-29","2012-12-30","2012-12-31"],"y":[0.232,0.188,0.249,0.307,0.163,0.153,0.139,0.111,0.107,0.745,0.302,0.251,0.148,0.14,0.133,0.487,0.776,0.456,1.419,1.298,0.674,0.398,0.254,0.208,0.158,0.15,0.16,0.126,0.198,0.127,0.129,0.127,0.156,0.134,0.128,0.163,0.155,0.275,0.303,0.227,0.423,1.673,0.586,0.394,0.292,0.236,0.312,0.347,0.477,0.334,0.221,0.395,5.947,5.298,26.239,41.661,12.058,5.169,3.285,2.436,2.122,2.349,2.051,1.827,1.504,1.314,1.195,1.1,1.05,15.584,7.481,4.398,3.155,2.42,2.066,2.248,2.564,2.144,2.07,2.089,4.759,10.144,6.284,4.044,3.228,2.936,2.398,2.125,1.861,3.34,11.946,6.237,4.014,5.17,4.194,3.207,2.666,2.343,1.828,1.617,1.498,1.416,10.329,6.162,3.821,2.969,2.419,2.484,3.732,3.464,2.625,2.339,1.999,1.728,1.576,1.566,17.95,22.143,7.05,4.503,3.385,2.74,2.309,1.958,1.619,1.485,1.433,9.018,30.67,11.413,5.645,3.861,3.092,2.552,2.238,1.955,1.706,1.627,1.523,1.387,1.284,1.202,1.204,1.101,1.024,0.977,1.004,2.793,5.399,3.435,2.377,1.942,1.647,1.46,1.334,1.181,1.072,1.053,1.003,0.945,0.8,0.718,0.701,0.763,0.83,0.866,0.872,0.817,0.795,0.76,0.723,0.694,0.659,0.617,0.603,0.591,0.581,0.595,0.613,0.622,0.639,0.649,0.604,0.618,0.622,0.61,0.6,0.597,0.596,0.593,0.606,0.595,0.559,0.556,0.771,1.816,1.711,1.143,0.941,0.894,0.806,0.768,0.757,0.734,0.769,0.826,0.721,0.667,0.656,0.692,0.69,20.072,35.229,9.098,5.066,3.885,9.084,9.595,5.179,3.889,3.298,3.212,3.847,13.622,10.723,6.062,4.849,3.79,3.125,2.739,2.353,2.129,2.023,1.777,1.673,1.738,1.871,1.821,1.856,2.232,2.573,3.455,3.297,3.201,4.419,7.254,16.446,54.427,33.419,18.191,16.396,10.761,6.962,27.681,11.052,7.386,7.512,6.176,5.309,4.929,10.734,9.581,30.516,11.822,9.907,8.569,5.303,3.948,3.218,2.751,4.437,4.76,3.427,2.813,2.418,2.1,1.835,1.693,1.566,1.452,1.735,9.302,9.21,5.657,5.255,11.735,6.777,8.116,6.566,7.713,7.815,4.795,3.521,3.272,2.736,2.457,1.999,1.396,1.1,0.915,0.892,0.772,0.648,0.427,0.349,0.274,0.234,0.203,0.546,1.285,1.61,3.157,1.357,0.824,0.558,1.021,0.77,0.535,0.334,0.277,1.009,3.865,4.349,2.339,1.856,1.088,0.789,0.595,0.54,0.375,0.5,0.558,0.327,0.349,0.504,0.301,0.521,0.353,0.235,0.25,0.244,0.256,0.18,0.14,0.144,0.184,0.181,0.079,0.078,0.062,0.062,0.067,0.073,0.152,0.085,0.092,0.122,0.167,0.089,0.079,0.087,0.091,0.072,0.076,0.08,0.203,0.149,0.089,0.408,0.259,0.131,0.103,0.557,3.556,6.615,1.895,0.675,0.362,0.217,1.105,8.194,1.687,0.771,0.913,1.363,0.665,70.594,18.438,5.086,2.57,1.608,1.138,0.859,0.843,3.67,8.085,8.756,11.075,4.923,2.704,1.81,1.361,0.95,0.731,2.328,1.913,1.165,0.832,0.646,0.679,0.711,1.704,3.06,4.273,2.37,1.435,0.96,0.768,5.311,11.334,19.193,22.093,13.334,6.617,4.483,3.238,2.459,1.972,1.586,1.343,1.164,1.071,1.604,11.522,14.451,6.472,4.439,3.308,2.774,3.765,2.974,2.471,2.185,1.935,1.848,1.695,1.672,1.744,1.658,1.572,1.672,2.305,2.309,1.937,1.63,1.428,1.289,1.256,1.168,1.034,1.648,2.685,1.767,1.558,1.487,2.145,1.923,2.788,2.057,1.717,1.576,1.396,1.277,1.405,1.286,1.659,3.155,4.457,5.312,3.781,21.773,6.944,4.398,3.367,2.812,2.447,4.378,9.479,4.739,3.551,2.88,2.456,2.178,2.006,3.54,6.687,5.106,3.488,2.621,2.339,2.059,2.409,4.094,3.4,2.582,2.268,2.07,3.854,19.039,6.486,4.18,3.446,3.975,7.375,4.134,2.863,2.456,2.108,1.97,1.774,1.612,1.47,1.312,2.459,1.334,1.131,1.124,1.115,1.122,1.076,0.948,0.893,0.866,0.821,1.25,8.871,3.599,2.392,3.556,3.68,2.474,1.99,1.781,1.997,2.219,1.776,1.627,1.464,1.412,1.338,1.247,1.217,1.146,1.145,1.126,1.16,1.067,0.87,0.784,0.79,0.766,0.76,0.734,0.775,0.798,0.825,0.837,0.856,0.806,0.719,0.695,0.706,0.711,0.699,0.73,0.768,0.787,0.786,1.018,3.463,7.184,3.231,2.489,4.08,12.631,12.704,7.638,6.216,12.118,19.133,16.104,11.335,7.399,5.325,4.083,3.22,3.672,3.335,2.477,2.263,2.204,2.086,3.453,1.992,1.578,1.43,1.358,1.265,1.118,1.013,1.038,1.898,2.095,1.693,1.462,1.294,1.224,1.139,1.117,1.03,0.95,0.927,0.918,1.431,4.066,19.152,9.82,5.496,3.89,6.778,3.972,3.04,2.52,6.379,5.353,4.756,8.827,5.861,4.166,3.317,27.385,18.61,12.629,7.319,4.799,3.597,2.992,13.381,11.137,8.26,5.562,3.95,2.876,2.107,1.972,1.62,1.346,1.715,1.764,1.227,1.001,15.039,12.596,4.444,2.711,20.044,17.601,7.196,4.387,3.801,4.092,3.137,3.226,2.099,1.571,1.681,13.289,5.063,3.035,2.263,1.856,1.359,1.227,0.914,0.658,0.472,0.355,0.29,2.826,2.535,1.636,1.15,0.784,0.507,1.435,0.382,0.246,0.559,0.736,0.457,0.328,0.234,0.175,0.145,0.121,0.104,0.092,0.08,0.072,0.087,0.073,0.113,0.081,0.078,0.074,0.072,0.087,0.255,0.1,0.088,0.194,0.205,0.522,0.356,0.15,0.138,0.316,0.146,0.093,0.163,0.382,0.149,0.098,2.295,28.957,11.403,5.286,2.951,1.67,1.827,1.52,0.972,0.685,0.45,0.301,0.2,0.153,0.11,0.097,0.083,0.108,0.236,1.943,0.609,0.313,0.185,0.165,0.281,0.237,0.533,3.651,1.376,0.739,1.595,2.942,1.283,0.763,0.483,0.341,0.252,0.203,0.175,0.157,18.486,20.958,4.84,2.684,1.988,2.137,1.435,1.15,1.021,0.973,1.533,2.167,1.864,3.319,2.318,4.109,4.352,3.433,2.968,2.786,2.811,2.078,2.304,2.963,2.276,1.91,2.829,2.874,2.651,2.069,1.738,7.919,13.908,6.11,4.052,2.872,2.384,2.038,1.83,1.69,1.554,1.797,17.857,18.49,7.325,4.669,3.419,2.741,2.311,1.972,1.786,1.694,1.548,1.49,1.382,1.308,2.84,2.446,1.901,1.595,1.372,1.194,1.18,1.157,1.104,1.045,1.05,1.014,0.956,0.877,0.804,0.809,0.766,0.722,0.67,1.567,5.631,2.947,4.107,2.723,2.102,1.866,1.662,6.493,7.312,3.684,2.651,2.228,1.883,1.62,1.543,3.026,4.714,2.924,7.174,8.398,4.226,2.967,2.399,2.017,1.9,1.685,1.557,1.457,1.334],"name":"Measured","type":"scatter","mode":"lines","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>NSE in the top 100 runs from a 100,000 run monte carlo</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="modelingcalibration.html#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="co">#the [,-1] drops the first column, which is just row numbers</span></span>
<span id="cb341-2"><a href="modelingcalibration.html#cb341-2" aria-hidden="true" tabindex="-1"></a>pars100 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;HBV/parsFrom100kRun.csv&quot;</span>)[,<span class="sc">-</span><span class="dv">1</span>]</span></code></pre></div>
<pre><code>## Warning: Missing column names filled in: &#39;X1&#39; [1]</code></pre>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   X1 = col_double(),
##   FC = col_double(),
##   beta = col_double(),
##   LP = col_double(),
##   SFCF = col_double(),
##   TT = col_double(),
##   CFMAX = col_double(),
##   k0 = col_double(),
##   k1 = col_double(),
##   k2 = col_double(),
##   UZL = col_double(),
##   PERC = col_double(),
##   MAXBAS = col_double(),
##   NSE = col_double(),
##   ranks = col_double()
## )</code></pre>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="modelingcalibration.html#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pars100, <span class="fu">aes</span>(NSE))<span class="sc">+</span></span>
<span id="cb344-2"><a href="modelingcalibration.html#cb344-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Hydroinformatics_Bookdown_files/figure-html/unnamed-chunk-186-1.png" width="672" /></p>
<p>Show the top 10 parameter sets</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="modelingcalibration.html#cb346-1" aria-hidden="true" tabindex="-1"></a>rankedpars <span class="ot">&lt;-</span> <span class="fu">filter</span>(pars100, ranks <span class="sc">&lt;=</span> <span class="dv">10</span>)</span>
<span id="cb346-2"><a href="modelingcalibration.html#cb346-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-3"><a href="modelingcalibration.html#cb346-3" aria-hidden="true" tabindex="-1"></a>mins <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">1</span>, <span class="fl">0.3</span> , <span class="fl">0.4</span>, <span class="sc">-</span><span class="fl">1.5</span>, <span class="dv">1</span>, <span class="fl">0.05</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb346-4"><a href="modelingcalibration.html#cb346-4" aria-hidden="true" tabindex="-1"></a>maxs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">400</span>, <span class="dv">6</span>, <span class="dv">1</span>, <span class="fl">1.2</span>, <span class="fl">1.2</span>, <span class="dv">8</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.15</span>, <span class="dv">70</span> , <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb346-5"><a href="modelingcalibration.html#cb346-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-6"><a href="modelingcalibration.html#cb346-6" aria-hidden="true" tabindex="-1"></a>rankedpars <span class="ot">&lt;-</span> <span class="fu">rbind</span>(rankedpars, mins, maxs)</span>
<span id="cb346-7"><a href="modelingcalibration.html#cb346-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-8"><a href="modelingcalibration.html#cb346-8" aria-hidden="true" tabindex="-1"></a>rankedpars <span class="ot">&lt;-</span> rankedpars <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">NSE =</span> <span class="fu">as.character</span>(<span class="fu">round</span>(NSE, <span class="dv">2</span>)))</span>
<span id="cb346-9"><a href="modelingcalibration.html#cb346-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-10"><a href="modelingcalibration.html#cb346-10" aria-hidden="true" tabindex="-1"></a>rankedpars<span class="sc">$</span>NSE[rankedpars<span class="sc">$</span>NSE <span class="sc">==</span> <span class="st">&quot;0&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Min/Max&quot;</span></span>
<span id="cb346-11"><a href="modelingcalibration.html#cb346-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-12"><a href="modelingcalibration.html#cb346-12" aria-hidden="true" tabindex="-1"></a>rankedpars <span class="ot">&lt;-</span> rankedpars <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">ranks =</span> <span class="fu">factor</span>(ranks))</span>
<span id="cb346-13"><a href="modelingcalibration.html#cb346-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-14"><a href="modelingcalibration.html#cb346-14" aria-hidden="true" tabindex="-1"></a>rankedpars <span class="sc">%&gt;%</span> <span class="fu">ggparcoord</span>(<span class="at">columns =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>, </span>
<span id="cb346-15"><a href="modelingcalibration.html#cb346-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">groupColumn =</span> <span class="dv">13</span>,</span>
<span id="cb346-16"><a href="modelingcalibration.html#cb346-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">showPoints =</span> <span class="cn">TRUE</span>,</span>
<span id="cb346-17"><a href="modelingcalibration.html#cb346-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">scale =</span> <span class="st">&quot;uniminmax&quot;</span>) <span class="sc">+</span></span>
<span id="cb346-18"><a href="modelingcalibration.html#cb346-18" aria-hidden="true" tabindex="-1"></a>              <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb346-19"><a href="modelingcalibration.html#cb346-19" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ggtitle</span>(<span class="st">&quot;Top 10 parameter sets from 100,000 run Monte Carlo&quot;</span>)<span class="sc">+</span></span>
<span id="cb346-20"><a href="modelingcalibration.html#cb346-20" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ylab</span>(<span class="st">&quot;normalized parameter values&quot;</span>)<span class="sc">+</span></span>
<span id="cb346-21"><a href="modelingcalibration.html#cb346-21" aria-hidden="true" tabindex="-1"></a>              <span class="fu">xlab</span>(<span class="st">&quot;parameters&quot;</span>)</span></code></pre></div>
<p><img src="Hydroinformatics_Bookdown_files/figure-html/unnamed-chunk-187-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelingintro.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Hydroinformatics_Bookdown.pdf", "Hydroinformatics_Bookdown.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
