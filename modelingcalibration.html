<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 18 Intro to Modeling - Calibrate HBV | Hydroinformatics at VT</title>
  <meta name="description" content="This bookdown contains notes and exercises for a course in hydroinformatics at Virginia Tech." />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 18 Intro to Modeling - Calibrate HBV | Hydroinformatics at VT" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This bookdown contains notes and exercises for a course in hydroinformatics at Virginia Tech." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 18 Intro to Modeling - Calibrate HBV | Hydroinformatics at VT" />
  
  <meta name="twitter:description" content="This bookdown contains notes and exercises for a course in hydroinformatics at Virginia Tech." />
  

<meta name="author" content="JP Gannon" />


<meta name="date" content="2023-02-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modelingintro.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>
<script src="libs/rglWebGL-binding-0.109.6/rglWebGL.js"></script>
<link href="libs/rglwidgetClass-0.109.6/rgl.css" rel="stylesheet" />
<script src="libs/rglwidgetClass-0.109.6/rglClass.min.js"></script>
<script type = "text/plain" id = "rgl-vertex-shader">
#line 2 1
// File 1 is the vertex shader
#ifdef GL_ES
#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
#endif

attribute vec3 aPos;
attribute vec4 aCol;
uniform mat4 mvMatrix;
uniform mat4 prMatrix;
varying vec4 vCol;
varying vec4 vPosition;

#ifdef NEEDS_VNORMAL
attribute vec3 aNorm;
uniform mat4 normMatrix;
varying vec4 vNormal;
#endif

#if defined(HAS_TEXTURE) || defined (IS_TEXT)
attribute vec2 aTexcoord;
varying vec2 vTexcoord;
#endif

#ifdef FIXED_SIZE
uniform vec3 textScale;
#endif

#ifdef FIXED_QUADS
attribute vec3 aOfs;
#endif

#ifdef IS_TWOSIDED
#ifdef HAS_NORMALS
varying float normz;
uniform mat4 invPrMatrix;
#else
attribute vec3 aPos1;
attribute vec3 aPos2;
varying float normz;
#endif
#endif // IS_TWOSIDED

#ifdef FAT_LINES
attribute vec3 aNext;
attribute vec2 aPoint;
varying vec2 vPoint;
varying float vLength;
uniform float uAspect;
uniform float uLwd;
#endif


void main(void) {
  
#ifndef IS_BRUSH
#if defined(NCLIPPLANES) || !defined(FIXED_QUADS) || defined(HAS_FOG)
  vPosition = mvMatrix * vec4(aPos, 1.);
#endif
  
#ifndef FIXED_QUADS
  gl_Position = prMatrix * vPosition;
#endif
#endif // !IS_BRUSH
  
#ifdef IS_POINTS
  gl_PointSize = POINTSIZE;
#endif
  
  vCol = aCol;
  
#ifdef NEEDS_VNORMAL
  vNormal = normMatrix * vec4(-aNorm, dot(aNorm, aPos));
#endif
  
#ifdef IS_TWOSIDED
#ifdef HAS_NORMALS
  /* normz should be calculated *after* projection */
  normz = (invPrMatrix*vNormal).z;
#else
  vec4 pos1 = prMatrix*(mvMatrix*vec4(aPos1, 1.));
  pos1 = pos1/pos1.w - gl_Position/gl_Position.w;
  vec4 pos2 = prMatrix*(mvMatrix*vec4(aPos2, 1.));
  pos2 = pos2/pos2.w - gl_Position/gl_Position.w;
  normz = pos1.x*pos2.y - pos1.y*pos2.x;
#endif
#endif // IS_TWOSIDED
  
#ifdef NEEDS_VNORMAL
  vNormal = vec4(normalize(vNormal.xyz/vNormal.w), 1);
#endif
  
#if defined(HAS_TEXTURE) || defined(IS_TEXT)
  vTexcoord = aTexcoord;
#endif
  
#if defined(FIXED_SIZE) && !defined(ROTATING)
  vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);
  pos = pos/pos.w;
  gl_Position = pos + vec4(aOfs*textScale, 0.);
#endif
  
#if defined(IS_SPRITES) && !defined(FIXED_SIZE)
  vec4 pos = mvMatrix * vec4(aPos, 1.);
  pos = pos/pos.w + vec4(aOfs,  0.);
  gl_Position = prMatrix*pos;
#endif
  
#ifdef FAT_LINES
  /* This code was inspired by Matt Deslauriers' code in 
   https://mattdesl.svbtle.com/drawing-lines-is-hard */
  vec2 aspectVec = vec2(uAspect, 1.0);
  mat4 projViewModel = prMatrix * mvMatrix;
  vec4 currentProjected = projViewModel * vec4(aPos, 1.0);
  currentProjected = currentProjected/currentProjected.w;
  vec4 nextProjected = projViewModel * vec4(aNext, 1.0);
  vec2 currentScreen = currentProjected.xy * aspectVec;
  vec2 nextScreen = (nextProjected.xy / nextProjected.w) * aspectVec;
  float len = uLwd;
  vec2 dir = vec2(1.0, 0.0);
  vPoint = aPoint;
  vLength = length(nextScreen - currentScreen)/2.0;
  vLength = vLength/(vLength + len);
  if (vLength > 0.0) {
    dir = normalize(nextScreen - currentScreen);
  }
  vec2 normal = vec2(-dir.y, dir.x);
  dir.x /= uAspect;
  normal.x /= uAspect;
  vec4 offset = vec4(len*(normal*aPoint.x*aPoint.y - dir), 0.0, 0.0);
  gl_Position = currentProjected + offset;
#endif
  
#ifdef IS_BRUSH
  gl_Position = vec4(aPos, 1.);
#endif
}
</script>
<script type = "text/plain" id = "rgl-fragment-shader">
#line 2 2
// File 2 is the fragment shader
#ifdef GL_ES
#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
#endif
varying vec4 vCol; // carries alpha
varying vec4 vPosition;
#if defined(HAS_TEXTURE) || defined (IS_TEXT)
varying vec2 vTexcoord;
uniform sampler2D uSampler;
#endif

#ifdef HAS_FOG
uniform int uFogMode;
uniform vec3 uFogColor;
uniform vec4 uFogParms;
#endif

#if defined(IS_LIT) && !defined(FIXED_QUADS)
varying vec4 vNormal;
#endif

#if NCLIPPLANES > 0
uniform vec4 vClipplane[NCLIPPLANES];
#endif

#if NLIGHTS > 0
uniform mat4 mvMatrix;
#endif

#ifdef IS_LIT
uniform vec3 emission;
uniform float shininess;
#if NLIGHTS > 0
uniform vec3 ambient[NLIGHTS];
uniform vec3 specular[NLIGHTS]; // light*material
uniform vec3 diffuse[NLIGHTS];
uniform vec3 lightDir[NLIGHTS];
uniform bool viewpoint[NLIGHTS];
uniform bool finite[NLIGHTS];
#endif
#endif // IS_LIT

#ifdef IS_TWOSIDED
uniform bool front;
varying float normz;
#endif

#ifdef FAT_LINES
varying vec2 vPoint;
varying float vLength;
#endif

void main(void) {
  vec4 fragColor;
#ifdef FAT_LINES
  vec2 point = vPoint;
  bool neg = point.y < 0.0;
  point.y = neg ? (point.y + vLength)/(1.0 - vLength) :
                 -(point.y - vLength)/(1.0 - vLength);
#if defined(IS_TRANSPARENT) && defined(IS_LINESTRIP)
  if (neg && length(point) <= 1.0) discard;
#endif
  point.y = min(point.y, 0.0);
  if (length(point) > 1.0) discard;
#endif // FAT_LINES
  
#ifdef ROUND_POINTS
  vec2 coord = gl_PointCoord - vec2(0.5);
  if (length(coord) > 0.5) discard;
#endif
  
#if NCLIPPLANES > 0
  for (int i = 0; i < NCLIPPLANES; i++)
    if (dot(vPosition, vClipplane[i]) < 0.0) discard;
#endif
    
#ifdef FIXED_QUADS
    vec3 n = vec3(0., 0., 1.);
#elif defined(IS_LIT)
    vec3 n = normalize(vNormal.xyz);
#endif
    
#ifdef IS_TWOSIDED
    if ((normz <= 0.) != front) discard;
#endif
    
#ifdef IS_LIT
    vec3 eye = normalize(-vPosition.xyz/vPosition.w);
    vec3 lightdir;
    vec4 colDiff;
    vec3 halfVec;
    vec4 lighteffect = vec4(emission, 0.);
    vec3 col;
    float nDotL;
#ifdef FIXED_QUADS
    n = -faceforward(n, n, eye);
#endif
    
#if NLIGHTS > 0
    for (int i=0;i<NLIGHTS;i++) {
      colDiff = vec4(vCol.rgb * diffuse[i], vCol.a);
      lightdir = lightDir[i];
      if (!viewpoint[i])
        lightdir = (mvMatrix * vec4(lightdir, 1.)).xyz;
      if (!finite[i]) {
        halfVec = normalize(lightdir + eye);
      } else {
        lightdir = normalize(lightdir - vPosition.xyz/vPosition.w);
        halfVec = normalize(lightdir + eye);
      }
      col = ambient[i];
      nDotL = dot(n, lightdir);
      col = col + max(nDotL, 0.) * colDiff.rgb;
      col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular[i];
      lighteffect = lighteffect + vec4(col, colDiff.a);
    }
#endif
    
#else // not IS_LIT
    vec4 colDiff = vCol;
    vec4 lighteffect = colDiff;
#endif
    
#ifdef IS_TEXT
    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);
#endif
    
#ifdef HAS_TEXTURE
#ifdef TEXTURE_rgb
    vec4 textureColor = lighteffect*vec4(texture2D(uSampler, vTexcoord).rgb, 1.);
#endif
    
#ifdef TEXTURE_rgba
    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);
#endif
    
#ifdef TEXTURE_alpha
    vec4 textureColor = texture2D(uSampler, vTexcoord);
    float luminance = dot(vec3(1.,1.,1.), textureColor.rgb)/3.;
    textureColor =  vec4(lighteffect.rgb, lighteffect.a*luminance);
#endif
    
#ifdef TEXTURE_luminance
    vec4 textureColor = vec4(lighteffect.rgb*dot(texture2D(uSampler, vTexcoord).rgb, vec3(1.,1.,1.))/3., lighteffect.a);
#endif
    
#ifdef TEXTURE_luminance_alpha
    vec4 textureColor = texture2D(uSampler, vTexcoord);
    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;
    textureColor = vec4(lighteffect.rgb*luminance, lighteffect.a*textureColor.a);
#endif
    
    fragColor = textureColor;

#elif defined(IS_TEXT)
    if (textureColor.a < 0.1)
      discard;
    else
      fragColor = textureColor;
#else
    fragColor = lighteffect;
#endif // HAS_TEXTURE
    
#ifdef HAS_FOG
    // uFogParms elements: x = near, y = far, z = fogscale, w = (1-sin(FOV/2))/(1+sin(FOV/2))
    // In Exp and Exp2: use density = density/far
    // fogF will be the proportion of fog
    // Initialize it to the linear value
    float fogF;
    if (uFogMode > 0) {
      fogF = (uFogParms.y - vPosition.z/vPosition.w)/(uFogParms.y - uFogParms.x);
      if (uFogMode > 1)
        fogF = mix(uFogParms.w, 1.0, fogF);
      fogF = fogF*uFogParms.z;
      if (uFogMode == 2)
        fogF = 1.0 - exp(-fogF);
      // Docs are wrong: use (density*c)^2, not density*c^2
      // https://gitlab.freedesktop.org/mesa/mesa/-/blob/master/src/mesa/swrast/s_fog.c#L58
      else if (uFogMode == 3)
        fogF = 1.0 - exp(-fogF*fogF);
      fogF = clamp(fogF, 0.0, 1.0);
      gl_FragColor = vec4(mix(fragColor.rgb, uFogColor, fogF), fragColor.a);
    } else gl_FragColor = fragColor;
#else
    gl_FragColor = fragColor;
#endif // HAS_FOG
    
}
</script>
<script src="libs/CanvasMatrix4-0.109.6/CanvasMatrix.min.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GBDXSZFFSR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-GBDXSZFFSR');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Hydroinformatics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.0.1" data-path="index.html"><a href="index.html#to-help-me-keep-get-an-idea-of-who-is-using-this-resource-so-i-can-improve-it-in-the-future-please-consider-filling-out-any-or-all-of-this-survey-httpsforms.gle6zcntzvr1wzzuh6s7-thanks"><i class="fa fa-check"></i><b>1.0.1</b> To help me keep get an idea of who is using this resource so I can improve it in the future, please consider filling out any or all of this survey: https://forms.gle/6Zcntzvr1wZZUh6S7 Thanks!</a></li>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#how-to-use-these-materials"><i class="fa fa-check"></i><b>1.1</b> How to use these materials</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#table-of-contents"><i class="fa fa-check"></i><b>1.2</b> Table of contents:</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Plotting.html"><a href="Plotting.html"><i class="fa fa-check"></i><b>2</b> Intro to Plotting</a>
<ul>
<li class="chapter" data-level="2.1" data-path="Plotting.html"><a href="Plotting.html#download-and-install-tidyverse-library"><i class="fa fa-check"></i><b>2.1</b> Download and install tidyverse library</a></li>
<li class="chapter" data-level="2.2" data-path="Plotting.html"><a href="Plotting.html#reading-data"><i class="fa fa-check"></i><b>2.2</b> Reading data</a></li>
<li class="chapter" data-level="2.3" data-path="Plotting.html"><a href="Plotting.html#our-first-ggplot"><i class="fa fa-check"></i><b>2.3</b> Our first ggplot</a></li>
<li class="chapter" data-level="2.4" data-path="Plotting.html"><a href="Plotting.html#change-point-type"><i class="fa fa-check"></i><b>2.4</b> Change point type</a></li>
<li class="chapter" data-level="2.5" data-path="Plotting.html"><a href="Plotting.html#set-colors"><i class="fa fa-check"></i><b>2.5</b> Set colors</a></li>
<li class="chapter" data-level="2.6" data-path="Plotting.html"><a href="Plotting.html#controlling-color-with-a-third-variable-and-other-functions"><i class="fa fa-check"></i><b>2.6</b> Controlling color with a third variable and other functions</a></li>
<li class="chapter" data-level="2.7" data-path="Plotting.html"><a href="Plotting.html#plotting-multiple-groups"><i class="fa fa-check"></i><b>2.7</b> Plotting multiple groups</a></li>
<li class="chapter" data-level="2.8" data-path="Plotting.html"><a href="Plotting.html#facets"><i class="fa fa-check"></i><b>2.8</b> Facets</a></li>
<li class="chapter" data-level="2.9" data-path="Plotting.html"><a href="Plotting.html#two-variable-faceting"><i class="fa fa-check"></i><b>2.9</b> Two variable faceting</a></li>
<li class="chapter" data-level="2.10" data-path="Plotting.html"><a href="Plotting.html#boxplots"><i class="fa fa-check"></i><b>2.10</b> Boxplots</a></li>
<li class="chapter" data-level="2.11" data-path="Plotting.html"><a href="Plotting.html#more-about-color-size-etc"><i class="fa fa-check"></i><b>2.11</b> More about color, size, etc</a></li>
<li class="chapter" data-level="2.12" data-path="Plotting.html"><a href="Plotting.html#multiple-geoms"><i class="fa fa-check"></i><b>2.12</b> Multiple geoms</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Programming.html"><a href="Programming.html"><i class="fa fa-check"></i><b>3</b> R Tidyverse Programming Basics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="Programming.html"><a href="Programming.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="Programming.html"><a href="Programming.html#you-can-use-r-as-a-calculator"><i class="fa fa-check"></i><b>3.2</b> You can use R as a calculator</a></li>
<li class="chapter" data-level="3.3" data-path="Programming.html"><a href="Programming.html#you-can-create-new-objects-using--"><i class="fa fa-check"></i><b>3.3</b> You can create new objects using &lt;-</a></li>
<li class="chapter" data-level="3.4" data-path="Programming.html"><a href="Programming.html#using-functions"><i class="fa fa-check"></i><b>3.4</b> Using functions</a></li>
<li class="chapter" data-level="3.5" data-path="Programming.html"><a href="Programming.html#read-in-some-data."><i class="fa fa-check"></i><b>3.5</b> Read in some data.</a></li>
<li class="chapter" data-level="3.6" data-path="Programming.html"><a href="Programming.html#wait-hold-up.-what-is-a-tibble"><i class="fa fa-check"></i><b>3.6</b> Wait, hold up. What is a tibble?</a></li>
<li class="chapter" data-level="3.7" data-path="Programming.html"><a href="Programming.html#data-wrangling-in-dplyr"><i class="fa fa-check"></i><b>3.7</b> Data wrangling in dplyr</a></li>
<li class="chapter" data-level="3.8" data-path="Programming.html"><a href="Programming.html#filter"><i class="fa fa-check"></i><b>3.8</b> Filter</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="Programming.html"><a href="Programming.html#multiple-conditions"><i class="fa fa-check"></i><b>3.8.1</b> Multiple conditions</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="Programming.html"><a href="Programming.html#arrange"><i class="fa fa-check"></i><b>3.9</b> Arrange</a></li>
<li class="chapter" data-level="3.10" data-path="Programming.html"><a href="Programming.html#select"><i class="fa fa-check"></i><b>3.10</b> Select</a></li>
<li class="chapter" data-level="3.11" data-path="Programming.html"><a href="Programming.html#mutate"><i class="fa fa-check"></i><b>3.11</b> Mutate</a></li>
<li class="chapter" data-level="3.12" data-path="Programming.html"><a href="Programming.html#summarize"><i class="fa fa-check"></i><b>3.12</b> Summarize</a></li>
<li class="chapter" data-level="3.13" data-path="Programming.html"><a href="Programming.html#multiple-operations-with-pipes"><i class="fa fa-check"></i><b>3.13</b> Multiple operations with pipes</a>
<ul>
<li class="chapter" data-level="3.13.1" data-path="Programming.html"><a href="Programming.html#lets-say-we-want-to-tell-r-to-make-a-pbj-sandwich-by-using-the-pbbread-jbread-and-joinslices-functions-and-the-data-ingredients.-if-we-do-this-saving-each-step-if-would-look-like-this"><i class="fa fa-check"></i><b>3.13.1</b> Let’s say we want to tell R to make a PB&amp;J sandwich by using the pbbread(), jbread(), and joinslices() functions and the data “ingredients”. If we do this saving each step if would look like this:</a></li>
<li class="chapter" data-level="3.13.2" data-path="Programming.html"><a href="Programming.html#if-we-nest-the-functions-together-we-get-this"><i class="fa fa-check"></i><b>3.13.2</b> If we nest the functions together we get this</a></li>
<li class="chapter" data-level="3.13.3" data-path="Programming.html"><a href="Programming.html#using-the-pipe-it-would-look-like-this"><i class="fa fa-check"></i><b>3.13.3</b> Using the pipe it would look like this</a></li>
<li class="chapter" data-level="3.13.4" data-path="Programming.html"><a href="Programming.html#when-you-use-the-pipe-it-basically-takes-whatever-came-out-of-the-first-function-and-puts-it-into-the-data-argument-for-the-next-one"><i class="fa fa-check"></i><b>3.13.4</b> When you use the pipe, it basically takes whatever came out of the first function and puts it into the data argument for the next one</a></li>
</ul></li>
<li class="chapter" data-level="3.14" data-path="Programming.html"><a href="Programming.html#save-your-results-to-a-new-tibble"><i class="fa fa-check"></i><b>3.14</b> Save your results to a new tibble</a></li>
<li class="chapter" data-level="3.15" data-path="Programming.html"><a href="Programming.html#what-about-nas"><i class="fa fa-check"></i><b>3.15</b> What about NAs?</a></li>
<li class="chapter" data-level="3.16" data-path="Programming.html"><a href="Programming.html#what-are-some-things-you-think-ill-ask-you-to-do-for-the-activity-next-class"><i class="fa fa-check"></i><b>3.16</b> What are some things you think I’ll ask you to do for the activity next class?</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introactivity.html"><a href="introactivity.html"><i class="fa fa-check"></i><b>4</b> ACTIVITY Intro Skills</a>
<ul>
<li class="chapter" data-level="4.1" data-path="introactivity.html"><a href="introactivity.html#problem-1"><i class="fa fa-check"></i><b>4.1</b> Problem 1</a></li>
<li class="chapter" data-level="4.2" data-path="introactivity.html"><a href="introactivity.html#problem-2"><i class="fa fa-check"></i><b>4.2</b> Problem 2</a></li>
<li class="chapter" data-level="4.3" data-path="introactivity.html"><a href="introactivity.html#problem-3"><i class="fa fa-check"></i><b>4.3</b> Problem 3</a></li>
<li class="chapter" data-level="4.4" data-path="introactivity.html"><a href="introactivity.html#problem-4"><i class="fa fa-check"></i><b>4.4</b> Problem 4</a></li>
<li class="chapter" data-level="4.5" data-path="introactivity.html"><a href="introactivity.html#problem-5"><i class="fa fa-check"></i><b>4.5</b> Problem 5</a></li>
<li class="chapter" data-level="4.6" data-path="introactivity.html"><a href="introactivity.html#problem-6"><i class="fa fa-check"></i><b>4.6</b> Problem 6</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="stats.html"><a href="stats.html"><i class="fa fa-check"></i><b>5</b> Introduction to Basic Statistics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="stats.html"><a href="stats.html#reading-for-this-section-statistical-methods-in-water-resources-chapter-1"><i class="fa fa-check"></i><b>5.1</b> Reading for this section: Statistical Methods in Water Resources: Chapter 1</a></li>
<li class="chapter" data-level="5.2" data-path="stats.html"><a href="stats.html#questions-for-today"><i class="fa fa-check"></i><b>5.2</b> Questions for today:</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="stats.html"><a href="stats.html#stack-plots-to-compare-histogram-and-pdf"><i class="fa fa-check"></i><b>5.2.1</b> Stack plots to compare histogram and pdf</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="stats.html"><a href="stats.html#what-is-the-difference-between-a-sample-and-a-population."><i class="fa fa-check"></i><b>5.3</b> What is the difference between a sample and a population.</a></li>
<li class="chapter" data-level="5.4" data-path="stats.html"><a href="stats.html#measuring-our-sample-distribution-central-tendency."><i class="fa fa-check"></i><b>5.4</b> Measuring our sample distribution: central tendency.</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="stats.html"><a href="stats.html#so-whats-a-weighted-average"><i class="fa fa-check"></i><b>5.4.1</b> So what’s a weighted average?</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="stats.html"><a href="stats.html#measures-of-variability"><i class="fa fa-check"></i><b>5.5</b> Measures of variability</a></li>
<li class="chapter" data-level="5.6" data-path="stats.html"><a href="stats.html#what-is-a-normal-distribution-and-how-can-we-determine-if-we-have-one"><i class="fa fa-check"></i><b>5.6</b> What is a normal distribution and how can we determine if we have one?</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="statsactivity.html"><a href="statsactivity.html"><i class="fa fa-check"></i><b>6</b> ACTIVITY Intro Stats</a>
<ul>
<li class="chapter" data-level="6.1" data-path="statsactivity.html"><a href="statsactivity.html#problem-1-1"><i class="fa fa-check"></i><b>6.1</b> Problem 1</a></li>
<li class="chapter" data-level="6.2" data-path="statsactivity.html"><a href="statsactivity.html#problem-2-1"><i class="fa fa-check"></i><b>6.2</b> Problem 2</a></li>
<li class="chapter" data-level="6.3" data-path="statsactivity.html"><a href="statsactivity.html#problem-3-1"><i class="fa fa-check"></i><b>6.3</b> Problem 3</a></li>
<li class="chapter" data-level="6.4" data-path="statsactivity.html"><a href="statsactivity.html#problem-4-1"><i class="fa fa-check"></i><b>6.4</b> Problem 4</a></li>
<li class="chapter" data-level="6.5" data-path="statsactivity.html"><a href="statsactivity.html#problem-5-1"><i class="fa fa-check"></i><b>6.5</b> Problem 5</a></li>
<li class="chapter" data-level="6.6" data-path="statsactivity.html"><a href="statsactivity.html#problem-6-1"><i class="fa fa-check"></i><b>6.6</b> Problem 6</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="getdata.html"><a href="getdata.html"><i class="fa fa-check"></i><b>7</b> Joins, Pivots, and USGS dataRetrieval</a>
<ul>
<li class="chapter" data-level="7.1" data-path="getdata.html"><a href="getdata.html#goals-for-today"><i class="fa fa-check"></i><b>7.1</b> Goals for today</a></li>
<li class="chapter" data-level="7.2" data-path="getdata.html"><a href="getdata.html#exploring-what-dataretrieval-can-do."><i class="fa fa-check"></i><b>7.2</b> Exploring what dataRetrieval can do.</a></li>
<li class="chapter" data-level="7.3" data-path="getdata.html"><a href="getdata.html#joins"><i class="fa fa-check"></i><b>7.3</b> Joins</a></li>
<li class="chapter" data-level="7.4" data-path="getdata.html"><a href="getdata.html#join-example"><i class="fa fa-check"></i><b>7.4</b> Join example</a></li>
<li class="chapter" data-level="7.5" data-path="getdata.html"><a href="getdata.html#finding-ids-to-download-usgs-data"><i class="fa fa-check"></i><b>7.5</b> Finding IDs to download USGS data</a></li>
<li class="chapter" data-level="7.6" data-path="getdata.html"><a href="getdata.html#ok-lets-download-some-data"><i class="fa fa-check"></i><b>7.6</b> OK let’s download some data!</a></li>
<li class="chapter" data-level="7.7" data-path="getdata.html"><a href="getdata.html#pivoting-wide-and-long-data"><i class="fa fa-check"></i><b>7.7</b> Pivoting: wide and long data</a></li>
<li class="chapter" data-level="7.8" data-path="getdata.html"><a href="getdata.html#pivot-examples"><i class="fa fa-check"></i><b>7.8</b> Pivot Examples</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="joinpivotDR.html"><a href="joinpivotDR.html"><i class="fa fa-check"></i><b>8</b> ACTIVITY Joins Pivots dataRetrieval</a>
<ul>
<li class="chapter" data-level="8.1" data-path="joinpivotDR.html"><a href="joinpivotDR.html#load-the-tidyverse-dataretrieval-and-patchwork-packages."><i class="fa fa-check"></i><b>8.1</b> Load the tidyverse, dataRetrieval, and patchwork packages.</a></li>
<li class="chapter" data-level="8.2" data-path="joinpivotDR.html"><a href="joinpivotDR.html#problem-1-2"><i class="fa fa-check"></i><b>8.2</b> Problem 1</a></li>
<li class="chapter" data-level="8.3" data-path="joinpivotDR.html"><a href="joinpivotDR.html#problem-2-2"><i class="fa fa-check"></i><b>8.3</b> Problem 2</a></li>
<li class="chapter" data-level="8.4" data-path="joinpivotDR.html"><a href="joinpivotDR.html#problem-3-2"><i class="fa fa-check"></i><b>8.4</b> Problem 3</a></li>
<li class="chapter" data-level="8.5" data-path="joinpivotDR.html"><a href="joinpivotDR.html#problem-4-2"><i class="fa fa-check"></i><b>8.5</b> Problem 4</a></li>
<li class="chapter" data-level="8.6" data-path="joinpivotDR.html"><a href="joinpivotDR.html#problem-5-2"><i class="fa fa-check"></i><b>8.6</b> Problem 5</a></li>
<li class="chapter" data-level="8.7" data-path="joinpivotDR.html"><a href="joinpivotDR.html#problem-6-2"><i class="fa fa-check"></i><b>8.7</b> Problem 6</a></li>
<li class="chapter" data-level="8.8" data-path="joinpivotDR.html"><a href="joinpivotDR.html#problem-7"><i class="fa fa-check"></i><b>8.8</b> Problem 7</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Summative1.html"><a href="Summative1.html"><i class="fa fa-check"></i><b>9</b> ACTIVITY Summative 1</a>
<ul>
<li class="chapter" data-level="9.0.1" data-path="Summative1.html"><a href="Summative1.html#instructions"><i class="fa fa-check"></i><b>9.0.1</b> Instructions</a></li>
<li class="chapter" data-level="9.1" data-path="Summative1.html"><a href="Summative1.html#problem-1-3"><i class="fa fa-check"></i><b>9.1</b> Problem 1</a></li>
<li class="chapter" data-level="9.2" data-path="Summative1.html"><a href="Summative1.html#problem-2-3"><i class="fa fa-check"></i><b>9.2</b> Problem 2</a></li>
<li class="chapter" data-level="9.3" data-path="Summative1.html"><a href="Summative1.html#problem-3-3"><i class="fa fa-check"></i><b>9.3</b> Problem 3</a></li>
<li class="chapter" data-level="9.4" data-path="Summative1.html"><a href="Summative1.html#problem-4-3"><i class="fa fa-check"></i><b>9.4</b> Problem 4</a></li>
<li class="chapter" data-level="9.5" data-path="Summative1.html"><a href="Summative1.html#problem-5-3"><i class="fa fa-check"></i><b>9.5</b> Problem 5</a></li>
<li class="chapter" data-level="9.6" data-path="Summative1.html"><a href="Summative1.html#problem-6-3"><i class="fa fa-check"></i><b>9.6</b> Problem 6</a></li>
<li class="chapter" data-level="9.7" data-path="Summative1.html"><a href="Summative1.html#problem-7-1"><i class="fa fa-check"></i><b>9.7</b> Problem 7</a></li>
<li class="chapter" data-level="9.8" data-path="Summative1.html"><a href="Summative1.html#problem-8"><i class="fa fa-check"></i><b>9.8</b> Problem 8</a></li>
<li class="chapter" data-level="9.9" data-path="Summative1.html"><a href="Summative1.html#problem-9"><i class="fa fa-check"></i><b>9.9</b> Problem 9</a></li>
<li class="chapter" data-level="9.10" data-path="Summative1.html"><a href="Summative1.html#problem-10"><i class="fa fa-check"></i><b>9.10</b> Problem 10</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="fdcs.html"><a href="fdcs.html"><i class="fa fa-check"></i><b>10</b> Flow Duration Curves</a>
<ul>
<li class="chapter" data-level="10.1" data-path="fdcs.html"><a href="fdcs.html#get-data"><i class="fa fa-check"></i><b>10.1</b> Get data</a></li>
<li class="chapter" data-level="10.2" data-path="fdcs.html"><a href="fdcs.html#review-describe-the-distribution"><i class="fa fa-check"></i><b>10.2</b> Review: describe the distribution</a></li>
<li class="chapter" data-level="10.3" data-path="fdcs.html"><a href="fdcs.html#ecdfs"><i class="fa fa-check"></i><b>10.3</b> ECDFs</a></li>
<li class="chapter" data-level="10.4" data-path="fdcs.html"><a href="fdcs.html#calculate-flow-exceedence-probabilities"><i class="fa fa-check"></i><b>10.4</b> Calculate flow exceedence probabilities</a></li>
<li class="chapter" data-level="10.5" data-path="fdcs.html"><a href="fdcs.html#plot-a-flow-duration-curve-using-the-probabilities"><i class="fa fa-check"></i><b>10.5</b> Plot a Flow Duration Curve using the probabilities</a></li>
<li class="chapter" data-level="10.6" data-path="fdcs.html"><a href="fdcs.html#make-an-almost-fdc-with-stat_ecdf"><i class="fa fa-check"></i><b>10.6</b> Make an almost FDC with stat_ecdf</a></li>
<li class="chapter" data-level="10.7" data-path="fdcs.html"><a href="fdcs.html#example-use-of-an-fdc"><i class="fa fa-check"></i><b>10.7</b> Example use of an FDC</a></li>
<li class="chapter" data-level="10.8" data-path="fdcs.html"><a href="fdcs.html#compare-to-a-boxplot-of-the-same-data"><i class="fa fa-check"></i><b>10.8</b> Compare to a boxplot of the same data</a></li>
<li class="chapter" data-level="10.9" data-path="fdcs.html"><a href="fdcs.html#challenge-examining-flow-regime-change-at-the-grand-canyon"><i class="fa fa-check"></i><b>10.9</b> Challenge: Examining flow regime change at the Grand Canyon</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="lfas.html"><a href="lfas.html"><i class="fa fa-check"></i><b>11</b> Low Flow Analysis</a>
<ul>
<li class="chapter" data-level="11.1" data-path="lfas.html"><a href="lfas.html#what-are-low-flow-statistics"><i class="fa fa-check"></i><b>11.1</b> What are low flow statistics?</a></li>
<li class="chapter" data-level="11.2" data-path="lfas.html"><a href="lfas.html#get-data-1"><i class="fa fa-check"></i><b>11.2</b> Get data</a></li>
<li class="chapter" data-level="11.3" data-path="lfas.html"><a href="lfas.html#create-the-x-days-average-flow-record"><i class="fa fa-check"></i><b>11.3</b> Create the X days average flow record</a></li>
<li class="chapter" data-level="11.4" data-path="lfas.html"><a href="lfas.html#look-at-what-a-rolling-mean-does."><i class="fa fa-check"></i><b>11.4</b> Look at what a rolling mean does.</a></li>
<li class="chapter" data-level="11.5" data-path="lfas.html"><a href="lfas.html#calculate-yearly-minimums"><i class="fa fa-check"></i><b>11.5</b> Calculate yearly minimums</a></li>
<li class="chapter" data-level="11.6" data-path="lfas.html"><a href="lfas.html#calculate-return-interval"><i class="fa fa-check"></i><b>11.6</b> Calculate return interval</a></li>
<li class="chapter" data-level="11.7" data-path="lfas.html"><a href="lfas.html#fit-to-pearson-type-iii-distribution"><i class="fa fa-check"></i><b>11.7</b> Fit to Pearson Type III distribution</a></li>
<li class="chapter" data-level="11.8" data-path="lfas.html"><a href="lfas.html#distribution-free-method"><i class="fa fa-check"></i><b>11.8</b> Distribution-free method</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="floods.html"><a href="floods.html"><i class="fa fa-check"></i><b>12</b> Flood Frequency Analysis and Creating Functions</a>
<ul>
<li class="chapter" data-level="12.1" data-path="floods.html"><a href="floods.html#template-repository"><i class="fa fa-check"></i><b>12.1</b> Template Repository</a></li>
<li class="chapter" data-level="12.2" data-path="floods.html"><a href="floods.html#intro"><i class="fa fa-check"></i><b>12.2</b> Intro</a></li>
<li class="chapter" data-level="12.3" data-path="floods.html"><a href="floods.html#challenge-create-a-function"><i class="fa fa-check"></i><b>12.3</b> Challenge: Create a function</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="rgeospatial.html"><a href="rgeospatial.html"><i class="fa fa-check"></i><b>13</b> Geospatial data in R - Vector</a>
<ul>
<li class="chapter" data-level="13.1" data-path="rgeospatial.html"><a href="rgeospatial.html#goals"><i class="fa fa-check"></i><b>13.1</b> Goals</a></li>
<li class="chapter" data-level="13.2" data-path="rgeospatial.html"><a href="rgeospatial.html#intro-to-tmap"><i class="fa fa-check"></i><b>13.2</b> Intro to tmap</a></li>
<li class="chapter" data-level="13.3" data-path="rgeospatial.html"><a href="rgeospatial.html#data-wrangling-with-tidyverse-principles"><i class="fa fa-check"></i><b>13.3</b> Data wrangling with tidyverse principles</a></li>
<li class="chapter" data-level="13.4" data-path="rgeospatial.html"><a href="rgeospatial.html#add-non-spatial-data-to-spatial-data-with-a-join"><i class="fa fa-check"></i><b>13.4</b> Add non-spatial data to spatial data with a join</a></li>
<li class="chapter" data-level="13.5" data-path="rgeospatial.html"><a href="rgeospatial.html#plot-maps-side-by-side"><i class="fa fa-check"></i><b>13.5</b> Plot maps side by side</a></li>
<li class="chapter" data-level="13.6" data-path="rgeospatial.html"><a href="rgeospatial.html#built-in-styles-like-themes-in-ggplot"><i class="fa fa-check"></i><b>13.6</b> Built in styles, like themes in ggplot</a></li>
<li class="chapter" data-level="13.7" data-path="rgeospatial.html"><a href="rgeospatial.html#interactive-maps"><i class="fa fa-check"></i><b>13.7</b> Interactive Maps</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="rgeospatial.html"><a href="rgeospatial.html#tmap"><i class="fa fa-check"></i><b>13.7.1</b> tmap</a></li>
<li class="chapter" data-level="13.7.2" data-path="rgeospatial.html"><a href="rgeospatial.html#leaflet"><i class="fa fa-check"></i><b>13.7.2</b> Leaflet</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="summative2.html"><a href="summative2.html"><i class="fa fa-check"></i><b>14</b> Summative Assessment 2</a>
<ul>
<li class="chapter" data-level="14.1" data-path="summative2.html"><a href="summative2.html#info-for-assessment"><i class="fa fa-check"></i><b>14.1</b> Info for assessment</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="rgeoraster.html"><a href="rgeoraster.html"><i class="fa fa-check"></i><b>15</b> Geospatial R Raster - Hydro Analyses</a>
<ul>
<li class="chapter" data-level="15.1" data-path="rgeoraster.html"><a href="rgeoraster.html#introduction-2"><i class="fa fa-check"></i><b>15.1</b> Introduction</a></li>
<li class="chapter" data-level="15.2" data-path="rgeoraster.html"><a href="rgeoraster.html#read-in-dem"><i class="fa fa-check"></i><b>15.2</b> Read in DEM</a></li>
<li class="chapter" data-level="15.3" data-path="rgeoraster.html"><a href="rgeoraster.html#plot-dem"><i class="fa fa-check"></i><b>15.3</b> Plot DEM</a></li>
<li class="chapter" data-level="15.4" data-path="rgeoraster.html"><a href="rgeoraster.html#generate-a-hillshade"><i class="fa fa-check"></i><b>15.4</b> Generate a hillshade</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="rgeoraster.html"><a href="rgeoraster.html#how-whitebox-tools-functions-work"><i class="fa fa-check"></i><b>15.4.1</b> How whitebox tools functions work</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="rgeoraster.html"><a href="rgeoraster.html#prepare-dem-for-hydrology-analyses"><i class="fa fa-check"></i><b>15.5</b> Prepare DEM for Hydrology Analyses</a></li>
<li class="chapter" data-level="15.6" data-path="rgeoraster.html"><a href="rgeoraster.html#visualize-filled-sinks-and-breached-depressions"><i class="fa fa-check"></i><b>15.6</b> Visualize filled sinks and breached depressions</a></li>
<li class="chapter" data-level="15.7" data-path="rgeoraster.html"><a href="rgeoraster.html#d8-flow-accumulation"><i class="fa fa-check"></i><b>15.7</b> D8 Flow Accumulation</a></li>
<li class="chapter" data-level="15.8" data-path="rgeoraster.html"><a href="rgeoraster.html#d-infinity-flow-accumulation"><i class="fa fa-check"></i><b>15.8</b> D infinity flow accumulation</a></li>
<li class="chapter" data-level="15.9" data-path="rgeoraster.html"><a href="rgeoraster.html#topographic-wetness-index"><i class="fa fa-check"></i><b>15.9</b> Topographic Wetness Index</a></li>
<li class="chapter" data-level="15.10" data-path="rgeoraster.html"><a href="rgeoraster.html#downslope-twi"><i class="fa fa-check"></i><b>15.10</b> Downslope TWI</a></li>
<li class="chapter" data-level="15.11" data-path="rgeoraster.html"><a href="rgeoraster.html#map-stream-network"><i class="fa fa-check"></i><b>15.11</b> Map Stream Network</a></li>
<li class="chapter" data-level="15.12" data-path="rgeoraster.html"><a href="rgeoraster.html#extract-raster-values-to-point-locations"><i class="fa fa-check"></i><b>15.12</b> Extract raster values to point locations</a>
<ul>
<li class="chapter" data-level="15.12.1" data-path="rgeoraster.html"><a href="rgeoraster.html#import-and-plot-points"><i class="fa fa-check"></i><b>15.12.1</b> Import and plot points</a></li>
<li class="chapter" data-level="15.12.2" data-path="rgeoraster.html"><a href="rgeoraster.html#extract-values-from-multiple-rasters-at-once"><i class="fa fa-check"></i><b>15.12.2</b> Extract values from multiple rasters at once</a></li>
</ul></li>
<li class="chapter" data-level="15.13" data-path="rgeoraster.html"><a href="rgeoraster.html#view-raster-data-as-a-pdf-or-histogram"><i class="fa fa-check"></i><b>15.13</b> View raster data as a PDF or histogram</a></li>
<li class="chapter" data-level="15.14" data-path="rgeoraster.html"><a href="rgeoraster.html#subsetting-a-raster-for-visualization"><i class="fa fa-check"></i><b>15.14</b> Subsetting a raster for visualization</a></li>
<li class="chapter" data-level="15.15" data-path="rgeoraster.html"><a href="rgeoraster.html#raster-math"><i class="fa fa-check"></i><b>15.15</b> Raster Math</a></li>
<li class="chapter" data-level="15.16" data-path="rgeoraster.html"><a href="rgeoraster.html#extra-plot-topo-characteristics-against-one-another"><i class="fa fa-check"></i><b>15.16</b> Extra: plot topo characteristics against one another</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html"><i class="fa fa-check"></i><b>16</b> Geospatial R Raster - Watershed Delineation</a>
<ul>
<li class="chapter" data-level="16.1" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#introduction-3"><i class="fa fa-check"></i><b>16.1</b> Introduction</a></li>
<li class="chapter" data-level="16.2" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#the-watershed-delineation-toolprocess"><i class="fa fa-check"></i><b>16.2</b> The watershed delineation tool/process</a></li>
<li class="chapter" data-level="16.3" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#read-in-dem-1"><i class="fa fa-check"></i><b>16.3</b> Read in DEM</a></li>
<li class="chapter" data-level="16.4" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#generate-a-hillshade-1"><i class="fa fa-check"></i><b>16.4</b> Generate a hillshade</a></li>
<li class="chapter" data-level="16.5" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#prepare-dem-for-hydrology-analyses-1"><i class="fa fa-check"></i><b>16.5</b> Prepare DEM for Hydrology Analyses</a></li>
<li class="chapter" data-level="16.6" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#create-flow-accumulation-and-pointer-grids"><i class="fa fa-check"></i><b>16.6</b> Create flow accumulation and pointer grids</a></li>
<li class="chapter" data-level="16.7" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#setting-pour-points"><i class="fa fa-check"></i><b>16.7</b> Setting pour points</a></li>
<li class="chapter" data-level="16.8" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#delineate-watersheds"><i class="fa fa-check"></i><b>16.8</b> Delineate watersheds</a></li>
<li class="chapter" data-level="16.9" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#convert-watersheds-to-shapefiles"><i class="fa fa-check"></i><b>16.9</b> Convert watersheds to shapefiles</a></li>
<li class="chapter" data-level="16.10" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#extract-data-based-on-watershed-outline"><i class="fa fa-check"></i><b>16.10</b> Extract data based on watershed outline</a></li>
<li class="chapter" data-level="16.11" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#bonus-make-a-3d-map-of-your-watershed-with-rayshader"><i class="fa fa-check"></i><b>16.11</b> BONUS: Make a 3d map of your watershed with rayshader</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="modelingintro.html"><a href="modelingintro.html"><i class="fa fa-check"></i><b>17</b> Intro to Modeling - Getting Started with HBV</a>
<ul>
<li class="chapter" data-level="17.1" data-path="modelingintro.html"><a href="modelingintro.html#introduction-4"><i class="fa fa-check"></i><b>17.1</b> Introduction</a></li>
<li class="chapter" data-level="17.2" data-path="modelingintro.html"><a href="modelingintro.html#creating-the-hbv-model-function"><i class="fa fa-check"></i><b>17.2</b> Creating the HBV model function</a></li>
<li class="chapter" data-level="17.3" data-path="modelingintro.html"><a href="modelingintro.html#read-in-precip-and-temp"><i class="fa fa-check"></i><b>17.3</b> Read in Precip and Temp</a></li>
<li class="chapter" data-level="17.4" data-path="modelingintro.html"><a href="modelingintro.html#calculate-pet"><i class="fa fa-check"></i><b>17.4</b> Calculate PET</a></li>
<li class="chapter" data-level="17.5" data-path="modelingintro.html"><a href="modelingintro.html#hbv-parameters"><i class="fa fa-check"></i><b>17.5</b> HBV Parameters</a></li>
<li class="chapter" data-level="17.6" data-path="modelingintro.html"><a href="modelingintro.html#first-model-run"><i class="fa fa-check"></i><b>17.6</b> First model run</a></li>
<li class="chapter" data-level="17.7" data-path="modelingintro.html"><a href="modelingintro.html#import-observed-streamflow-data"><i class="fa fa-check"></i><b>17.7</b> Import observed streamflow data</a></li>
<li class="chapter" data-level="17.8" data-path="modelingintro.html"><a href="modelingintro.html#compare-observed-and-modeled-discharge-graphically"><i class="fa fa-check"></i><b>17.8</b> Compare observed and modeled discharge graphically</a></li>
<li class="chapter" data-level="17.9" data-path="modelingintro.html"><a href="modelingintro.html#compare-observed-and-modelled-discharge-with-interactive-graph"><i class="fa fa-check"></i><b>17.9</b> Compare observed and modelled discharge with interactive graph</a></li>
<li class="chapter" data-level="17.10" data-path="modelingintro.html"><a href="modelingintro.html#measure-how-well-the-model-fits-with-nse"><i class="fa fa-check"></i><b>17.10</b> Measure how well the model fits with NSE</a></li>
<li class="chapter" data-level="17.11" data-path="modelingintro.html"><a href="modelingintro.html#assess-model-fit-with-a-different-measure-snow"><i class="fa fa-check"></i><b>17.11</b> Assess model fit with a different measure: Snow</a></li>
<li class="chapter" data-level="17.12" data-path="modelingintro.html"><a href="modelingintro.html#calibrate-hbv-manually"><i class="fa fa-check"></i><b>17.12</b> Calibrate HBV manually</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="modelingcalibration.html"><a href="modelingcalibration.html"><i class="fa fa-check"></i><b>18</b> Intro to Modeling - Calibrate HBV</a>
<ul>
<li class="chapter" data-level="18.1" data-path="modelingcalibration.html"><a href="modelingcalibration.html#introduction-5"><i class="fa fa-check"></i><b>18.1</b> Introduction</a></li>
<li class="chapter" data-level="18.2" data-path="modelingcalibration.html"><a href="modelingcalibration.html#challenge-write-a-for-loop"><i class="fa fa-check"></i><b>18.2</b> Challenge: Write a for loop</a></li>
<li class="chapter" data-level="18.3" data-path="modelingcalibration.html"><a href="modelingcalibration.html#prep-data-for-hbv"><i class="fa fa-check"></i><b>18.3</b> Prep data for HBV</a></li>
<li class="chapter" data-level="18.4" data-path="modelingcalibration.html"><a href="modelingcalibration.html#calculate-pet-1"><i class="fa fa-check"></i><b>18.4</b> Calculate PET</a></li>
<li class="chapter" data-level="18.5" data-path="modelingcalibration.html"><a href="modelingcalibration.html#monte-carlo-step-1-generate-random-parameter-sets"><i class="fa fa-check"></i><b>18.5</b> Monte Carlo step 1: generate random parameter sets</a></li>
<li class="chapter" data-level="18.6" data-path="modelingcalibration.html"><a href="modelingcalibration.html#run-the-model-for-each-parameter-set"><i class="fa fa-check"></i><b>18.6</b> Run the model for each parameter set</a></li>
<li class="chapter" data-level="18.7" data-path="modelingcalibration.html"><a href="modelingcalibration.html#find-the-best-parameter-set"><i class="fa fa-check"></i><b>18.7</b> Find the best parameter set</a></li>
<li class="chapter" data-level="18.8" data-path="modelingcalibration.html"><a href="modelingcalibration.html#investigating-a-much-bigger-monte-carlo"><i class="fa fa-check"></i><b>18.8</b> Investigating a much bigger Monte Carlo</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Hydroinformatics at VT</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelingcalibration" class="section level1 hasAnchor" number="18">
<h1><span class="header-section-number">Chapter 18</span> Intro to Modeling - Calibrate HBV<a href="modelingcalibration.html#modelingcalibration" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-5" class="section level2 hasAnchor" number="18.1">
<h2><span class="header-section-number">18.1</span> Introduction<a href="modelingcalibration.html#introduction-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The following activity is available as a template github repository at the following link: <a href="https://github.com/VT-Hydroinformatics/17-calibrate-model-for-loops" class="uri">https://github.com/VT-Hydroinformatics/17-calibrate-model-for-loops</a></p>
<p><em>Goals for this activity:</em></p>
<ul>
<li>Learn how for loops work</li>
<li>Use for loops to calibrate the HBV model using the Monte Carlo technique</li>
<li>Assess the results of the calibration, discuss equifinality</li>
</ul>
<p>We saw in the last activity that coming up with the parameters that create a model that fits our watershed discharge best is hard. For this reason, there are several ways people have devised for automating the process. We are going to explore one: a Monte Carlo calibration.</p>
<p>To use this approach, we will create a ton of random parameter sets, run the model for each, and then see which one fits best. The idea is that by creating a bunch of random sets of parameters, we will end up with at least one that works well. As you might guess, this can take a while. We will just do this for 100 or 1000 runs here in this activity, but we will also explore some output from a 100,000 run Monte Carlo that I ran and saved.</p>
<p>There is one new package this time, GGally, just for creating a parallel coordinate plot to look at the results of the 100k run Monte Carlo at the end.</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="modelingcalibration.html#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb280-2"><a href="modelingcalibration.html#cb280-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb280-3"><a href="modelingcalibration.html#cb280-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb280-4"><a href="modelingcalibration.html#cb280-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally) <span class="co">#for making parallel coordinate plot</span></span>
<span id="cb280-5"><a href="modelingcalibration.html#cb280-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-6"><a href="modelingcalibration.html#cb280-6" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>())</span></code></pre></div>
<p>In order to do what we are going to do, we need “for” loops.</p>
<p>A for loop is a way to run a chunk of code several times while changing a value in that chunk of code each time.</p>
<p>So using an example from class: you could run some code that downloads data from a USGS gage, and each time through the loop it changes which gage you download.</p>
<p>In R, the syntax for this is</p>
<blockquote>
<p>for(x in sequence){<br />
x<br />
}<br />
</p>
</blockquote>
<p>Where x will change every time you go through the loop. The values x will have each time through the loop are those that are in “sequence” above. If you changed this to x in 1:3, x would have values of 1, 2, and 3 each time through. If you made it x in c(2,3,5) x would change to 2, then 3, and then 5 each time through the loop. You can make the sequence anything and x can have any name so “letter in c(a, b, c)” would have <em>letter</em> change to a, then b, then c each time through the loop.</p>
<p>The image below shows a short example of how a for loop works.</p>
<p><img src="images/for%20loop.png" title="for loop" alt="for loop" />
Let’s try some examples</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="modelingcalibration.html#cb281-1" aria-hidden="true" tabindex="-1"></a>val <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb281-2"><a href="modelingcalibration.html#cb281-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-3"><a href="modelingcalibration.html#cb281-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(x <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb281-4"><a href="modelingcalibration.html#cb281-4" aria-hidden="true" tabindex="-1"></a>  val[x] <span class="ot">&lt;-</span> x</span>
<span id="cb281-5"><a href="modelingcalibration.html#cb281-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb281-6"><a href="modelingcalibration.html#cb281-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-7"><a href="modelingcalibration.html#cb281-7" aria-hidden="true" tabindex="-1"></a>val</span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="modelingcalibration.html#cb283-1" aria-hidden="true" tabindex="-1"></a>days <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;mon&quot;</span>,<span class="st">&quot;tues&quot;</span>,<span class="st">&quot;wednes&quot;</span>)</span>
<span id="cb283-2"><a href="modelingcalibration.html#cb283-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-3"><a href="modelingcalibration.html#cb283-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(x <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(days)){</span>
<span id="cb283-4"><a href="modelingcalibration.html#cb283-4" aria-hidden="true" tabindex="-1"></a>  days[x] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(days[x], <span class="st">&quot;day&quot;</span>)</span>
<span id="cb283-5"><a href="modelingcalibration.html#cb283-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb283-6"><a href="modelingcalibration.html#cb283-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-7"><a href="modelingcalibration.html#cb283-7" aria-hidden="true" tabindex="-1"></a>days</span></code></pre></div>
<pre><code>## [1] &quot;monday&quot;    &quot;tuesday&quot;   &quot;wednesday&quot;</code></pre>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="modelingcalibration.html#cb285-1" aria-hidden="true" tabindex="-1"></a>gages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;123&quot;</span>,<span class="st">&quot;ABC&quot;</span>,<span class="st">&quot;001&quot;</span>)</span>
<span id="cb285-2"><a href="modelingcalibration.html#cb285-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-3"><a href="modelingcalibration.html#cb285-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(g <span class="cf">in</span> gages){</span>
<span id="cb285-4"><a href="modelingcalibration.html#cb285-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(g)</span>
<span id="cb285-5"><a href="modelingcalibration.html#cb285-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;123&quot;
## [1] &quot;ABC&quot;
## [1] &quot;001&quot;</code></pre>
</div>
<div id="challenge-write-a-for-loop" class="section level2 hasAnchor" number="18.2">
<h2><span class="header-section-number">18.2</span> Challenge: Write a for loop<a href="modelingcalibration.html#challenge-write-a-for-loop" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Define a vector with values 5, 6, 7, 8, 9</p>
<p>Create a for loop that steps through this vector and adds 1 to each value.</p>
<p>Yes, you can do this by just typing the name of the vector + 1, but that’s not the point!</p>
</div>
<div id="prep-data-for-hbv" class="section level2 hasAnchor" number="18.3">
<h2><span class="header-section-number">18.3</span> Prep data for HBV<a href="modelingcalibration.html#prep-data-for-hbv" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Since we did this in the last chapter, we are just going to quickly run the code the preps our data to go into the model. Below we load the HBV movdel and make vectors of P, Qobs, and Temp.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="modelingcalibration.html#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create the HBV function with the HBV R file</span></span>
<span id="cb287-2"><a href="modelingcalibration.html#cb287-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&#39;HBV/HBV.R&#39;</span>)</span>
<span id="cb287-3"><a href="modelingcalibration.html#cb287-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-4"><a href="modelingcalibration.html#cb287-4" aria-hidden="true" tabindex="-1"></a><span class="co">#set start and end dates for model to filter data</span></span>
<span id="cb287-5"><a href="modelingcalibration.html#cb287-5" aria-hidden="true" tabindex="-1"></a>start <span class="ot">&lt;-</span> <span class="fu">mdy</span>(<span class="st">&quot;01-01-2009&quot;</span>)</span>
<span id="cb287-6"><a href="modelingcalibration.html#cb287-6" aria-hidden="true" tabindex="-1"></a>end <span class="ot">&lt;-</span> <span class="fu">mdy</span>(<span class="st">&quot;12-31-2012&quot;</span>)</span>
<span id="cb287-7"><a href="modelingcalibration.html#cb287-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-8"><a href="modelingcalibration.html#cb287-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Precip</span></span>
<span id="cb287-9"><a href="modelingcalibration.html#cb287-9" aria-hidden="true" tabindex="-1"></a>P1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;HBV/Pwd2009-2012.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb287-10"><a href="modelingcalibration.html#cb287-10" aria-hidden="true" tabindex="-1"></a>         <span class="fu">select</span>(DATE, WS_3) <span class="sc">%&gt;%</span></span>
<span id="cb287-11"><a href="modelingcalibration.html#cb287-11" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">DATE =</span> <span class="fu">ymd</span>(DATE)) <span class="sc">%&gt;%</span></span>
<span id="cb287-12"><a href="modelingcalibration.html#cb287-12" aria-hidden="true" tabindex="-1"></a>         <span class="fu">filter</span>(DATE <span class="sc">&gt;=</span> start <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end)</span></code></pre></div>
<pre><code>## Rows: 1461 Columns: 10
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## dbl (10): DATE, WS_1, WS_2, WS_3, WS_4, WS_5, WS_6, WS_7, WS_8, WS_9
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="modelingcalibration.html#cb289-1" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> P1<span class="sc">$</span>WS_3</span>
<span id="cb289-2"><a href="modelingcalibration.html#cb289-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-3"><a href="modelingcalibration.html#cb289-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Streamflow mm/d</span></span>
<span id="cb289-4"><a href="modelingcalibration.html#cb289-4" aria-hidden="true" tabindex="-1"></a>Qobs1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;HBV/SWD2009-2012.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb289-5"><a href="modelingcalibration.html#cb289-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">select</span>(DATE, WS_3) <span class="sc">%&gt;%</span></span>
<span id="cb289-6"><a href="modelingcalibration.html#cb289-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">DATE =</span> <span class="fu">ymd</span>(DATE)) <span class="sc">%&gt;%</span></span>
<span id="cb289-7"><a href="modelingcalibration.html#cb289-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">filter</span>(DATE <span class="sc">&gt;=</span> start <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end)</span></code></pre></div>
<pre><code>## Rows: 1461 Columns: 10
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## dbl (10): DATE, WS_1, WS_2, WS_3, WS_4, WS_5, WS_6, WS_7, WS_8, WS_9
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="modelingcalibration.html#cb291-1" aria-hidden="true" tabindex="-1"></a>Qobs <span class="ot">&lt;-</span> Qobs1<span class="sc">$</span>WS_3</span>
<span id="cb291-2"><a href="modelingcalibration.html#cb291-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-3"><a href="modelingcalibration.html#cb291-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Temp in deg C</span></span>
<span id="cb291-4"><a href="modelingcalibration.html#cb291-4" aria-hidden="true" tabindex="-1"></a>Temp1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;HBV/Tdm2009-2012.csv&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb291-5"><a href="modelingcalibration.html#cb291-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">select</span>(DATE, STA_1) <span class="sc">%&gt;%</span></span>
<span id="cb291-6"><a href="modelingcalibration.html#cb291-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">DATE =</span> <span class="fu">ymd</span>(DATE)) <span class="sc">%&gt;%</span></span>
<span id="cb291-7"><a href="modelingcalibration.html#cb291-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">filter</span>(DATE <span class="sc">&gt;=</span> start <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end)</span></code></pre></div>
<pre><code>## Rows: 1461 Columns: 9
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## dbl (9): DATE, STA_1, STA_6, STA_14, STA_INT, STA_HQ, STA_23, STA_17, STA_24
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="modelingcalibration.html#cb293-1" aria-hidden="true" tabindex="-1"></a>Temp <span class="ot">&lt;-</span> Temp1<span class="sc">$</span>STA_1</span>
<span id="cb293-2"><a href="modelingcalibration.html#cb293-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-3"><a href="modelingcalibration.html#cb293-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Snow in SWE, mm</span></span>
<span id="cb293-4"><a href="modelingcalibration.html#cb293-4" aria-hidden="true" tabindex="-1"></a>snow <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;HBV/sno2009-2012.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb293-5"><a href="modelingcalibration.html#cb293-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">select</span>(DATE, STA2) <span class="sc">%&gt;%</span></span>
<span id="cb293-6"><a href="modelingcalibration.html#cb293-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">DATE =</span> <span class="fu">ymd</span>(DATE)) <span class="sc">%&gt;%</span></span>
<span id="cb293-7"><a href="modelingcalibration.html#cb293-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">filter</span>(DATE <span class="sc">&gt;=</span> start <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end)</span></code></pre></div>
<pre><code>## New names:
## Rows: 76 Columns: 25
## ── Column specification
## ──────────────────────────────────────────────────────── Delimiter: &quot;,&quot; chr
## (1): DATE dbl (21): STA1, STA2, STA3, STA4, STA5, STA6, STA7, STA8, STA9,
## STA10, STA11... lgl (3): ...23, ...24, ...25
## ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
## Specify the column types or set `show_col_types = FALSE` to quiet this message.
## • `` -&gt; `...23`
## • `` -&gt; `...24`
## • `` -&gt; `...25`</code></pre>
<pre><code>## Warning: 8 failed to parse.</code></pre>
</div>
<div id="calculate-pet-1" class="section level2 hasAnchor" number="18.4">
<h2><span class="header-section-number">18.4</span> Calculate PET<a href="modelingcalibration.html#calculate-pet-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Again, because we did this last time, we will just re-run this code to create our PET values.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="modelingcalibration.html#cb296-1" aria-hidden="true" tabindex="-1"></a>lat <span class="ot">&lt;-</span> <span class="dv">43</span> <span class="sc">+</span> <span class="dv">57</span><span class="sc">/</span><span class="dv">60</span> <span class="co">#43 degrees and 57 minutes</span></span>
<span id="cb296-2"><a href="modelingcalibration.html#cb296-2" aria-hidden="true" tabindex="-1"></a>latrad <span class="ot">&lt;-</span> (lat<span class="sc">/</span><span class="dv">360</span>) <span class="sc">*</span> <span class="dv">2</span> <span class="sc">*</span> pi <span class="co">#convert to radians</span></span>
<span id="cb296-3"><a href="modelingcalibration.html#cb296-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-4"><a href="modelingcalibration.html#cb296-4" aria-hidden="true" tabindex="-1"></a>PET1 <span class="ot">&lt;-</span> <span class="fu">select</span>(Temp1, DATE) <span class="sc">%&gt;%</span></span>
<span id="cb296-5"><a href="modelingcalibration.html#cb296-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">DOY =</span> <span class="fu">yday</span>(DATE)) <span class="sc">%&gt;%</span> <span class="co">#DOY for dates</span></span>
<span id="cb296-6"><a href="modelingcalibration.html#cb296-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">tempvar =</span> (<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">365</span>) <span class="sc">*</span> DOY) <span class="sc">%&gt;%</span></span>
<span id="cb296-7"><a href="modelingcalibration.html#cb296-7" aria-hidden="true" tabindex="-1"></a>         <span class="co">#declination of the sun above the celestial equator in </span></span>
<span id="cb296-8"><a href="modelingcalibration.html#cb296-8" aria-hidden="true" tabindex="-1"></a>         <span class="co">#radians on day JulDay of the year</span></span>
<span id="cb296-9"><a href="modelingcalibration.html#cb296-9" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">delta_h =</span> <span class="fl">0.4093</span> <span class="sc">*</span> <span class="fu">sin</span>(tempvar <span class="sc">-</span> <span class="fl">1.405</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb296-10"><a href="modelingcalibration.html#cb296-10" aria-hidden="true" tabindex="-1"></a>         <span class="co">#day length in h</span></span>
<span id="cb296-11"><a href="modelingcalibration.html#cb296-11" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">daylen =</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">acos</span>(<span class="sc">-</span><span class="fu">tan</span>(delta_h) <span class="sc">*</span> <span class="fu">tan</span>(latrad)) <span class="sc">/</span> <span class="fl">0.2618</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb296-12"><a href="modelingcalibration.html#cb296-12" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(</span>
<span id="cb296-13"><a href="modelingcalibration.html#cb296-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">PET =</span> <span class="fl">29.8</span> <span class="sc">*</span> daylen <span class="sc">*</span> <span class="fl">0.611</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">17.3</span> <span class="sc">*</span> Temp <span class="sc">/</span> </span>
<span id="cb296-14"><a href="modelingcalibration.html#cb296-14" aria-hidden="true" tabindex="-1"></a>                  (Temp <span class="sc">+</span> <span class="fl">237.3</span>)) <span class="sc">/</span> (Temp <span class="sc">+</span> <span class="fl">273.2</span>))  <span class="co">#PET Hamon method</span></span>
<span id="cb296-15"><a href="modelingcalibration.html#cb296-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-16"><a href="modelingcalibration.html#cb296-16" aria-hidden="true" tabindex="-1"></a>PET <span class="ot">&lt;-</span> PET1<span class="sc">$</span>PET</span></code></pre></div>
</div>
<div id="monte-carlo-step-1-generate-random-parameter-sets" class="section level2 hasAnchor" number="18.5">
<h2><span class="header-section-number">18.5</span> Monte Carlo step 1: generate random parameter sets<a href="modelingcalibration.html#monte-carlo-step-1-generate-random-parameter-sets" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Below is a table of the parameters for the HBV model and their suggested min and max values for our application. What we basically want to do is mimic you sitting down at the computer and randomly changing all the parameters, running the model, and checking to see how well it did. Over, and over, and over.</p>
<p>You can do this by generating the set of parameters each time you run the model, but we are going to do it separately so we can see the Nashe-Sutcliff efficiency (NSE) for each set of parameters.</p>
<table>
<colgroup>
<col width="32%" />
<col width="17%" />
<col width="14%" />
<col width="35%" />
</colgroup>
<thead>
<tr class="header">
<th>Object Name</th>
<th>Min</th>
<th>Max</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>FC</td>
<td>40</td>
<td>400</td>
<td>Max soil moisture storage, field capacity</td>
</tr>
<tr class="even">
<td>beta</td>
<td>1</td>
<td>6</td>
<td>Shape coefficient governing fate of water input to soil moisture storage</td>
</tr>
<tr class="odd">
<td>LP</td>
<td>.3</td>
<td>1</td>
<td>Threshold for reduction of evaporation</td>
</tr>
<tr class="even">
<td>SFCF</td>
<td>0.4</td>
<td>1.2</td>
<td>Snowfall correction factor</td>
</tr>
<tr class="odd">
<td>TT</td>
<td>-1.5</td>
<td>1.2</td>
<td>Threshold temperature</td>
</tr>
<tr class="even">
<td>CFMAX</td>
<td>1</td>
<td>8</td>
<td>Degree-day factor</td>
</tr>
<tr class="odd">
<td>k0</td>
<td>0.05</td>
<td>0.5</td>
<td>Recession constant (upper storage, near surface)</td>
</tr>
<tr class="even">
<td>k1</td>
<td>0.01</td>
<td>0.3</td>
<td>Recession constant (upper storage)</td>
</tr>
<tr class="odd">
<td>k2</td>
<td>0.001</td>
<td>0.15</td>
<td>Recession constant (lower storage)</td>
</tr>
<tr class="even">
<td>UZL</td>
<td>0</td>
<td>70</td>
<td>Threshold for shallow storage</td>
</tr>
<tr class="odd">
<td>PERC</td>
<td>0</td>
<td>4</td>
<td>Percolation, max flow from upper to lower storage</td>
</tr>
<tr class="even">
<td>MAXBAS</td>
<td>1</td>
<td>3</td>
<td>base of the triangular routing function, days”</td>
</tr>
</tbody>
</table>
<p>To make our parameter sets, we first have to decide how many model runs we want to try. Let’s try 100 so we don’t burn down anyone’s computer.</p>
<p>Then we will use the runif() function to generate the same number of random values as the number of model runs we want to perform for each parameter, within the bounds of the min and max values above.</p>
<p>Remember, runif() creates a set of random numbers in a uniform distribution with a specified length with a specified minimum and maximum value. A uniform distribution is one where each number has the same probability of occurrence as the next, so it’s basically a set of random numbers between your min and max values.</p>
<p>We will also create a blank vector of the same length which we will populate with the NSE values for each model run, and then slap them all together with cbind() (column bind).</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="modelingcalibration.html#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="co">#number of runs</span></span>
<span id="cb297-2"><a href="modelingcalibration.html#cb297-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb297-3"><a href="modelingcalibration.html#cb297-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-4"><a href="modelingcalibration.html#cb297-4" aria-hidden="true" tabindex="-1"></a><span class="co"># PARAMETERS RANGE and generate set</span></span>
<span id="cb297-5"><a href="modelingcalibration.html#cb297-5" aria-hidden="true" tabindex="-1"></a>FC    <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="dv">40</span>   , <span class="at">max =</span> <span class="dv">400</span>)  <span class="co">#Max soil moisture storage, field capacity</span></span>
<span id="cb297-6"><a href="modelingcalibration.html#cb297-6" aria-hidden="true" tabindex="-1"></a>beta  <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="dv">1</span>    , <span class="at">max =</span> <span class="dv">6</span>)    <span class="co">#Shape coefficient governing fate of water input to soil moisture storage</span></span>
<span id="cb297-7"><a href="modelingcalibration.html#cb297-7" aria-hidden="true" tabindex="-1"></a>LP    <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="fl">0.3</span>   , <span class="at">max =</span> <span class="dv">1</span>)    <span class="co">#Threshold for reduction of evap</span></span>
<span id="cb297-8"><a href="modelingcalibration.html#cb297-8" aria-hidden="true" tabindex="-1"></a>SFCF  <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="fl">0.4</span>  , <span class="at">max =</span> <span class="fl">1.2</span>)  <span class="co">#Snowfall correction factor</span></span>
<span id="cb297-9"><a href="modelingcalibration.html#cb297-9" aria-hidden="true" tabindex="-1"></a>TT    <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="sc">-</span><span class="fl">1.5</span> , <span class="at">max =</span> <span class="fl">1.2</span>)  <span class="co">#Threshold temperature</span></span>
<span id="cb297-10"><a href="modelingcalibration.html#cb297-10" aria-hidden="true" tabindex="-1"></a>CFMAX <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="dv">1</span>    , <span class="at">max =</span> <span class="dv">8</span>)    <span class="co">#Degree-day factor</span></span>
<span id="cb297-11"><a href="modelingcalibration.html#cb297-11" aria-hidden="true" tabindex="-1"></a>k0    <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="fl">0.05</span> , <span class="at">max =</span> <span class="fl">0.5</span>)  <span class="co">#Recession constant (upper storage, near surface)</span></span>
<span id="cb297-12"><a href="modelingcalibration.html#cb297-12" aria-hidden="true" tabindex="-1"></a>k1    <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="fl">0.01</span> , <span class="at">max =</span> <span class="fl">0.3</span>)  <span class="co">#Recession constant (upper storage)</span></span>
<span id="cb297-13"><a href="modelingcalibration.html#cb297-13" aria-hidden="true" tabindex="-1"></a>k2    <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="fl">0.001</span>, <span class="at">max =</span> <span class="fl">0.15</span>) <span class="co">#Recession constant (lower storage)</span></span>
<span id="cb297-14"><a href="modelingcalibration.html#cb297-14" aria-hidden="true" tabindex="-1"></a>UZL   <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="dv">0</span>    , <span class="at">max =</span> <span class="dv">70</span>)   <span class="co">#Threshold for shallow storage</span></span>
<span id="cb297-15"><a href="modelingcalibration.html#cb297-15" aria-hidden="true" tabindex="-1"></a>PERC  <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="dv">0</span>    , <span class="at">max =</span> <span class="dv">4</span>)    <span class="co">#Percolation, max flow from upper to lower storage</span></span>
<span id="cb297-16"><a href="modelingcalibration.html#cb297-16" aria-hidden="true" tabindex="-1"></a>MAXBAS<span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, N)   <span class="co">#base of the triangular routing function, days</span></span>
<span id="cb297-17"><a href="modelingcalibration.html#cb297-17" aria-hidden="true" tabindex="-1"></a><span class="co">#MAXBAS is just 1&#39;s because routing will be set to zero, so the parameter isn&#39;t used</span></span>
<span id="cb297-18"><a href="modelingcalibration.html#cb297-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-19"><a href="modelingcalibration.html#cb297-19" aria-hidden="true" tabindex="-1"></a>NSE <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, N) <span class="co">#create NSE column, to be filled in for loop</span></span>
<span id="cb297-20"><a href="modelingcalibration.html#cb297-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-21"><a href="modelingcalibration.html#cb297-21" aria-hidden="true" tabindex="-1"></a>routing <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb297-22"><a href="modelingcalibration.html#cb297-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-23"><a href="modelingcalibration.html#cb297-23" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">&lt;-</span> <span class="fu">cbind</span>(FC, beta, LP, SFCF, </span>
<span id="cb297-24"><a href="modelingcalibration.html#cb297-24" aria-hidden="true" tabindex="-1"></a>               TT, CFMAX, k0, k1, </span>
<span id="cb297-25"><a href="modelingcalibration.html#cb297-25" aria-hidden="true" tabindex="-1"></a>               k2, UZL, PERC, MAXBAS, NSE) </span></code></pre></div>
</div>
<div id="run-the-model-for-each-parameter-set" class="section level2 hasAnchor" number="18.6">
<h2><span class="header-section-number">18.6</span> Run the model for each parameter set<a href="modelingcalibration.html#run-the-model-for-each-parameter-set" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Alright, let’s get at this. We now have our random sets of parameters. So we will run the model for each and see how it does.</p>
<p>Here’s how we will do that:</p>
<p>First: Define the period for which we want to calculate NSE. Remember we are going to drop the first 40% of the model run to let the model “warm up”. Since we are starting with nothing in the storages we need to let the boxes
“fill up” and settle in.</p>
<p>Then we run a FOR LOOP!</p>
<p>Our for loop will step through a sequence of numbers from 1 to the total number of parameter sets we have. So in this case: 100. We will use i as our variable. So i will be 1, 2, 3…. all the way to 100.</p>
<p>In the code portion of the loop, it will grab the parameters from row i of the parameter set we created. And pass that to the HBV function with the Precip, Temp, and PET data. Remember routing is just set to zero.</p>
<p>After we run the model (still in the for loop) we will stick our observed values onto the results and then trip them to the period we want to evaluate. (drop the first 40%)</p>
<p>Finally, we calculate NSE for that individual model run, and then add it into the NSE column we made before. So each run will just tack on an NSE value to the end of the paramter set. We don’t need to save the model results, because we can just rerun the model with the same parameters and it’ll give us the same output.</p>
<p>The figure below illustrates how the for loop will work:</p>
<div class="figure">
<img src="images/monte%20carlo%20for%20loop.png" title="Monte Carlo for loop" alt="" />
<p class="caption">monte carlo for loop</p>
</div>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="modelingcalibration.html#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="co">#trim the first 40% (warm up) of Qobs off for NSE calculation </span></span>
<span id="cb298-2"><a href="modelingcalibration.html#cb298-2" aria-hidden="true" tabindex="-1"></a>EvalStart <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="fu">length</span>(Qobs) <span class="sc">*</span> <span class="fl">0.4</span>)</span>
<span id="cb298-3"><a href="modelingcalibration.html#cb298-3" aria-hidden="true" tabindex="-1"></a>EvalEnd <span class="ot">&lt;-</span> <span class="fu">length</span>(Qobs)</span>
<span id="cb298-4"><a href="modelingcalibration.html#cb298-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-5"><a href="modelingcalibration.html#cb298-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-6"><a href="modelingcalibration.html#cb298-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb298-7"><a href="modelingcalibration.html#cb298-7" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb298-8"><a href="modelingcalibration.html#cb298-8" aria-hidden="true" tabindex="-1"></a>   <span class="co">#call model with i parameter set generated above</span></span>
<span id="cb298-9"><a href="modelingcalibration.html#cb298-9" aria-hidden="true" tabindex="-1"></a>   results <span class="ot">&lt;-</span> <span class="fu">HBV</span>(pars[i,<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>], P, Temp, PET, routing)</span>
<span id="cb298-10"><a href="modelingcalibration.html#cb298-10" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb298-11"><a href="modelingcalibration.html#cb298-11" aria-hidden="true" tabindex="-1"></a>   <span class="co">#add the Qobs to results</span></span>
<span id="cb298-12"><a href="modelingcalibration.html#cb298-12" aria-hidden="true" tabindex="-1"></a>   results <span class="ot">&lt;-</span> <span class="fu">cbind</span>(results, Qobs)</span>
<span id="cb298-13"><a href="modelingcalibration.html#cb298-13" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb298-14"><a href="modelingcalibration.html#cb298-14" aria-hidden="true" tabindex="-1"></a>   <span class="co">#trim the first 40% of the record so it isn&#39;t included in the NSE calculation</span></span>
<span id="cb298-15"><a href="modelingcalibration.html#cb298-15" aria-hidden="true" tabindex="-1"></a>   results <span class="ot">&lt;-</span> results[EvalStart<span class="sc">:</span>EvalEnd,]</span>
<span id="cb298-16"><a href="modelingcalibration.html#cb298-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb298-17"><a href="modelingcalibration.html#cb298-17" aria-hidden="true" tabindex="-1"></a>   <span class="co">#Calculate NSE and add to parameter set</span></span>
<span id="cb298-18"><a href="modelingcalibration.html#cb298-18" aria-hidden="true" tabindex="-1"></a>   pars[i,<span class="dv">13</span>]  <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> ((<span class="fu">sum</span>((results<span class="sc">$</span>Qobs <span class="sc">-</span> results<span class="sc">$</span>q) <span class="sc">^</span> <span class="dv">2</span>)) <span class="sc">/</span> <span class="fu">sum</span>((results<span class="sc">$</span>Qobs <span class="sc">-</span> <span class="fu">mean</span>(results<span class="sc">$</span>Qobs)) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb298-19"><a href="modelingcalibration.html#cb298-19" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb298-20"><a href="modelingcalibration.html#cb298-20" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="find-the-best-parameter-set" class="section level2 hasAnchor" number="18.7">
<h2><span class="header-section-number">18.7</span> Find the best parameter set<a href="modelingcalibration.html#find-the-best-parameter-set" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Alright, now we have a NSE value that tells us how well each parameter set did at estimating runoff. So we need to find the best one!</p>
<p>To do this, we will convert the parameter sets to a tibble, use filter to grab the row with the maximum NSE, then use slice to pull just that row out of the tibble. Finally, we will run as.numeric on the data to be sure everything is numbers.</p>
<p>Now we have our best parameter set, let’s see how it did!</p>
<p>We will do what we did in the previous lesson: run the model with the parameter set, slap on the observed data, and filter it to the time period we want to look at. (after 08-07-2010 in this case, that’s the 40% cutoff in this case)</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="modelingcalibration.html#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="co">#find best parameters</span></span>
<span id="cb299-2"><a href="modelingcalibration.html#cb299-2" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(pars)</span>
<span id="cb299-3"><a href="modelingcalibration.html#cb299-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-4"><a href="modelingcalibration.html#cb299-4" aria-hidden="true" tabindex="-1"></a>bestparams <span class="ot">&lt;-</span> pars <span class="sc">%&gt;%</span> <span class="fu">filter</span>(NSE <span class="sc">==</span> <span class="fu">max</span>(NSE)) <span class="sc">%&gt;%</span></span>
<span id="cb299-5"><a href="modelingcalibration.html#cb299-5" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-6"><a href="modelingcalibration.html#cb299-6" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">as.numeric</span>()</span>
<span id="cb299-7"><a href="modelingcalibration.html#cb299-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-8"><a href="modelingcalibration.html#cb299-8" aria-hidden="true" tabindex="-1"></a><span class="co">#run with best parameters</span></span>
<span id="cb299-9"><a href="modelingcalibration.html#cb299-9" aria-hidden="true" tabindex="-1"></a>modeloutput <span class="ot">&lt;-</span>  <span class="fu">HBV</span>(bestparams, P, Temp, PET, routing)</span>
<span id="cb299-10"><a href="modelingcalibration.html#cb299-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-11"><a href="modelingcalibration.html#cb299-11" aria-hidden="true" tabindex="-1"></a><span class="co">#add observations for plotting</span></span>
<span id="cb299-12"><a href="modelingcalibration.html#cb299-12" aria-hidden="true" tabindex="-1"></a>modeloutput <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(modeloutput, Qobs1)</span>
<span id="cb299-13"><a href="modelingcalibration.html#cb299-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-14"><a href="modelingcalibration.html#cb299-14" aria-hidden="true" tabindex="-1"></a><span class="co">#trim out warm up period for plotting</span></span>
<span id="cb299-15"><a href="modelingcalibration.html#cb299-15" aria-hidden="true" tabindex="-1"></a>OutputTrim <span class="ot">&lt;-</span> <span class="fu">filter</span>(modeloutput, DATE <span class="sc">&gt;=</span> <span class="fu">mdy</span>(<span class="st">&quot;08-07-2010&quot;</span>))</span></code></pre></div>
<p>Below we will look at the model run using plotly. First, we calculate the NSE again, just to be sure, and then plot the same way we did in the last lesson.</p>
<p>How did the model do? Did the 100 run Monte Carlo do better or worse than your manual attempts from last lesson?</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="modelingcalibration.html#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate NSE</span></span>
<span id="cb300-2"><a href="modelingcalibration.html#cb300-2" aria-hidden="true" tabindex="-1"></a>NSE <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> ((<span class="fu">sum</span>((OutputTrim<span class="sc">$</span>q <span class="sc">-</span> OutputTrim<span class="sc">$</span>WS_3) <span class="sc">^</span> <span class="dv">2</span>)) <span class="sc">/</span> </span>
<span id="cb300-3"><a href="modelingcalibration.html#cb300-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">sum</span>((OutputTrim<span class="sc">$</span>WS_3 <span class="sc">-</span> <span class="fu">mean</span>(OutputTrim<span class="sc">$</span>WS_3)) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb300-4"><a href="modelingcalibration.html#cb300-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-5"><a href="modelingcalibration.html#cb300-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Create plot with NSE in title</span></span>
<span id="cb300-6"><a href="modelingcalibration.html#cb300-6" aria-hidden="true" tabindex="-1"></a>OutputTrim <span class="sc">%&gt;%</span> <span class="fu">plot_ly</span>(<span class="at">x =</span> <span class="sc">~</span>DATE) <span class="sc">%&gt;%</span> </span>
<span id="cb300-7"><a href="modelingcalibration.html#cb300-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">add_trace</span>(<span class="at">y =</span> <span class="sc">~</span>q, <span class="at">name =</span> <span class="st">&#39;Modeled&#39;</span>,  <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="at">mode =</span> <span class="st">&#39;lines&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb300-8"><a href="modelingcalibration.html#cb300-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">add_trace</span>(<span class="at">y =</span> <span class="sc">~</span>WS_3, <span class="at">name =</span> <span class="st">&#39;Measured&#39;</span>, <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="at">mode =</span> <span class="st">&#39;lines&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb300-9"><a href="modelingcalibration.html#cb300-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">layout</span>(<span class="at">title=</span><span class="fu">paste</span>(<span class="st">&quot;NSE: &quot;</span>, <span class="fu">round</span>(NSE,<span class="dv">2</span>)))</span></code></pre></div>
<div id="htmlwidget-c7c1f87d691b4e9f8ca6" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-c7c1f87d691b4e9f8ca6">{"x":{"visdat":{"3f494e2845e":["function () ","plotlyVisDat"]},"cur_data":"3f494e2845e","attrs":{"3f494e2845e":{"x":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"name":"Modeled","type":"scatter","mode":"lines","inherit":true},"3f494e2845e.1":{"x":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"name":"Measured","type":"scatter","mode":"lines","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"NSE:  0.75","xaxis":{"domain":[0,1],"automargin":true,"title":"DATE"},"yaxis":{"domain":[0,1],"automargin":true,"title":"q"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["2010-08-07","2010-08-08","2010-08-09","2010-08-10","2010-08-11","2010-08-12","2010-08-13","2010-08-14","2010-08-15","2010-08-16","2010-08-17","2010-08-18","2010-08-19","2010-08-20","2010-08-21","2010-08-22","2010-08-23","2010-08-24","2010-08-25","2010-08-26","2010-08-27","2010-08-28","2010-08-29","2010-08-30","2010-08-31","2010-09-01","2010-09-02","2010-09-03","2010-09-04","2010-09-05","2010-09-06","2010-09-07","2010-09-08","2010-09-09","2010-09-10","2010-09-11","2010-09-12","2010-09-13","2010-09-14","2010-09-15","2010-09-16","2010-09-17","2010-09-18","2010-09-19","2010-09-20","2010-09-21","2010-09-22","2010-09-23","2010-09-24","2010-09-25","2010-09-26","2010-09-27","2010-09-28","2010-09-29","2010-09-30","2010-10-01","2010-10-02","2010-10-03","2010-10-04","2010-10-05","2010-10-06","2010-10-07","2010-10-08","2010-10-09","2010-10-10","2010-10-11","2010-10-12","2010-10-13","2010-10-14","2010-10-15","2010-10-16","2010-10-17","2010-10-18","2010-10-19","2010-10-20","2010-10-21","2010-10-22","2010-10-23","2010-10-24","2010-10-25","2010-10-26","2010-10-27","2010-10-28","2010-10-29","2010-10-30","2010-10-31","2010-11-01","2010-11-02","2010-11-03","2010-11-04","2010-11-05","2010-11-06","2010-11-07","2010-11-08","2010-11-09","2010-11-10","2010-11-11","2010-11-12","2010-11-13","2010-11-14","2010-11-15","2010-11-16","2010-11-17","2010-11-18","2010-11-19","2010-11-20","2010-11-21","2010-11-22","2010-11-23","2010-11-24","2010-11-25","2010-11-26","2010-11-27","2010-11-28","2010-11-29","2010-11-30","2010-12-01","2010-12-02","2010-12-03","2010-12-04","2010-12-05","2010-12-06","2010-12-07","2010-12-08","2010-12-09","2010-12-10","2010-12-11","2010-12-12","2010-12-13","2010-12-14","2010-12-15","2010-12-16","2010-12-17","2010-12-18","2010-12-19","2010-12-20","2010-12-21","2010-12-22","2010-12-23","2010-12-24","2010-12-25","2010-12-26","2010-12-27","2010-12-28","2010-12-29","2010-12-30","2010-12-31","2011-01-01","2011-01-02","2011-01-03","2011-01-04","2011-01-05","2011-01-06","2011-01-07","2011-01-08","2011-01-09","2011-01-10","2011-01-11","2011-01-12","2011-01-13","2011-01-14","2011-01-15","2011-01-16","2011-01-17","2011-01-18","2011-01-19","2011-01-20","2011-01-21","2011-01-22","2011-01-23","2011-01-24","2011-01-25","2011-01-26","2011-01-27","2011-01-28","2011-01-29","2011-01-30","2011-01-31","2011-02-01","2011-02-02","2011-02-03","2011-02-04","2011-02-05","2011-02-06","2011-02-07","2011-02-08","2011-02-09","2011-02-10","2011-02-11","2011-02-12","2011-02-13","2011-02-14","2011-02-15","2011-02-16","2011-02-17","2011-02-18","2011-02-19","2011-02-20","2011-02-21","2011-02-22","2011-02-23","2011-02-24","2011-02-25","2011-02-26","2011-02-27","2011-02-28","2011-03-01","2011-03-02","2011-03-03","2011-03-04","2011-03-05","2011-03-06","2011-03-07","2011-03-08","2011-03-09","2011-03-10","2011-03-11","2011-03-12","2011-03-13","2011-03-14","2011-03-15","2011-03-16","2011-03-17","2011-03-18","2011-03-19","2011-03-20","2011-03-21","2011-03-22","2011-03-23","2011-03-24","2011-03-25","2011-03-26","2011-03-27","2011-03-28","2011-03-29","2011-03-30","2011-03-31","2011-04-01","2011-04-02","2011-04-03","2011-04-04","2011-04-05","2011-04-06","2011-04-07","2011-04-08","2011-04-09","2011-04-10","2011-04-11","2011-04-12","2011-04-13","2011-04-14","2011-04-15","2011-04-16","2011-04-17","2011-04-18","2011-04-19","2011-04-20","2011-04-21","2011-04-22","2011-04-23","2011-04-24","2011-04-25","2011-04-26","2011-04-27","2011-04-28","2011-04-29","2011-04-30","2011-05-01","2011-05-02","2011-05-03","2011-05-04","2011-05-05","2011-05-06","2011-05-07","2011-05-08","2011-05-09","2011-05-10","2011-05-11","2011-05-12","2011-05-13","2011-05-14","2011-05-15","2011-05-16","2011-05-17","2011-05-18","2011-05-19","2011-05-20","2011-05-21","2011-05-22","2011-05-23","2011-05-24","2011-05-25","2011-05-26","2011-05-27","2011-05-28","2011-05-29","2011-05-30","2011-05-31","2011-06-01","2011-06-02","2011-06-03","2011-06-04","2011-06-05","2011-06-06","2011-06-07","2011-06-08","2011-06-09","2011-06-10","2011-06-11","2011-06-12","2011-06-13","2011-06-14","2011-06-15","2011-06-16","2011-06-17","2011-06-18","2011-06-19","2011-06-20","2011-06-21","2011-06-22","2011-06-23","2011-06-24","2011-06-25","2011-06-26","2011-06-27","2011-06-28","2011-06-29","2011-06-30","2011-07-01","2011-07-02","2011-07-03","2011-07-04","2011-07-05","2011-07-06","2011-07-07","2011-07-08","2011-07-09","2011-07-10","2011-07-11","2011-07-12","2011-07-13","2011-07-14","2011-07-15","2011-07-16","2011-07-17","2011-07-18","2011-07-19","2011-07-20","2011-07-21","2011-07-22","2011-07-23","2011-07-24","2011-07-25","2011-07-26","2011-07-27","2011-07-28","2011-07-29","2011-07-30","2011-07-31","2011-08-01","2011-08-02","2011-08-03","2011-08-04","2011-08-05","2011-08-06","2011-08-07","2011-08-08","2011-08-09","2011-08-10","2011-08-11","2011-08-12","2011-08-13","2011-08-14","2011-08-15","2011-08-16","2011-08-17","2011-08-18","2011-08-19","2011-08-20","2011-08-21","2011-08-22","2011-08-23","2011-08-24","2011-08-25","2011-08-26","2011-08-27","2011-08-28","2011-08-29","2011-08-30","2011-08-31","2011-09-01","2011-09-02","2011-09-03","2011-09-04","2011-09-05","2011-09-06","2011-09-07","2011-09-08","2011-09-09","2011-09-10","2011-09-11","2011-09-12","2011-09-13","2011-09-14","2011-09-15","2011-09-16","2011-09-17","2011-09-18","2011-09-19","2011-09-20","2011-09-21","2011-09-22","2011-09-23","2011-09-24","2011-09-25","2011-09-26","2011-09-27","2011-09-28","2011-09-29","2011-09-30","2011-10-01","2011-10-02","2011-10-03","2011-10-04","2011-10-05","2011-10-06","2011-10-07","2011-10-08","2011-10-09","2011-10-10","2011-10-11","2011-10-12","2011-10-13","2011-10-14","2011-10-15","2011-10-16","2011-10-17","2011-10-18","2011-10-19","2011-10-20","2011-10-21","2011-10-22","2011-10-23","2011-10-24","2011-10-25","2011-10-26","2011-10-27","2011-10-28","2011-10-29","2011-10-30","2011-10-31","2011-11-01","2011-11-02","2011-11-03","2011-11-04","2011-11-05","2011-11-06","2011-11-07","2011-11-08","2011-11-09","2011-11-10","2011-11-11","2011-11-12","2011-11-13","2011-11-14","2011-11-15","2011-11-16","2011-11-17","2011-11-18","2011-11-19","2011-11-20","2011-11-21","2011-11-22","2011-11-23","2011-11-24","2011-11-25","2011-11-26","2011-11-27","2011-11-28","2011-11-29","2011-11-30","2011-12-01","2011-12-02","2011-12-03","2011-12-04","2011-12-05","2011-12-06","2011-12-07","2011-12-08","2011-12-09","2011-12-10","2011-12-11","2011-12-12","2011-12-13","2011-12-14","2011-12-15","2011-12-16","2011-12-17","2011-12-18","2011-12-19","2011-12-20","2011-12-21","2011-12-22","2011-12-23","2011-12-24","2011-12-25","2011-12-26","2011-12-27","2011-12-28","2011-12-29","2011-12-30","2011-12-31","2012-01-01","2012-01-02","2012-01-03","2012-01-04","2012-01-05","2012-01-06","2012-01-07","2012-01-08","2012-01-09","2012-01-10","2012-01-11","2012-01-12","2012-01-13","2012-01-14","2012-01-15","2012-01-16","2012-01-17","2012-01-18","2012-01-19","2012-01-20","2012-01-21","2012-01-22","2012-01-23","2012-01-24","2012-01-25","2012-01-26","2012-01-27","2012-01-28","2012-01-29","2012-01-30","2012-01-31","2012-02-01","2012-02-02","2012-02-03","2012-02-04","2012-02-05","2012-02-06","2012-02-07","2012-02-08","2012-02-09","2012-02-10","2012-02-11","2012-02-12","2012-02-13","2012-02-14","2012-02-15","2012-02-16","2012-02-17","2012-02-18","2012-02-19","2012-02-20","2012-02-21","2012-02-22","2012-02-23","2012-02-24","2012-02-25","2012-02-26","2012-02-27","2012-02-28","2012-02-29","2012-03-01","2012-03-02","2012-03-03","2012-03-04","2012-03-05","2012-03-06","2012-03-07","2012-03-08","2012-03-09","2012-03-10","2012-03-11","2012-03-12","2012-03-13","2012-03-14","2012-03-15","2012-03-16","2012-03-17","2012-03-18","2012-03-19","2012-03-20","2012-03-21","2012-03-22","2012-03-23","2012-03-24","2012-03-25","2012-03-26","2012-03-27","2012-03-28","2012-03-29","2012-03-30","2012-03-31","2012-04-01","2012-04-02","2012-04-03","2012-04-04","2012-04-05","2012-04-06","2012-04-07","2012-04-08","2012-04-09","2012-04-10","2012-04-11","2012-04-12","2012-04-13","2012-04-14","2012-04-15","2012-04-16","2012-04-17","2012-04-18","2012-04-19","2012-04-20","2012-04-21","2012-04-22","2012-04-23","2012-04-24","2012-04-25","2012-04-26","2012-04-27","2012-04-28","2012-04-29","2012-04-30","2012-05-01","2012-05-02","2012-05-03","2012-05-04","2012-05-05","2012-05-06","2012-05-07","2012-05-08","2012-05-09","2012-05-10","2012-05-11","2012-05-12","2012-05-13","2012-05-14","2012-05-15","2012-05-16","2012-05-17","2012-05-18","2012-05-19","2012-05-20","2012-05-21","2012-05-22","2012-05-23","2012-05-24","2012-05-25","2012-05-26","2012-05-27","2012-05-28","2012-05-29","2012-05-30","2012-05-31","2012-06-01","2012-06-02","2012-06-03","2012-06-04","2012-06-05","2012-06-06","2012-06-07","2012-06-08","2012-06-09","2012-06-10","2012-06-11","2012-06-12","2012-06-13","2012-06-14","2012-06-15","2012-06-16","2012-06-17","2012-06-18","2012-06-19","2012-06-20","2012-06-21","2012-06-22","2012-06-23","2012-06-24","2012-06-25","2012-06-26","2012-06-27","2012-06-28","2012-06-29","2012-06-30","2012-07-01","2012-07-02","2012-07-03","2012-07-04","2012-07-05","2012-07-06","2012-07-07","2012-07-08","2012-07-09","2012-07-10","2012-07-11","2012-07-12","2012-07-13","2012-07-14","2012-07-15","2012-07-16","2012-07-17","2012-07-18","2012-07-19","2012-07-20","2012-07-21","2012-07-22","2012-07-23","2012-07-24","2012-07-25","2012-07-26","2012-07-27","2012-07-28","2012-07-29","2012-07-30","2012-07-31","2012-08-01","2012-08-02","2012-08-03","2012-08-04","2012-08-05","2012-08-06","2012-08-07","2012-08-08","2012-08-09","2012-08-10","2012-08-11","2012-08-12","2012-08-13","2012-08-14","2012-08-15","2012-08-16","2012-08-17","2012-08-18","2012-08-19","2012-08-20","2012-08-21","2012-08-22","2012-08-23","2012-08-24","2012-08-25","2012-08-26","2012-08-27","2012-08-28","2012-08-29","2012-08-30","2012-08-31","2012-09-01","2012-09-02","2012-09-03","2012-09-04","2012-09-05","2012-09-06","2012-09-07","2012-09-08","2012-09-09","2012-09-10","2012-09-11","2012-09-12","2012-09-13","2012-09-14","2012-09-15","2012-09-16","2012-09-17","2012-09-18","2012-09-19","2012-09-20","2012-09-21","2012-09-22","2012-09-23","2012-09-24","2012-09-25","2012-09-26","2012-09-27","2012-09-28","2012-09-29","2012-09-30","2012-10-01","2012-10-02","2012-10-03","2012-10-04","2012-10-05","2012-10-06","2012-10-07","2012-10-08","2012-10-09","2012-10-10","2012-10-11","2012-10-12","2012-10-13","2012-10-14","2012-10-15","2012-10-16","2012-10-17","2012-10-18","2012-10-19","2012-10-20","2012-10-21","2012-10-22","2012-10-23","2012-10-24","2012-10-25","2012-10-26","2012-10-27","2012-10-28","2012-10-29","2012-10-30","2012-10-31","2012-11-01","2012-11-02","2012-11-03","2012-11-04","2012-11-05","2012-11-06","2012-11-07","2012-11-08","2012-11-09","2012-11-10","2012-11-11","2012-11-12","2012-11-13","2012-11-14","2012-11-15","2012-11-16","2012-11-17","2012-11-18","2012-11-19","2012-11-20","2012-11-21","2012-11-22","2012-11-23","2012-11-24","2012-11-25","2012-11-26","2012-11-27","2012-11-28","2012-11-29","2012-11-30","2012-12-01","2012-12-02","2012-12-03","2012-12-04","2012-12-05","2012-12-06","2012-12-07","2012-12-08","2012-12-09","2012-12-10","2012-12-11","2012-12-12","2012-12-13","2012-12-14","2012-12-15","2012-12-16","2012-12-17","2012-12-18","2012-12-19","2012-12-20","2012-12-21","2012-12-22","2012-12-23","2012-12-24","2012-12-25","2012-12-26","2012-12-27","2012-12-28","2012-12-29","2012-12-30","2012-12-31"],"y":[0.415954007084882,0.395944964333558,0.636614801435719,0.456764555339888,0.398019001252092,0.378872703641676,0.360647419126196,0.343298843311231,0.855740200452448,0.614228905070986,0.432012459970322,0.363432414434183,0.345949869263879,0.329308304076353,0.313467264388316,0.798281755489244,0.709161725296287,0.49922152091019,1.21254982363727,1.01242316350861,0.735976106761341,0.527024606853043,0.387017888988286,0.368400788649322,0.35067924491095,0.333810177937415,0.317752580204467,0.322299496474281,0.337304383458449,0.320489997551761,0.305073153494105,0.290397920976633,0.290222652674117,0.277864626812988,0.281786927137861,0.268231854760075,0.262708024064899,0.276191481394268,0.272304045413518,0.261056002389378,0.926043073372548,0.849338455750015,0.597022998255615,0.407166500627975,0.312666708429952,0.297626195706597,0.29346747633847,0.279350523069208,0.301406518835014,0.279805882222986,0.266346105987848,0.865295213470709,3.16545738208036,2.36287746352821,19.3699159848956,35.2683010135326,9.49035511004157,4.71277217088122,3.55273978559019,2.67061707201177,3.02163875422112,2.99430420560923,2.73463396964125,2.05376069892262,1.53636520813752,1.14347448360811,0.845393401143647,0.619496674408474,0.70485360442842,13.5564440373697,5.67504203978964,4.44007679023575,3.36414075352958,2.54517800059099,1.92199104092985,2.68607645043102,2.03100278668163,1.53258208072016,2.05341941406221,3.2214047579444,3.40435407011163,5.40977519559614,4.11059470887862,3.37784629358171,2.56331851073324,1.94314088307543,1.47103851563049,1.11174989517058,0.83840594162555,0.630532778160912,4.14128663298667,3.82658951609061,2.90875693826033,2.97278779396204,3.23809477252616,2.46129898490618,1.86965888471491,1.41909797005755,1.07602946371616,0.814860004946245,0.616087397700046,0.570885658658625,8.83318690956056,4.8186825847209,3.667976286537,2.79129927222297,2.12343064628939,1.61467079217924,2.67167196921607,2.03276828139354,1.54605658263282,1.17531202283157,0.892930647775599,0.677877838974299,0.535253850037416,0.509506010166207,15.300301661234,5.94957703628408,4.52628450029549,3.44205611632308,2.61618640893112,1.9871764845092,1.50816333675215,1.14343685754624,0.865785708269766,0.654474804730856,0.520777437603265,20.758168455313,19.5870462617946,5.77559466278235,4.39590962957749,3.34480528760487,2.54407604652534,1.93412774642454,1.46954860526866,1.11573416418306,0.846315407096068,0.641198920591554,0.524976504821878,0.499723046147352,0.475684379314306,0.452802068001712,0.431020486908096,0.410286686530304,0.390550264446964,0.371763242793714,0.838894351516101,2.86222922423286,3.16642076831693,2.38324614547008,1.78787253584867,1.33553969131303,0.992142410425228,0.731694762523551,0.534397766526227,0.430696372055102,0.409978162891337,0.390256582022595,0.371483687662469,0.353613844215232,0.336603611338887,0.32041163834473,0.30499856367671,0.290326919226236,0.276361039249817,0.263066973668135,0.250412405535767,0.238366572480949,0.226900191924398,0.215985389895402,0.20559563327215,0.195705665281558,0.186291444101821,0.177330084418421,0.168799801791525,0.160679859699532,0.152950519130038,0.145592990595674,0.138589388458173,0.131922687449632,0.125576681285276,0.119535943267109,0.11378578878269,0.108312239607862,0.103101989926668,0.0981423739858402,0.0934213353052383,0.0889273973693867,0.0846496357288673,0.080577651443746,0.0767015458044747,0.0730118962688203,0.0694997335563213,0.0661565198445941,0.0629741280144821,1.93765372237364,1.38801110234141,0.973427551711826,0.661557747325242,0.427763545703221,0.253279405626947,0.189334723044177,0.180226969534958,0.171557335207741,0.16330474478667,0.155449136800511,0.147971414814621,0.140853401008841,0.134077791988491,0.12762811672102,0.12148869649608,28.2653020816016,7.44908180049427,4.37674143407692,3.26455631429428,2.42043954841087,5.32393170404278,3.99605184817242,2.98710279269039,2.22104652429984,1.63994683226602,1.19966123558737,2.40334073559406,4.59476844724434,3.45819113412139,2.59416437181265,1.93772855576947,1.43938753870611,1.06142850885029,0.775117650207906,0.55856317152766,0.398722650720937,0.379542504771367,0.361285000156524,0.343905754157173,0.327362519039467,0.311615079353653,0.296625154173122,0.282356304036148,0.268773842364101,2.40229723477508,4.78791452951259,3.59965072043814,3.25832185114898,3.90309770619741,6.70115273097974,21.8057324023604,36.2633487759752,21.053001674425,14.9103214309309,8.65968952858015,4.67976072625008,3.5362542368898,16.6507469806818,10.6680601447905,9.9017380921708,12.2615267383322,6.5968146574133,7.50076785821346,15.4681827909337,14.2306287297464,10.9162665929228,20.5240717292608,6.35413191830483,6.66493464769052,4.65250501181704,3.53036457262873,2.67598368462098,2.02560807401387,1.54724569635421,4.16536921944065,3.37025252616423,2.55708679452065,1.93796849548395,1.46669374411101,1.1080551882538,0.835225067186213,0.627761035404486,0.502959526465761,0.478765172051993,1.68433090972997,6.60122206418962,4.808462579491,4.238874328491,4.2449075428976,5.93514894196827,5.09046695704564,7.914779986757,4.87631409298261,5.41453815832224,4.11743418866772,3.12941952186696,2.94403793669539,2.44834287560078,1.85865137760265,1.40962992883574,1.45987968657708,1.10638548497938,0.837306038731219,0.696819193161925,0.526365104484036,0.501044848640757,0.47694259784855,0.453999761218221,0.432160566315472,0.414658307629062,0.486654252718653,0.411104240628651,0.99136985030643,0.981404296662188,1.7609302137042,1.58397739377188,1.28648997045523,0.986234419991672,0.99464770595166,1.01219823477914,0.824841519700817,0.611285781176061,0.466170789075917,0.660008484380875,1.39158594727629,2.79723760620215,2.21189539787642,2.04999226160324,1.58428300120362,1.28107303733679,0.964561299433196,0.761979803663587,0.604910595490768,0.492024271412332,0.541557510975786,0.478319200031942,0.455310143359325,0.827500795633903,0.612954189027725,0.467262583676583,0.687321651230999,0.50829418026507,0.457515187726437,0.435506886821356,0.418394866508759,0.39826840870738,0.379110113606015,0.360873408726636,0.343513961912715,0.366123328080197,0.338505435821704,0.322221977502886,0.306721818318326,0.291967278463051,0.27792249068063,0.264553313072375,0.260955215711614,0.253195329829413,0.241015627043286,0.229421816422147,0.2310112349107,0.221129205452236,0.210492010834329,0.200366507601139,0.193095537857189,0.184701021040637,0.178235025285098,0.169661211401909,0.162202332162507,0.166990071542739,0.160238010402153,0.160306124933645,0.190478106960489,0.172307100623784,0.164018443503011,0.156128503768911,0.44549604756247,2.73992136932118,3.57041498749075,2.65578689222793,1.99983612057942,1.49095113259383,1.08011141631058,4.72761734261738,4.25263743929752,3.19229348004028,2.38660797009081,2.852511650551,2.13200472793104,1.98832157489149,60.6631247652726,17.3664313285937,5.44635136167959,4.11768652971187,3.10677566725261,2.33792641162596,1.7534627916421,2.86327655413919,5.68373619173545,5.75433614423136,11.2220673618927,7.41924365349812,4.61616138177278,3.49773931479587,2.64642909944224,1.99861918815549,1.50583810141723,1.13115138848806,3.18327527794398,2.41093720163925,1.82310710686247,1.3758427561986,1.03566064147634,1.03855070764126,0.779833969031817,2.03442494379118,2.02597502461322,1.95927432970022,1.48352049389094,1.12144032031729,0.84596052670744,0.63645160779594,4.26249491731188,12.0172427980812,8.68803818611276,22.491987801093,7.77467679526952,4.86967446864221,4.07840663111264,3.10233184129151,2.35880250295955,1.79246621650644,1.3611435930324,1.0326933992881,0.782623715997436,0.59227157819108,1.06017474388453,13.8203551319365,8.3551171589471,5.78808477711309,4.68842479813551,3.56964813366611,3.41295938963613,3.97788236872601,3.02861607924582,2.42619590053676,1.84643717036072,1.81935901452155,1.38423558153702,1.05276404935062,2.15152831391323,1.63765501454034,1.24615967096241,0.947915271081379,1.02214709004547,1.74537376408805,1.32856227855856,1.01101100437764,0.769095280311244,0.584812647311485,0.526121088822356,0.500812571103302,0.476721493784839,0.45378929313971,2.60212220448728,2.10383282469831,1.58613931866504,1.19246263538676,1.68337883876205,1.3726556933503,2.25933078528743,1.92459786066889,1.45392011064505,1.09586082745963,0.823590488007127,0.616665691529588,0.498048400056419,0.47409029036348,0.451284661072032,0.732901240273748,2.29248972661527,2.13348632332087,1.60914546643158,2.00601469326509,6.79427773177759,4.6643553033979,3.54071101537609,2.6851208397941,2.03376345083066,1.53800681701045,2.10020287564451,4.72958425598367,3.59391297429085,2.72898974911008,2.07036025688486,1.56890971587544,1.20233904569593,1.39534717207535,1.05573608864255,5.52768559900423,4.60709724751126,3.50421399856718,2.66410105904989,2.02421101812216,1.53688180724694,1.16579435051916,2.4420228301503,1.85603831581002,1.40973571521712,1.06986323681298,0.811082668929654,0.614086132712925,0.519742140941557,0.494740475996322,0.470941490612343,0.707372102713068,2.97951688357811,2.2563848031428,1.70601650146045,1.28726620736015,0.968781314671543,0.726671794515612,0.542734228988439,0.480637014935848,0.45751646214416,0.435508099934516,0.414558427514701,0.394616517693478,0.375633893080137,0.357564408239346,0.340364137514816,0.3239912682491,0.308405999139939,0.293570443486075,0.279448537087324,0.266005950575027,0.253210005959746,0.241029597193357,0.229435114552414,0.218398372658983,0.207892541963953,0.197892083526275,0.188372686929579,0.179311211185251,0.170685628478303,0.162474970619291,0.154659278072114,0.147219551433774,0.14013770524815,0.133396524041521,0.126979620472949,0.120871395497798,0.115057000447544,0.1095223009337,0.104253842488105,0.0992388178560458,0.0944650358627226,0.0899208917773482,0.0855953391028599,0.081477862722656,0.077558453339081,0.073827583141522,0.0702761826449662,1.04907712953657,0.881394273340197,0.588628285176971,0.36952627879469,0.206366087453962,1.30824873476215,1.70919255547069,1.23756921640449,0.881300700454256,0.612785499617317,0.410997751273143,0.280535987821568,0.267041090602171,0.254195351632938,0.241967543819145,0.230327942213571,0.219248251757228,0.208701538496048,0.198662164106315,0.1891057235697,4.23529745752706,5.08663461287894,3.81357713963722,3.35535179568584,8.99838743678387,14.2858923685069,10.1246802713479,6.73169432214939,10.7055677129999,12.3736628156906,17.4716109096855,5.42885176963528,4.09870987607728,3.08694483182929,2.3177029910365,1.73318610839643,1.47431606587703,1.97296924285728,2.09356595015979,1.56828757754646,1.16931341574579,1.53123902987746,1.27771952812665,0.951434818976133,0.832002295545724,0.613872875318894,0.455090832113091,0.433199152359112,0.412360549504586,0.392524366360633,0.373642382550718,0.371602392828486,2.06197407641307,1.53852673214312,1.14122142985704,0.839963936278103,0.611825289389312,0.439336479452875,0.40118323426313,0.381884724454936,0.363514549754018,0.346028053548027,0.329382727385351,0.313538107640034,1.30333290420724,3.32066792203773,10.903717774419,5.21378884696967,3.93574490276139,4.87801122576534,4.17174959702982,3.14681143291754,2.36732888355513,1.77481560607835,4.34985557468725,3.56099000600417,3.08762403560402,4.97339821483842,3.92217515317348,2.96711462698368,2.2403763022501,5.52636842399164,5.14738880148856,10.9998846360564,5.61877307600057,4.26552075660911,3.23508253791273,2.86651518530976,23.6906433746388,12.7843807047114,5.55014832091883,4.21735817697953,3.20231394872108,2.42937280184949,2.09383187283896,1.9500810866667,1.4766332034675,1.11630454106858,1.50639152807002,1.13981958600455,0.860871201671699,0.754886108058512,13.990899537993,5.33516478491895,4.05921443651505,3.08721044341554,20.534930158943,9.85145659043872,5.93433094776881,4.60618071789739,4.96003484378218,3.92589524363436,4.48466710934826,3.4291002221182,2.60920351076723,1.98460615577907,3.95765001846561,7.95310610325306,4.74450575882409,3.61242135649529,2.74988807242984,2.09275293929225,1.59213002228979,1.21076725613099,0.920277878741785,0.699030710715013,0.539766373530549,0.513801463324753,0.489085568609837,3.07483937634748,2.41670134019399,2.25436294464819,1.70744717246502,1.29118486260138,0.974459820708574,0.819293167523731,0.637649473707467,0.505015776683973,1.38792260528507,1.04899413554172,0.791137221655385,0.595039001273618,0.501415474262825,0.477295394903539,0.454335587331146,0.43248023785617,0.411676217649674,0.391872953590783,0.373022305326959,0.360011997572288,0.346313179646229,0.346727049062721,0.330496186622706,0.314598005057805,0.299464589282349,0.28505915101899,0.271346671652897,0.267231088990682,0.271945048726882,0.258863409859832,0.25715302458393,0.247519002929374,0.26032007754389,0.473918909294047,0.30827366384763,0.277096613198232,0.286845332238531,0.273046930448866,0.259912286686787,0.247409471550187,0.390363104636602,0.269249841634682,0.256297852952538,0.243968906459776,1.46679863391818,18.853045792186,9.42152906896103,5.56221540409855,4.19041021440988,3.14737412296227,3.40876869127495,2.55604562466178,2.17921288545746,1.62299046406366,1.20094420400765,0.881056684156316,0.638933964781061,0.455991200668642,0.38773737285874,0.369085662482902,0.351331173588138,0.334430746251316,0.965734075276143,2.38146827761183,1.77717027553225,1.31848645697443,1.02743944615753,0.750529669888538,1.22096044426919,0.901040609066168,1.43190797725935,2.50958322997077,1.88704248444471,1.41386816632431,3.21306244495795,2.42659435698087,1.82833553897584,1.37344665163042,1.02776135502051,0.765246302221708,0.566065592376581,0.459977065054461,0.437850338054509,0.416787994661754,17.7554076576796,6.70452694265504,4.54081490080757,3.43794462053016,3.15121634784968,2.81650334925693,2.12703598326584,1.60256777617063,1.35029070712231,1.10233394321132,2.2829694756289,1.95976103880588,1.92865268935512,2.93611889425327,2.22444850938956,3.66709737141181,3.35592739927856,2.57548358113942,3.10640999802858,2.94496357545869,2.36591613252045,1.79371892028646,2.60815052856312,2.02300704441445,2.10981331726002,1.60020331990759,2.54781686708639,2.40468674640733,1.92938170315272,1.46405739662164,1.10976529524513,5.81134642785376,5.31207038976766,4.26368111127409,3.24420650710504,2.46757213426049,1.87597730786922,1.42537690354648,1.08220787470985,0.820894772780314,0.621948888282358,3.18962610845788,16.5742392816522,5.97383520064222,4.54927018912595,3.51829126806037,2.67835739433862,2.03843404349225,1.55091785301183,1.17953408971986,0.896640723577892,1.0066329059787,0.862287617599783,0.655192323094362,0.534420625391415,0.508712866940938,2.62723833046422,1.99405394281467,1.51193403463465,1.14491083926574,0.865576847319272,0.653047650892121,0.515485605349803,0.490688696702566,0.46708461802396,0.444615989446426,0.43156917525717,0.535764179586294,0.431512406403446,0.410754942740663,0.390995995670493,0.372187532571901,0.354283831384041,0.337241369459111,0.32101871776184,0.305576440158391,0.773012504517547,1.26466317889254,2.84254903986125,2.12560811664622,1.58122775705999,1.99920832242619,1.54254621011479,5.79045032912729,4.38083317341742,3.30818955087206,2.49225551627521,1.87187132673642,1.40043498122287,1.04243770467038,0.770823902305496,3.98607231381077,3.83542563424149,2.90239164064782,11.8584348578431,5.02503575605568,3.81169780094169,2.88794440610819,2.18482163784089,1.64978671047962,1.24280247676199,0.933361329894546,0.698217341911962,0.519658096755767,0.4715101154008],"name":"Modeled","type":"scatter","mode":"lines","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2010-08-07","2010-08-08","2010-08-09","2010-08-10","2010-08-11","2010-08-12","2010-08-13","2010-08-14","2010-08-15","2010-08-16","2010-08-17","2010-08-18","2010-08-19","2010-08-20","2010-08-21","2010-08-22","2010-08-23","2010-08-24","2010-08-25","2010-08-26","2010-08-27","2010-08-28","2010-08-29","2010-08-30","2010-08-31","2010-09-01","2010-09-02","2010-09-03","2010-09-04","2010-09-05","2010-09-06","2010-09-07","2010-09-08","2010-09-09","2010-09-10","2010-09-11","2010-09-12","2010-09-13","2010-09-14","2010-09-15","2010-09-16","2010-09-17","2010-09-18","2010-09-19","2010-09-20","2010-09-21","2010-09-22","2010-09-23","2010-09-24","2010-09-25","2010-09-26","2010-09-27","2010-09-28","2010-09-29","2010-09-30","2010-10-01","2010-10-02","2010-10-03","2010-10-04","2010-10-05","2010-10-06","2010-10-07","2010-10-08","2010-10-09","2010-10-10","2010-10-11","2010-10-12","2010-10-13","2010-10-14","2010-10-15","2010-10-16","2010-10-17","2010-10-18","2010-10-19","2010-10-20","2010-10-21","2010-10-22","2010-10-23","2010-10-24","2010-10-25","2010-10-26","2010-10-27","2010-10-28","2010-10-29","2010-10-30","2010-10-31","2010-11-01","2010-11-02","2010-11-03","2010-11-04","2010-11-05","2010-11-06","2010-11-07","2010-11-08","2010-11-09","2010-11-10","2010-11-11","2010-11-12","2010-11-13","2010-11-14","2010-11-15","2010-11-16","2010-11-17","2010-11-18","2010-11-19","2010-11-20","2010-11-21","2010-11-22","2010-11-23","2010-11-24","2010-11-25","2010-11-26","2010-11-27","2010-11-28","2010-11-29","2010-11-30","2010-12-01","2010-12-02","2010-12-03","2010-12-04","2010-12-05","2010-12-06","2010-12-07","2010-12-08","2010-12-09","2010-12-10","2010-12-11","2010-12-12","2010-12-13","2010-12-14","2010-12-15","2010-12-16","2010-12-17","2010-12-18","2010-12-19","2010-12-20","2010-12-21","2010-12-22","2010-12-23","2010-12-24","2010-12-25","2010-12-26","2010-12-27","2010-12-28","2010-12-29","2010-12-30","2010-12-31","2011-01-01","2011-01-02","2011-01-03","2011-01-04","2011-01-05","2011-01-06","2011-01-07","2011-01-08","2011-01-09","2011-01-10","2011-01-11","2011-01-12","2011-01-13","2011-01-14","2011-01-15","2011-01-16","2011-01-17","2011-01-18","2011-01-19","2011-01-20","2011-01-21","2011-01-22","2011-01-23","2011-01-24","2011-01-25","2011-01-26","2011-01-27","2011-01-28","2011-01-29","2011-01-30","2011-01-31","2011-02-01","2011-02-02","2011-02-03","2011-02-04","2011-02-05","2011-02-06","2011-02-07","2011-02-08","2011-02-09","2011-02-10","2011-02-11","2011-02-12","2011-02-13","2011-02-14","2011-02-15","2011-02-16","2011-02-17","2011-02-18","2011-02-19","2011-02-20","2011-02-21","2011-02-22","2011-02-23","2011-02-24","2011-02-25","2011-02-26","2011-02-27","2011-02-28","2011-03-01","2011-03-02","2011-03-03","2011-03-04","2011-03-05","2011-03-06","2011-03-07","2011-03-08","2011-03-09","2011-03-10","2011-03-11","2011-03-12","2011-03-13","2011-03-14","2011-03-15","2011-03-16","2011-03-17","2011-03-18","2011-03-19","2011-03-20","2011-03-21","2011-03-22","2011-03-23","2011-03-24","2011-03-25","2011-03-26","2011-03-27","2011-03-28","2011-03-29","2011-03-30","2011-03-31","2011-04-01","2011-04-02","2011-04-03","2011-04-04","2011-04-05","2011-04-06","2011-04-07","2011-04-08","2011-04-09","2011-04-10","2011-04-11","2011-04-12","2011-04-13","2011-04-14","2011-04-15","2011-04-16","2011-04-17","2011-04-18","2011-04-19","2011-04-20","2011-04-21","2011-04-22","2011-04-23","2011-04-24","2011-04-25","2011-04-26","2011-04-27","2011-04-28","2011-04-29","2011-04-30","2011-05-01","2011-05-02","2011-05-03","2011-05-04","2011-05-05","2011-05-06","2011-05-07","2011-05-08","2011-05-09","2011-05-10","2011-05-11","2011-05-12","2011-05-13","2011-05-14","2011-05-15","2011-05-16","2011-05-17","2011-05-18","2011-05-19","2011-05-20","2011-05-21","2011-05-22","2011-05-23","2011-05-24","2011-05-25","2011-05-26","2011-05-27","2011-05-28","2011-05-29","2011-05-30","2011-05-31","2011-06-01","2011-06-02","2011-06-03","2011-06-04","2011-06-05","2011-06-06","2011-06-07","2011-06-08","2011-06-09","2011-06-10","2011-06-11","2011-06-12","2011-06-13","2011-06-14","2011-06-15","2011-06-16","2011-06-17","2011-06-18","2011-06-19","2011-06-20","2011-06-21","2011-06-22","2011-06-23","2011-06-24","2011-06-25","2011-06-26","2011-06-27","2011-06-28","2011-06-29","2011-06-30","2011-07-01","2011-07-02","2011-07-03","2011-07-04","2011-07-05","2011-07-06","2011-07-07","2011-07-08","2011-07-09","2011-07-10","2011-07-11","2011-07-12","2011-07-13","2011-07-14","2011-07-15","2011-07-16","2011-07-17","2011-07-18","2011-07-19","2011-07-20","2011-07-21","2011-07-22","2011-07-23","2011-07-24","2011-07-25","2011-07-26","2011-07-27","2011-07-28","2011-07-29","2011-07-30","2011-07-31","2011-08-01","2011-08-02","2011-08-03","2011-08-04","2011-08-05","2011-08-06","2011-08-07","2011-08-08","2011-08-09","2011-08-10","2011-08-11","2011-08-12","2011-08-13","2011-08-14","2011-08-15","2011-08-16","2011-08-17","2011-08-18","2011-08-19","2011-08-20","2011-08-21","2011-08-22","2011-08-23","2011-08-24","2011-08-25","2011-08-26","2011-08-27","2011-08-28","2011-08-29","2011-08-30","2011-08-31","2011-09-01","2011-09-02","2011-09-03","2011-09-04","2011-09-05","2011-09-06","2011-09-07","2011-09-08","2011-09-09","2011-09-10","2011-09-11","2011-09-12","2011-09-13","2011-09-14","2011-09-15","2011-09-16","2011-09-17","2011-09-18","2011-09-19","2011-09-20","2011-09-21","2011-09-22","2011-09-23","2011-09-24","2011-09-25","2011-09-26","2011-09-27","2011-09-28","2011-09-29","2011-09-30","2011-10-01","2011-10-02","2011-10-03","2011-10-04","2011-10-05","2011-10-06","2011-10-07","2011-10-08","2011-10-09","2011-10-10","2011-10-11","2011-10-12","2011-10-13","2011-10-14","2011-10-15","2011-10-16","2011-10-17","2011-10-18","2011-10-19","2011-10-20","2011-10-21","2011-10-22","2011-10-23","2011-10-24","2011-10-25","2011-10-26","2011-10-27","2011-10-28","2011-10-29","2011-10-30","2011-10-31","2011-11-01","2011-11-02","2011-11-03","2011-11-04","2011-11-05","2011-11-06","2011-11-07","2011-11-08","2011-11-09","2011-11-10","2011-11-11","2011-11-12","2011-11-13","2011-11-14","2011-11-15","2011-11-16","2011-11-17","2011-11-18","2011-11-19","2011-11-20","2011-11-21","2011-11-22","2011-11-23","2011-11-24","2011-11-25","2011-11-26","2011-11-27","2011-11-28","2011-11-29","2011-11-30","2011-12-01","2011-12-02","2011-12-03","2011-12-04","2011-12-05","2011-12-06","2011-12-07","2011-12-08","2011-12-09","2011-12-10","2011-12-11","2011-12-12","2011-12-13","2011-12-14","2011-12-15","2011-12-16","2011-12-17","2011-12-18","2011-12-19","2011-12-20","2011-12-21","2011-12-22","2011-12-23","2011-12-24","2011-12-25","2011-12-26","2011-12-27","2011-12-28","2011-12-29","2011-12-30","2011-12-31","2012-01-01","2012-01-02","2012-01-03","2012-01-04","2012-01-05","2012-01-06","2012-01-07","2012-01-08","2012-01-09","2012-01-10","2012-01-11","2012-01-12","2012-01-13","2012-01-14","2012-01-15","2012-01-16","2012-01-17","2012-01-18","2012-01-19","2012-01-20","2012-01-21","2012-01-22","2012-01-23","2012-01-24","2012-01-25","2012-01-26","2012-01-27","2012-01-28","2012-01-29","2012-01-30","2012-01-31","2012-02-01","2012-02-02","2012-02-03","2012-02-04","2012-02-05","2012-02-06","2012-02-07","2012-02-08","2012-02-09","2012-02-10","2012-02-11","2012-02-12","2012-02-13","2012-02-14","2012-02-15","2012-02-16","2012-02-17","2012-02-18","2012-02-19","2012-02-20","2012-02-21","2012-02-22","2012-02-23","2012-02-24","2012-02-25","2012-02-26","2012-02-27","2012-02-28","2012-02-29","2012-03-01","2012-03-02","2012-03-03","2012-03-04","2012-03-05","2012-03-06","2012-03-07","2012-03-08","2012-03-09","2012-03-10","2012-03-11","2012-03-12","2012-03-13","2012-03-14","2012-03-15","2012-03-16","2012-03-17","2012-03-18","2012-03-19","2012-03-20","2012-03-21","2012-03-22","2012-03-23","2012-03-24","2012-03-25","2012-03-26","2012-03-27","2012-03-28","2012-03-29","2012-03-30","2012-03-31","2012-04-01","2012-04-02","2012-04-03","2012-04-04","2012-04-05","2012-04-06","2012-04-07","2012-04-08","2012-04-09","2012-04-10","2012-04-11","2012-04-12","2012-04-13","2012-04-14","2012-04-15","2012-04-16","2012-04-17","2012-04-18","2012-04-19","2012-04-20","2012-04-21","2012-04-22","2012-04-23","2012-04-24","2012-04-25","2012-04-26","2012-04-27","2012-04-28","2012-04-29","2012-04-30","2012-05-01","2012-05-02","2012-05-03","2012-05-04","2012-05-05","2012-05-06","2012-05-07","2012-05-08","2012-05-09","2012-05-10","2012-05-11","2012-05-12","2012-05-13","2012-05-14","2012-05-15","2012-05-16","2012-05-17","2012-05-18","2012-05-19","2012-05-20","2012-05-21","2012-05-22","2012-05-23","2012-05-24","2012-05-25","2012-05-26","2012-05-27","2012-05-28","2012-05-29","2012-05-30","2012-05-31","2012-06-01","2012-06-02","2012-06-03","2012-06-04","2012-06-05","2012-06-06","2012-06-07","2012-06-08","2012-06-09","2012-06-10","2012-06-11","2012-06-12","2012-06-13","2012-06-14","2012-06-15","2012-06-16","2012-06-17","2012-06-18","2012-06-19","2012-06-20","2012-06-21","2012-06-22","2012-06-23","2012-06-24","2012-06-25","2012-06-26","2012-06-27","2012-06-28","2012-06-29","2012-06-30","2012-07-01","2012-07-02","2012-07-03","2012-07-04","2012-07-05","2012-07-06","2012-07-07","2012-07-08","2012-07-09","2012-07-10","2012-07-11","2012-07-12","2012-07-13","2012-07-14","2012-07-15","2012-07-16","2012-07-17","2012-07-18","2012-07-19","2012-07-20","2012-07-21","2012-07-22","2012-07-23","2012-07-24","2012-07-25","2012-07-26","2012-07-27","2012-07-28","2012-07-29","2012-07-30","2012-07-31","2012-08-01","2012-08-02","2012-08-03","2012-08-04","2012-08-05","2012-08-06","2012-08-07","2012-08-08","2012-08-09","2012-08-10","2012-08-11","2012-08-12","2012-08-13","2012-08-14","2012-08-15","2012-08-16","2012-08-17","2012-08-18","2012-08-19","2012-08-20","2012-08-21","2012-08-22","2012-08-23","2012-08-24","2012-08-25","2012-08-26","2012-08-27","2012-08-28","2012-08-29","2012-08-30","2012-08-31","2012-09-01","2012-09-02","2012-09-03","2012-09-04","2012-09-05","2012-09-06","2012-09-07","2012-09-08","2012-09-09","2012-09-10","2012-09-11","2012-09-12","2012-09-13","2012-09-14","2012-09-15","2012-09-16","2012-09-17","2012-09-18","2012-09-19","2012-09-20","2012-09-21","2012-09-22","2012-09-23","2012-09-24","2012-09-25","2012-09-26","2012-09-27","2012-09-28","2012-09-29","2012-09-30","2012-10-01","2012-10-02","2012-10-03","2012-10-04","2012-10-05","2012-10-06","2012-10-07","2012-10-08","2012-10-09","2012-10-10","2012-10-11","2012-10-12","2012-10-13","2012-10-14","2012-10-15","2012-10-16","2012-10-17","2012-10-18","2012-10-19","2012-10-20","2012-10-21","2012-10-22","2012-10-23","2012-10-24","2012-10-25","2012-10-26","2012-10-27","2012-10-28","2012-10-29","2012-10-30","2012-10-31","2012-11-01","2012-11-02","2012-11-03","2012-11-04","2012-11-05","2012-11-06","2012-11-07","2012-11-08","2012-11-09","2012-11-10","2012-11-11","2012-11-12","2012-11-13","2012-11-14","2012-11-15","2012-11-16","2012-11-17","2012-11-18","2012-11-19","2012-11-20","2012-11-21","2012-11-22","2012-11-23","2012-11-24","2012-11-25","2012-11-26","2012-11-27","2012-11-28","2012-11-29","2012-11-30","2012-12-01","2012-12-02","2012-12-03","2012-12-04","2012-12-05","2012-12-06","2012-12-07","2012-12-08","2012-12-09","2012-12-10","2012-12-11","2012-12-12","2012-12-13","2012-12-14","2012-12-15","2012-12-16","2012-12-17","2012-12-18","2012-12-19","2012-12-20","2012-12-21","2012-12-22","2012-12-23","2012-12-24","2012-12-25","2012-12-26","2012-12-27","2012-12-28","2012-12-29","2012-12-30","2012-12-31"],"y":[0.232,0.188,0.249,0.307,0.163,0.153,0.139,0.111,0.107,0.745,0.302,0.251,0.148,0.14,0.133,0.487,0.776,0.456,1.419,1.298,0.674,0.398,0.254,0.208,0.158,0.15,0.16,0.126,0.198,0.127,0.129,0.127,0.156,0.134,0.128,0.163,0.155,0.275,0.303,0.227,0.423,1.673,0.586,0.394,0.292,0.236,0.312,0.347,0.477,0.334,0.221,0.395,5.947,5.298,26.239,41.661,12.058,5.169,3.285,2.436,2.122,2.349,2.051,1.827,1.504,1.314,1.195,1.1,1.05,15.584,7.481,4.398,3.155,2.42,2.066,2.248,2.564,2.144,2.07,2.089,4.759,10.144,6.284,4.044,3.228,2.936,2.398,2.125,1.861,3.34,11.946,6.237,4.014,5.17,4.194,3.207,2.666,2.343,1.828,1.617,1.498,1.416,10.329,6.162,3.821,2.969,2.419,2.484,3.732,3.464,2.625,2.339,1.999,1.728,1.576,1.566,17.95,22.143,7.05,4.503,3.385,2.74,2.309,1.958,1.619,1.485,1.433,9.018,30.67,11.413,5.645,3.861,3.092,2.552,2.238,1.955,1.706,1.627,1.523,1.387,1.284,1.202,1.204,1.101,1.024,0.977,1.004,2.793,5.399,3.435,2.377,1.942,1.647,1.46,1.334,1.181,1.072,1.053,1.003,0.945,0.8,0.718,0.701,0.763,0.83,0.866,0.872,0.817,0.795,0.76,0.723,0.694,0.659,0.617,0.603,0.591,0.581,0.595,0.613,0.622,0.639,0.649,0.604,0.618,0.622,0.61,0.6,0.597,0.596,0.593,0.606,0.595,0.559,0.556,0.771,1.816,1.711,1.143,0.941,0.894,0.806,0.768,0.757,0.734,0.769,0.826,0.721,0.667,0.656,0.692,0.69,20.072,35.229,9.098,5.066,3.885,9.084,9.595,5.179,3.889,3.298,3.212,3.847,13.622,10.723,6.062,4.849,3.79,3.125,2.739,2.353,2.129,2.023,1.777,1.673,1.738,1.871,1.821,1.856,2.232,2.573,3.455,3.297,3.201,4.419,7.254,16.446,54.427,33.419,18.191,16.396,10.761,6.962,27.681,11.052,7.386,7.512,6.176,5.309,4.929,10.734,9.581,30.516,11.822,9.907,8.569,5.303,3.948,3.218,2.751,4.437,4.76,3.427,2.813,2.418,2.1,1.835,1.693,1.566,1.452,1.735,9.302,9.21,5.657,5.255,11.735,6.777,8.116,6.566,7.713,7.815,4.795,3.521,3.272,2.736,2.457,1.999,1.396,1.1,0.915,0.892,0.772,0.648,0.427,0.349,0.274,0.234,0.203,0.546,1.285,1.61,3.157,1.357,0.824,0.558,1.021,0.77,0.535,0.334,0.277,1.009,3.865,4.349,2.339,1.856,1.088,0.789,0.595,0.54,0.375,0.5,0.558,0.327,0.349,0.504,0.301,0.521,0.353,0.235,0.25,0.244,0.256,0.18,0.14,0.144,0.184,0.181,0.079,0.078,0.062,0.062,0.067,0.073,0.152,0.085,0.092,0.122,0.167,0.089,0.079,0.087,0.091,0.072,0.076,0.08,0.203,0.149,0.089,0.408,0.259,0.131,0.103,0.557,3.556,6.615,1.895,0.675,0.362,0.217,1.105,8.194,1.687,0.771,0.913,1.363,0.665,70.594,18.438,5.086,2.57,1.608,1.138,0.859,0.843,3.67,8.085,8.756,11.075,4.923,2.704,1.81,1.361,0.95,0.731,2.328,1.913,1.165,0.832,0.646,0.679,0.711,1.704,3.06,4.273,2.37,1.435,0.96,0.768,5.311,11.334,19.193,22.093,13.334,6.617,4.483,3.238,2.459,1.972,1.586,1.343,1.164,1.071,1.604,11.522,14.451,6.472,4.439,3.308,2.774,3.765,2.974,2.471,2.185,1.935,1.848,1.695,1.672,1.744,1.658,1.572,1.672,2.305,2.309,1.937,1.63,1.428,1.289,1.256,1.168,1.034,1.648,2.685,1.767,1.558,1.487,2.145,1.923,2.788,2.057,1.717,1.576,1.396,1.277,1.405,1.286,1.659,3.155,4.457,5.312,3.781,21.773,6.944,4.398,3.367,2.812,2.447,4.378,9.479,4.739,3.551,2.88,2.456,2.178,2.006,3.54,6.687,5.106,3.488,2.621,2.339,2.059,2.409,4.094,3.4,2.582,2.268,2.07,3.854,19.039,6.486,4.18,3.446,3.975,7.375,4.134,2.863,2.456,2.108,1.97,1.774,1.612,1.47,1.312,2.459,1.334,1.131,1.124,1.115,1.122,1.076,0.948,0.893,0.866,0.821,1.25,8.871,3.599,2.392,3.556,3.68,2.474,1.99,1.781,1.997,2.219,1.776,1.627,1.464,1.412,1.338,1.247,1.217,1.146,1.145,1.126,1.16,1.067,0.87,0.784,0.79,0.766,0.76,0.734,0.775,0.798,0.825,0.837,0.856,0.806,0.719,0.695,0.706,0.711,0.699,0.73,0.768,0.787,0.786,1.018,3.463,7.184,3.231,2.489,4.08,12.631,12.704,7.638,6.216,12.118,19.133,16.104,11.335,7.399,5.325,4.083,3.22,3.672,3.335,2.477,2.263,2.204,2.086,3.453,1.992,1.578,1.43,1.358,1.265,1.118,1.013,1.038,1.898,2.095,1.693,1.462,1.294,1.224,1.139,1.117,1.03,0.95,0.927,0.918,1.431,4.066,19.152,9.82,5.496,3.89,6.778,3.972,3.04,2.52,6.379,5.353,4.756,8.827,5.861,4.166,3.317,27.385,18.61,12.629,7.319,4.799,3.597,2.992,13.381,11.137,8.26,5.562,3.95,2.876,2.107,1.972,1.62,1.346,1.715,1.764,1.227,1.001,15.039,12.596,4.444,2.711,20.044,17.601,7.196,4.387,3.801,4.092,3.137,3.226,2.099,1.571,1.681,13.289,5.063,3.035,2.263,1.856,1.359,1.227,0.914,0.658,0.472,0.355,0.29,2.826,2.535,1.636,1.15,0.784,0.507,1.435,0.382,0.246,0.559,0.736,0.457,0.328,0.234,0.175,0.145,0.121,0.104,0.092,0.08,0.072,0.087,0.073,0.113,0.081,0.078,0.074,0.072,0.087,0.255,0.1,0.088,0.194,0.205,0.522,0.356,0.15,0.138,0.316,0.146,0.093,0.163,0.382,0.149,0.098,2.295,28.957,11.403,5.286,2.951,1.67,1.827,1.52,0.972,0.685,0.45,0.301,0.2,0.153,0.11,0.097,0.083,0.108,0.236,1.943,0.609,0.313,0.185,0.165,0.281,0.237,0.533,3.651,1.376,0.739,1.595,2.942,1.283,0.763,0.483,0.341,0.252,0.203,0.175,0.157,18.486,20.958,4.84,2.684,1.988,2.137,1.435,1.15,1.021,0.973,1.533,2.167,1.864,3.319,2.318,4.109,4.352,3.433,2.968,2.786,2.811,2.078,2.304,2.963,2.276,1.91,2.829,2.874,2.651,2.069,1.738,7.919,13.908,6.11,4.052,2.872,2.384,2.038,1.83,1.69,1.554,1.797,17.857,18.49,7.325,4.669,3.419,2.741,2.311,1.972,1.786,1.694,1.548,1.49,1.382,1.308,2.84,2.446,1.901,1.595,1.372,1.194,1.18,1.157,1.104,1.045,1.05,1.014,0.956,0.877,0.804,0.809,0.766,0.722,0.67,1.567,5.631,2.947,4.107,2.723,2.102,1.866,1.662,6.493,7.312,3.684,2.651,2.228,1.883,1.62,1.543,3.026,4.714,2.924,7.174,8.398,4.226,2.967,2.399,2.017,1.9,1.685,1.557,1.457,1.334],"name":"Measured","type":"scatter","mode":"lines","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="investigating-a-much-bigger-monte-carlo" class="section level2 hasAnchor" number="18.8">
<h2><span class="header-section-number">18.8</span> Investigating a much bigger Monte Carlo<a href="modelingcalibration.html#investigating-a-much-bigger-monte-carlo" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The next couple of code chunks make plots from a Monte Carlo I ran with 100,000 parameter sets.</p>
<p>We will look at the two plots and discuss.</p>
<p>How much difference was there in NSE in the top 100 runs of the 100,000 run set? How much would you expect the parameters to vary between these runs? What do you think it means if they did or did not vary much?</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="modelingcalibration.html#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="co">#the [,-1] drops the first column, which is just row numbers</span></span>
<span id="cb301-2"><a href="modelingcalibration.html#cb301-2" aria-hidden="true" tabindex="-1"></a>pars100 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;HBV/parsFrom100kRun.csv&quot;</span>)[,<span class="sc">-</span><span class="dv">1</span>]</span></code></pre></div>
<pre><code>## New names:
## Rows: 100 Columns: 15
## ── Column specification
## ──────────────────────────────────────────────────────── Delimiter: &quot;,&quot; dbl
## (15): ...1, FC, beta, LP, SFCF, TT, CFMAX, k0, k1, k2, UZL, PERC, MAXBAS...
## ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
## Specify the column types or set `show_col_types = FALSE` to quiet this message.
## • `` -&gt; `...1`</code></pre>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="modelingcalibration.html#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pars100, <span class="fu">aes</span>(NSE))<span class="sc">+</span></span>
<span id="cb303-2"><a href="modelingcalibration.html#cb303-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Hydroinformatics_Bookdown_files/figure-html/unnamed-chunk-187-1.png" width="672" /></p>
<p>The chunk below creates a parallel coordinate plot. Each parameter is shown, but normalized, where 1 is it’s maximum value from our random sets, and 0 is the minimum value.</p>
<p>Each connected line is a set of parameters. The green line is the set that had the highest NSE.</p>
<p>Look at this plot for a bit and discuss.</p>
<p>Are there any parameters that were always in the same range for these runs? What does that tell you about them?
Are there any parameters that look like they spanned almost the whole range for these runs? What doe sthat tell you about them?
What does this plot tell you about the model’s representation of the real world?</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="modelingcalibration.html#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="co">#filter the 100,000 run to the top ten</span></span>
<span id="cb305-2"><a href="modelingcalibration.html#cb305-2" aria-hidden="true" tabindex="-1"></a>rankedpars <span class="ot">&lt;-</span> <span class="fu">filter</span>(pars100, ranks <span class="sc">&lt;=</span> <span class="dv">10</span>)</span>
<span id="cb305-3"><a href="modelingcalibration.html#cb305-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-4"><a href="modelingcalibration.html#cb305-4" aria-hidden="true" tabindex="-1"></a><span class="co">#set the min and max values for each parameter for the plot</span></span>
<span id="cb305-5"><a href="modelingcalibration.html#cb305-5" aria-hidden="true" tabindex="-1"></a>mins <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">1</span>, <span class="fl">0.3</span> , <span class="fl">0.4</span>, <span class="sc">-</span><span class="fl">1.5</span>, <span class="dv">1</span>, <span class="fl">0.05</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb305-6"><a href="modelingcalibration.html#cb305-6" aria-hidden="true" tabindex="-1"></a>maxs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">400</span>, <span class="dv">6</span>, <span class="dv">1</span>, <span class="fl">1.2</span>, <span class="fl">1.2</span>, <span class="dv">8</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.15</span>, <span class="dv">70</span> , <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb305-7"><a href="modelingcalibration.html#cb305-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-8"><a href="modelingcalibration.html#cb305-8" aria-hidden="true" tabindex="-1"></a><span class="co">#add maxes and mins to the parameter sets</span></span>
<span id="cb305-9"><a href="modelingcalibration.html#cb305-9" aria-hidden="true" tabindex="-1"></a>rankedpars <span class="ot">&lt;-</span> <span class="fu">rbind</span>(rankedpars, mins, maxs)</span>
<span id="cb305-10"><a href="modelingcalibration.html#cb305-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-11"><a href="modelingcalibration.html#cb305-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Make NSE a character so the legend will work properly</span></span>
<span id="cb305-12"><a href="modelingcalibration.html#cb305-12" aria-hidden="true" tabindex="-1"></a>rankedpars <span class="ot">&lt;-</span> rankedpars <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">NSE =</span> <span class="fu">as.character</span>(<span class="fu">round</span>(NSE, <span class="dv">2</span>)))</span>
<span id="cb305-13"><a href="modelingcalibration.html#cb305-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-14"><a href="modelingcalibration.html#cb305-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Make the NSE equal &quot;Min/Max&quot; for appropriate legend labels</span></span>
<span id="cb305-15"><a href="modelingcalibration.html#cb305-15" aria-hidden="true" tabindex="-1"></a>rankedpars<span class="sc">$</span>NSE[rankedpars<span class="sc">$</span>NSE <span class="sc">==</span> <span class="st">&quot;0&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Min/Max&quot;</span></span>
<span id="cb305-16"><a href="modelingcalibration.html#cb305-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-17"><a href="modelingcalibration.html#cb305-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Make the ranks a factor datatype</span></span>
<span id="cb305-18"><a href="modelingcalibration.html#cb305-18" aria-hidden="true" tabindex="-1"></a>rankedpars <span class="ot">&lt;-</span> rankedpars <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">ranks =</span> <span class="fu">factor</span>(ranks))</span>
<span id="cb305-19"><a href="modelingcalibration.html#cb305-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-20"><a href="modelingcalibration.html#cb305-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Create parallel coordinate plot</span></span>
<span id="cb305-21"><a href="modelingcalibration.html#cb305-21" aria-hidden="true" tabindex="-1"></a>rankedpars <span class="sc">%&gt;%</span> <span class="fu">ggparcoord</span>(<span class="at">columns =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>, </span>
<span id="cb305-22"><a href="modelingcalibration.html#cb305-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">groupColumn =</span> <span class="dv">13</span>,</span>
<span id="cb305-23"><a href="modelingcalibration.html#cb305-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">showPoints =</span> <span class="cn">TRUE</span>,</span>
<span id="cb305-24"><a href="modelingcalibration.html#cb305-24" aria-hidden="true" tabindex="-1"></a>              <span class="at">scale =</span> <span class="st">&quot;uniminmax&quot;</span>) <span class="sc">+</span></span>
<span id="cb305-25"><a href="modelingcalibration.html#cb305-25" aria-hidden="true" tabindex="-1"></a>              <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb305-26"><a href="modelingcalibration.html#cb305-26" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ggtitle</span>(<span class="st">&quot;Top 10 parameter sets from 100,000 run Monte Carlo&quot;</span>)<span class="sc">+</span></span>
<span id="cb305-27"><a href="modelingcalibration.html#cb305-27" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ylab</span>(<span class="st">&quot;normalized parameter values&quot;</span>)<span class="sc">+</span></span>
<span id="cb305-28"><a href="modelingcalibration.html#cb305-28" aria-hidden="true" tabindex="-1"></a>              <span class="fu">xlab</span>(<span class="st">&quot;parameters&quot;</span>)</span></code></pre></div>
<p><img src="Hydroinformatics_Bookdown_files/figure-html/unnamed-chunk-188-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelingintro.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Hydroinformatics_Bookdown.pdf", "Hydroinformatics_Bookdown.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
