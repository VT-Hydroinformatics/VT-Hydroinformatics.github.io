<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 18 Intro to Modeling - Calibrate HBV | Hydroinformatics at VT</title>
  <meta name="description" content="This bookdown contains notes and exercises for a course in hydroinformatics at Virginia Tech." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 18 Intro to Modeling - Calibrate HBV | Hydroinformatics at VT" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This bookdown contains notes and exercises for a course in hydroinformatics at Virginia Tech." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 18 Intro to Modeling - Calibrate HBV | Hydroinformatics at VT" />
  
  <meta name="twitter:description" content="This bookdown contains notes and exercises for a course in hydroinformatics at Virginia Tech." />
  

<meta name="author" content="JP Gannon" />


<meta name="date" content="2021-04-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modelingintro.html"/>

<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script>
<script src="libs/rglWebGL-binding-0.105.22/rglWebGL.js"></script>
<link href="libs/rglwidgetClass-0.105.22/rgl.css" rel="stylesheet" />
<script src="libs/rglwidgetClass-0.105.22/rglClass.min.js"></script>
<script src="libs/CanvasMatrix4-0.105.22/CanvasMatrix.min.js"></script>
<script src="libs/plotly-binding-4.9.3/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GBDXSZFFSR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-GBDXSZFFSR');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Hydroinformatics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#how-to-use-these-materials"><i class="fa fa-check"></i><b>1.1</b> How to use these materials</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#table-of-contents"><i class="fa fa-check"></i><b>1.2</b> Table of contents:</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Plotting.html"><a href="Plotting.html"><i class="fa fa-check"></i><b>2</b> Intro to Plotting</a>
<ul>
<li class="chapter" data-level="2.1" data-path="Plotting.html"><a href="Plotting.html#download-and-install-tidyverse-library"><i class="fa fa-check"></i><b>2.1</b> Download and install tidyverse library</a></li>
<li class="chapter" data-level="2.2" data-path="Plotting.html"><a href="Plotting.html#reading-data"><i class="fa fa-check"></i><b>2.2</b> Reading data</a></li>
<li class="chapter" data-level="2.3" data-path="Plotting.html"><a href="Plotting.html#our-first-ggplot"><i class="fa fa-check"></i><b>2.3</b> Our first ggplot</a></li>
<li class="chapter" data-level="2.4" data-path="Plotting.html"><a href="Plotting.html#change-point-type"><i class="fa fa-check"></i><b>2.4</b> Change point type</a></li>
<li class="chapter" data-level="2.5" data-path="Plotting.html"><a href="Plotting.html#set-colors"><i class="fa fa-check"></i><b>2.5</b> Set colors</a></li>
<li class="chapter" data-level="2.6" data-path="Plotting.html"><a href="Plotting.html#controlling-color-with-a-third-variable-and-other-functions"><i class="fa fa-check"></i><b>2.6</b> Controlling color with a third variable and other functions</a></li>
<li class="chapter" data-level="2.7" data-path="Plotting.html"><a href="Plotting.html#plotting-multiple-groups"><i class="fa fa-check"></i><b>2.7</b> Plotting multiple groups</a></li>
<li class="chapter" data-level="2.8" data-path="Plotting.html"><a href="Plotting.html#facets"><i class="fa fa-check"></i><b>2.8</b> Facets</a></li>
<li class="chapter" data-level="2.9" data-path="Plotting.html"><a href="Plotting.html#two-variable-faceting"><i class="fa fa-check"></i><b>2.9</b> Two variable faceting</a></li>
<li class="chapter" data-level="2.10" data-path="Plotting.html"><a href="Plotting.html#boxplots"><i class="fa fa-check"></i><b>2.10</b> Boxplots</a></li>
<li class="chapter" data-level="2.11" data-path="Plotting.html"><a href="Plotting.html#more-about-color-size-etc"><i class="fa fa-check"></i><b>2.11</b> More about color, size, etc</a></li>
<li class="chapter" data-level="2.12" data-path="Plotting.html"><a href="Plotting.html#multiple-geoms"><i class="fa fa-check"></i><b>2.12</b> Multiple geoms</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Programming.html"><a href="Programming.html"><i class="fa fa-check"></i><b>3</b> R Tidyverse Programming Basics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="Programming.html"><a href="Programming.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="Programming.html"><a href="Programming.html#you-can-use-r-as-a-calculator"><i class="fa fa-check"></i><b>3.2</b> You can use R as a calculator</a></li>
<li class="chapter" data-level="3.3" data-path="Programming.html"><a href="Programming.html#you-can-create-new-objects-using--"><i class="fa fa-check"></i><b>3.3</b> You can create new objects using &lt;-</a></li>
<li class="chapter" data-level="3.4" data-path="Programming.html"><a href="Programming.html#using-functions"><i class="fa fa-check"></i><b>3.4</b> Using functions</a></li>
<li class="chapter" data-level="3.5" data-path="Programming.html"><a href="Programming.html#read-in-some-data."><i class="fa fa-check"></i><b>3.5</b> Read in some data.</a></li>
<li class="chapter" data-level="3.6" data-path="Programming.html"><a href="Programming.html#wait-hold-up.-what-is-a-tibble"><i class="fa fa-check"></i><b>3.6</b> Wait, hold up. What is a tibble?</a></li>
<li class="chapter" data-level="3.7" data-path="Programming.html"><a href="Programming.html#data-wrangling-in-dplyr"><i class="fa fa-check"></i><b>3.7</b> Data wrangling in dplyr</a></li>
<li class="chapter" data-level="3.8" data-path="Programming.html"><a href="Programming.html#filter"><i class="fa fa-check"></i><b>3.8</b> Filter</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="Programming.html"><a href="Programming.html#multiple-conditions"><i class="fa fa-check"></i><b>3.8.1</b> Multiple conditions</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="Programming.html"><a href="Programming.html#arrange"><i class="fa fa-check"></i><b>3.9</b> Arrange</a></li>
<li class="chapter" data-level="3.10" data-path="Programming.html"><a href="Programming.html#select"><i class="fa fa-check"></i><b>3.10</b> Select</a></li>
<li class="chapter" data-level="3.11" data-path="Programming.html"><a href="Programming.html#mutate"><i class="fa fa-check"></i><b>3.11</b> Mutate</a></li>
<li class="chapter" data-level="3.12" data-path="Programming.html"><a href="Programming.html#summarize"><i class="fa fa-check"></i><b>3.12</b> Summarize</a></li>
<li class="chapter" data-level="3.13" data-path="Programming.html"><a href="Programming.html#multiple-operations-with-pipes"><i class="fa fa-check"></i><b>3.13</b> Multiple operations with pipes</a>
<ul>
<li class="chapter" data-level="3.13.1" data-path="Programming.html"><a href="Programming.html#lets-say-we-want-to-tell-r-to-make-a-pbj-sandwich-by-using-the-pbbread-jbread-and-joinslices-functions-and-the-data-ingredients.-if-we-do-this-saving-each-step-if-would-look-like-this"><i class="fa fa-check"></i><b>3.13.1</b> Let’s say we want to tell R to make a PB&amp;J sandwich by using the pbbread(), jbread(), and joinslices() functions and the data “ingredients.” If we do this saving each step if would look like this:</a></li>
<li class="chapter" data-level="3.13.2" data-path="Programming.html"><a href="Programming.html#if-we-nest-the-functions-together-we-get-this"><i class="fa fa-check"></i><b>3.13.2</b> If we nest the functions together we get this</a></li>
<li class="chapter" data-level="3.13.3" data-path="Programming.html"><a href="Programming.html#using-the-pipe-it-would-look-like-this"><i class="fa fa-check"></i><b>3.13.3</b> Using the pipe it would look like this</a></li>
<li class="chapter" data-level="3.13.4" data-path="Programming.html"><a href="Programming.html#when-you-use-the-pipe-it-basically-takes-whatever-came-out-of-the-first-function-and-puts-it-into-the-data-argument-for-the-next-one"><i class="fa fa-check"></i><b>3.13.4</b> When you use the pipe, it basically takes whatever came out of the first function and puts it into the data argument for the next one</a></li>
</ul></li>
<li class="chapter" data-level="3.14" data-path="Programming.html"><a href="Programming.html#save-your-results-to-a-new-tibble"><i class="fa fa-check"></i><b>3.14</b> Save your results to a new tibble</a></li>
<li class="chapter" data-level="3.15" data-path="Programming.html"><a href="Programming.html#what-about-nas"><i class="fa fa-check"></i><b>3.15</b> What about NAs?</a></li>
<li class="chapter" data-level="3.16" data-path="Programming.html"><a href="Programming.html#what-are-some-things-you-think-ill-ask-you-to-do-for-the-activity-next-class"><i class="fa fa-check"></i><b>3.16</b> What are some things you think I’ll ask you to do for the activity next class?</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introactivity.html"><a href="introactivity.html"><i class="fa fa-check"></i><b>4</b> ACTIVITY Intro Skills</a>
<ul>
<li class="chapter" data-level="4.1" data-path="introactivity.html"><a href="introactivity.html#problem-1"><i class="fa fa-check"></i><b>4.1</b> Problem 1</a></li>
<li class="chapter" data-level="4.2" data-path="introactivity.html"><a href="introactivity.html#problem-2"><i class="fa fa-check"></i><b>4.2</b> Problem 2</a></li>
<li class="chapter" data-level="4.3" data-path="introactivity.html"><a href="introactivity.html#problem-3"><i class="fa fa-check"></i><b>4.3</b> Problem 3</a></li>
<li class="chapter" data-level="4.4" data-path="introactivity.html"><a href="introactivity.html#problem-4"><i class="fa fa-check"></i><b>4.4</b> Problem 4</a></li>
<li class="chapter" data-level="4.5" data-path="introactivity.html"><a href="introactivity.html#problem-5"><i class="fa fa-check"></i><b>4.5</b> Problem 5</a></li>
<li class="chapter" data-level="4.6" data-path="introactivity.html"><a href="introactivity.html#problem-6"><i class="fa fa-check"></i><b>4.6</b> Problem 6</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="stats.html"><a href="stats.html"><i class="fa fa-check"></i><b>5</b> Introduction to Basic Statistics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="stats.html"><a href="stats.html#reading-for-this-section-statistical-methods-in-water-resources-chapter-1"><i class="fa fa-check"></i><b>5.1</b> Reading for this section: Statistical Methods in Water Resources: Chapter 1</a></li>
<li class="chapter" data-level="5.2" data-path="stats.html"><a href="stats.html#questions-for-today"><i class="fa fa-check"></i><b>5.2</b> Questions for today:</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="stats.html"><a href="stats.html#stack-plots-to-compare-histogram-and-pdf"><i class="fa fa-check"></i><b>5.2.1</b> Stack plots to compare histogram and pdf</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="stats.html"><a href="stats.html#what-is-the-difference-between-a-sample-and-a-population."><i class="fa fa-check"></i><b>5.3</b> What is the difference between a sample and a population.</a></li>
<li class="chapter" data-level="5.4" data-path="stats.html"><a href="stats.html#measuring-our-sample-distribution-central-tendency."><i class="fa fa-check"></i><b>5.4</b> Measuring our sample distribution: central tendency.</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="stats.html"><a href="stats.html#so-whats-a-weighted-average"><i class="fa fa-check"></i><b>5.4.1</b> So what’s a weighted average?</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="stats.html"><a href="stats.html#measures-of-variability"><i class="fa fa-check"></i><b>5.5</b> Measures of variability</a></li>
<li class="chapter" data-level="5.6" data-path="stats.html"><a href="stats.html#what-is-a-normal-distribution-and-how-can-we-determine-if-we-have-one"><i class="fa fa-check"></i><b>5.6</b> What is a normal distribution and how can we determine if we have one?</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="statsactivity.html"><a href="statsactivity.html"><i class="fa fa-check"></i><b>6</b> ACTIVITY Intro Stats</a>
<ul>
<li class="chapter" data-level="6.1" data-path="statsactivity.html"><a href="statsactivity.html#problem-1-1"><i class="fa fa-check"></i><b>6.1</b> Problem 1</a></li>
<li class="chapter" data-level="6.2" data-path="statsactivity.html"><a href="statsactivity.html#problem-2-1"><i class="fa fa-check"></i><b>6.2</b> Problem 2</a></li>
<li class="chapter" data-level="6.3" data-path="statsactivity.html"><a href="statsactivity.html#problem-3-1"><i class="fa fa-check"></i><b>6.3</b> Problem 3</a></li>
<li class="chapter" data-level="6.4" data-path="statsactivity.html"><a href="statsactivity.html#problem-4-1"><i class="fa fa-check"></i><b>6.4</b> Problem 4</a></li>
<li class="chapter" data-level="6.5" data-path="statsactivity.html"><a href="statsactivity.html#problem-5-1"><i class="fa fa-check"></i><b>6.5</b> Problem 5</a></li>
<li class="chapter" data-level="6.6" data-path="statsactivity.html"><a href="statsactivity.html#problem-6-1"><i class="fa fa-check"></i><b>6.6</b> Problem 6</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="getdata.html"><a href="getdata.html"><i class="fa fa-check"></i><b>7</b> Joins, Pivots, and USGS dataRetrieval</a>
<ul>
<li class="chapter" data-level="7.1" data-path="getdata.html"><a href="getdata.html#goals-for-today"><i class="fa fa-check"></i><b>7.1</b> Goals for today</a></li>
<li class="chapter" data-level="7.2" data-path="getdata.html"><a href="getdata.html#exploring-what-dataretrieval-can-do."><i class="fa fa-check"></i><b>7.2</b> Exploring what dataRetrieval can do.</a></li>
<li class="chapter" data-level="7.3" data-path="getdata.html"><a href="getdata.html#joins"><i class="fa fa-check"></i><b>7.3</b> Joins</a></li>
<li class="chapter" data-level="7.4" data-path="getdata.html"><a href="getdata.html#join-example"><i class="fa fa-check"></i><b>7.4</b> Join example</a></li>
<li class="chapter" data-level="7.5" data-path="getdata.html"><a href="getdata.html#finding-ids-to-download-usgs-data"><i class="fa fa-check"></i><b>7.5</b> Finding IDs to download USGS data</a></li>
<li class="chapter" data-level="7.6" data-path="getdata.html"><a href="getdata.html#ok-lets-download-some-data"><i class="fa fa-check"></i><b>7.6</b> OK let’s download some data!</a></li>
<li class="chapter" data-level="7.7" data-path="getdata.html"><a href="getdata.html#pivoting-wide-and-long-data"><i class="fa fa-check"></i><b>7.7</b> Pivoting: wide and long data</a></li>
<li class="chapter" data-level="7.8" data-path="getdata.html"><a href="getdata.html#pivot-examples"><i class="fa fa-check"></i><b>7.8</b> Pivot Examples</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="joinpivotDR.html"><a href="joinpivotDR.html"><i class="fa fa-check"></i><b>8</b> ACTIVITY Joins Pivots dataRetrieval</a>
<ul>
<li class="chapter" data-level="8.1" data-path="joinpivotDR.html"><a href="joinpivotDR.html#load-the-tidyverse-dataretrieval-and-patchwork-packages."><i class="fa fa-check"></i><b>8.1</b> Load the tidyverse, dataRetrieval, and patchwork packages.</a></li>
<li class="chapter" data-level="8.2" data-path="joinpivotDR.html"><a href="joinpivotDR.html#problem-1-2"><i class="fa fa-check"></i><b>8.2</b> Problem 1</a></li>
<li class="chapter" data-level="8.3" data-path="joinpivotDR.html"><a href="joinpivotDR.html#problem-2-2"><i class="fa fa-check"></i><b>8.3</b> Problem 2</a></li>
<li class="chapter" data-level="8.4" data-path="joinpivotDR.html"><a href="joinpivotDR.html#problem-3-2"><i class="fa fa-check"></i><b>8.4</b> Problem 3</a></li>
<li class="chapter" data-level="8.5" data-path="joinpivotDR.html"><a href="joinpivotDR.html#problem-4-2"><i class="fa fa-check"></i><b>8.5</b> Problem 4</a></li>
<li class="chapter" data-level="8.6" data-path="joinpivotDR.html"><a href="joinpivotDR.html#problem-5-2"><i class="fa fa-check"></i><b>8.6</b> Problem 5</a></li>
<li class="chapter" data-level="8.7" data-path="joinpivotDR.html"><a href="joinpivotDR.html#problem-6-2"><i class="fa fa-check"></i><b>8.7</b> Problem 6</a></li>
<li class="chapter" data-level="8.8" data-path="joinpivotDR.html"><a href="joinpivotDR.html#problem-7"><i class="fa fa-check"></i><b>8.8</b> Problem 7</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Summative1.html"><a href="Summative1.html"><i class="fa fa-check"></i><b>9</b> ACTIVITY Summative 1</a>
<ul>
<li class="chapter" data-level="9.0.1" data-path="Summative1.html"><a href="Summative1.html#instructions"><i class="fa fa-check"></i><b>9.0.1</b> Instructions</a></li>
<li class="chapter" data-level="9.1" data-path="Summative1.html"><a href="Summative1.html#problem-1-3"><i class="fa fa-check"></i><b>9.1</b> Problem 1</a></li>
<li class="chapter" data-level="9.2" data-path="Summative1.html"><a href="Summative1.html#problem-2-3"><i class="fa fa-check"></i><b>9.2</b> Problem 2</a></li>
<li class="chapter" data-level="9.3" data-path="Summative1.html"><a href="Summative1.html#problem-3-3"><i class="fa fa-check"></i><b>9.3</b> Problem 3</a></li>
<li class="chapter" data-level="9.4" data-path="Summative1.html"><a href="Summative1.html#problem-4-3"><i class="fa fa-check"></i><b>9.4</b> Problem 4</a></li>
<li class="chapter" data-level="9.5" data-path="Summative1.html"><a href="Summative1.html#problem-5-3"><i class="fa fa-check"></i><b>9.5</b> Problem 5</a></li>
<li class="chapter" data-level="9.6" data-path="Summative1.html"><a href="Summative1.html#problem-6-3"><i class="fa fa-check"></i><b>9.6</b> Problem 6</a></li>
<li class="chapter" data-level="9.7" data-path="Summative1.html"><a href="Summative1.html#problem-7-1"><i class="fa fa-check"></i><b>9.7</b> Problem 7</a></li>
<li class="chapter" data-level="9.8" data-path="Summative1.html"><a href="Summative1.html#problem-8"><i class="fa fa-check"></i><b>9.8</b> Problem 8</a></li>
<li class="chapter" data-level="9.9" data-path="Summative1.html"><a href="Summative1.html#problem-9"><i class="fa fa-check"></i><b>9.9</b> Problem 9</a></li>
<li class="chapter" data-level="9.10" data-path="Summative1.html"><a href="Summative1.html#problem-10"><i class="fa fa-check"></i><b>9.10</b> Problem 10</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="fdcs.html"><a href="fdcs.html"><i class="fa fa-check"></i><b>10</b> Flow Duration Curves</a>
<ul>
<li class="chapter" data-level="10.1" data-path="fdcs.html"><a href="fdcs.html#get-data"><i class="fa fa-check"></i><b>10.1</b> Get data</a></li>
<li class="chapter" data-level="10.2" data-path="fdcs.html"><a href="fdcs.html#review-describe-the-distribution"><i class="fa fa-check"></i><b>10.2</b> Review: describe the distribution</a></li>
<li class="chapter" data-level="10.3" data-path="fdcs.html"><a href="fdcs.html#ecdfs"><i class="fa fa-check"></i><b>10.3</b> ECDFs</a></li>
<li class="chapter" data-level="10.4" data-path="fdcs.html"><a href="fdcs.html#calculate-flow-exceedence-probabilities"><i class="fa fa-check"></i><b>10.4</b> Calculate flow exceedence probabilities</a></li>
<li class="chapter" data-level="10.5" data-path="fdcs.html"><a href="fdcs.html#plot-a-flow-duration-curve-using-the-probabilities"><i class="fa fa-check"></i><b>10.5</b> Plot a Flow Duration Curve using the probabilities</a></li>
<li class="chapter" data-level="10.6" data-path="fdcs.html"><a href="fdcs.html#make-an-almost-fdc-with-stat_ecdf"><i class="fa fa-check"></i><b>10.6</b> Make an almost FDC with stat_ecdf</a></li>
<li class="chapter" data-level="10.7" data-path="fdcs.html"><a href="fdcs.html#example-use-of-an-fdc"><i class="fa fa-check"></i><b>10.7</b> Example use of an FDC</a></li>
<li class="chapter" data-level="10.8" data-path="fdcs.html"><a href="fdcs.html#compare-to-a-boxplot-of-the-same-data"><i class="fa fa-check"></i><b>10.8</b> Compare to a boxplot of the same data</a></li>
<li class="chapter" data-level="10.9" data-path="fdcs.html"><a href="fdcs.html#challenge-examining-flow-regime-change-at-the-grand-canyon"><i class="fa fa-check"></i><b>10.9</b> Challenge: Examining flow regime change at the Grand Canyon</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="lfas.html"><a href="lfas.html"><i class="fa fa-check"></i><b>11</b> Low Flow Analysis</a>
<ul>
<li class="chapter" data-level="11.1" data-path="lfas.html"><a href="lfas.html#what-are-low-flow-statistics"><i class="fa fa-check"></i><b>11.1</b> What are low flow statistics?</a></li>
<li class="chapter" data-level="11.2" data-path="lfas.html"><a href="lfas.html#get-data-1"><i class="fa fa-check"></i><b>11.2</b> Get data</a></li>
<li class="chapter" data-level="11.3" data-path="lfas.html"><a href="lfas.html#create-the-x-days-average-flow-record"><i class="fa fa-check"></i><b>11.3</b> Create the X days average flow record</a></li>
<li class="chapter" data-level="11.4" data-path="lfas.html"><a href="lfas.html#look-at-what-a-rolling-mean-does."><i class="fa fa-check"></i><b>11.4</b> Look at what a rolling mean does.</a></li>
<li class="chapter" data-level="11.5" data-path="lfas.html"><a href="lfas.html#calculate-yearly-minimums"><i class="fa fa-check"></i><b>11.5</b> Calculate yearly minimums</a></li>
<li class="chapter" data-level="11.6" data-path="lfas.html"><a href="lfas.html#calculate-return-interval"><i class="fa fa-check"></i><b>11.6</b> Calculate return interval</a></li>
<li class="chapter" data-level="11.7" data-path="lfas.html"><a href="lfas.html#fit-to-pearson-type-iii-distribution"><i class="fa fa-check"></i><b>11.7</b> Fit to Pearson Type III distribution</a></li>
<li class="chapter" data-level="11.8" data-path="lfas.html"><a href="lfas.html#distribution-free-method"><i class="fa fa-check"></i><b>11.8</b> Distribution-free method</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="floods.html"><a href="floods.html"><i class="fa fa-check"></i><b>12</b> Flood Frequency Analysis and Creating Functions</a>
<ul>
<li class="chapter" data-level="12.1" data-path="floods.html"><a href="floods.html#template-repository"><i class="fa fa-check"></i><b>12.1</b> Template Repository</a></li>
<li class="chapter" data-level="12.2" data-path="floods.html"><a href="floods.html#introduction-2"><i class="fa fa-check"></i><b>12.2</b> Introduction</a></li>
<li class="chapter" data-level="12.3" data-path="floods.html"><a href="floods.html#download-and-plot-peak-flow-data"><i class="fa fa-check"></i><b>12.3</b> Download and plot peak flow data</a></li>
<li class="chapter" data-level="12.4" data-path="floods.html"><a href="floods.html#compute-ranks-for-peak-flows"><i class="fa fa-check"></i><b>12.4</b> Compute ranks for peak flows</a></li>
<li class="chapter" data-level="12.5" data-path="floods.html"><a href="floods.html#calculate-exceedance-probability-and-return-period"><i class="fa fa-check"></i><b>12.5</b> Calculate exceedance probability and return period</a></li>
<li class="chapter" data-level="12.6" data-path="floods.html"><a href="floods.html#calculate-gumbel-distribution-parameters"><i class="fa fa-check"></i><b>12.6</b> Calculate Gumbel distribution parameters</a></li>
<li class="chapter" data-level="12.7" data-path="floods.html"><a href="floods.html#calculate-return-interval-for-peak-flows-according-to-gumbel-distribution"><i class="fa fa-check"></i><b>12.7</b> Calculate return interval for peak flows according to Gumbel distribution</a></li>
<li class="chapter" data-level="12.8" data-path="floods.html"><a href="floods.html#plot-gumbel-distribution-fit-with-peak-flow-data"><i class="fa fa-check"></i><b>12.8</b> Plot Gumbel distribution fit with peak flow data</a></li>
<li class="chapter" data-level="12.9" data-path="floods.html"><a href="floods.html#calculate-magnitude-of-1-in-100-chance-flood"><i class="fa fa-check"></i><b>12.9</b> Calculate magnitude of 1 in 100 chance flood</a></li>
<li class="chapter" data-level="12.10" data-path="floods.html"><a href="floods.html#how-to-create-your-own-functions"><i class="fa fa-check"></i><b>12.10</b> How to create your own functions</a></li>
<li class="chapter" data-level="12.11" data-path="floods.html"><a href="floods.html#create-a-return-period-function"><i class="fa fa-check"></i><b>12.11</b> Create a return period function</a></li>
<li class="chapter" data-level="12.12" data-path="floods.html"><a href="floods.html#challenge-create-a-function-to-compute-the-1-in-100-chance-flood-for-any-usgs-gage"><i class="fa fa-check"></i><b>12.12</b> Challenge: Create a function to compute the 1 in 100 chance flood for any USGS gage</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="rgeospatial.html"><a href="rgeospatial.html"><i class="fa fa-check"></i><b>13</b> Geospatial data in R - Vector</a>
<ul>
<li class="chapter" data-level="13.1" data-path="rgeospatial.html"><a href="rgeospatial.html#goals"><i class="fa fa-check"></i><b>13.1</b> Goals</a></li>
<li class="chapter" data-level="13.2" data-path="rgeospatial.html"><a href="rgeospatial.html#intro-to-tmap"><i class="fa fa-check"></i><b>13.2</b> Intro to tmap</a></li>
<li class="chapter" data-level="13.3" data-path="rgeospatial.html"><a href="rgeospatial.html#data-wrangling-with-tidyverse-principles"><i class="fa fa-check"></i><b>13.3</b> Data wrangling with tidyverse principles</a></li>
<li class="chapter" data-level="13.4" data-path="rgeospatial.html"><a href="rgeospatial.html#add-non-spatial-data-to-spatial-data-with-a-join"><i class="fa fa-check"></i><b>13.4</b> Add non-spatial data to spatial data with a join</a></li>
<li class="chapter" data-level="13.5" data-path="rgeospatial.html"><a href="rgeospatial.html#plot-maps-side-by-side"><i class="fa fa-check"></i><b>13.5</b> Plot maps side by side</a></li>
<li class="chapter" data-level="13.6" data-path="rgeospatial.html"><a href="rgeospatial.html#built-in-styles-like-themes-in-ggplot"><i class="fa fa-check"></i><b>13.6</b> Built in styles, like themes in ggplot</a></li>
<li class="chapter" data-level="13.7" data-path="rgeospatial.html"><a href="rgeospatial.html#interactive-maps"><i class="fa fa-check"></i><b>13.7</b> Interactive Maps</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="rgeospatial.html"><a href="rgeospatial.html#tmap"><i class="fa fa-check"></i><b>13.7.1</b> tmap</a></li>
<li class="chapter" data-level="13.7.2" data-path="rgeospatial.html"><a href="rgeospatial.html#leaflet"><i class="fa fa-check"></i><b>13.7.2</b> Leaflet</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="summative2.html"><a href="summative2.html"><i class="fa fa-check"></i><b>14</b> Summative Assessment 2</a>
<ul>
<li class="chapter" data-level="14.1" data-path="summative2.html"><a href="summative2.html#info-for-assessment"><i class="fa fa-check"></i><b>14.1</b> Info for assessment</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="rgeoraster.html"><a href="rgeoraster.html"><i class="fa fa-check"></i><b>15</b> Geospatial R Raster - Hydro Analyses</a>
<ul>
<li class="chapter" data-level="15.1" data-path="rgeoraster.html"><a href="rgeoraster.html#introduction-3"><i class="fa fa-check"></i><b>15.1</b> Introduction</a></li>
<li class="chapter" data-level="15.2" data-path="rgeoraster.html"><a href="rgeoraster.html#read-in-dem"><i class="fa fa-check"></i><b>15.2</b> Read in DEM</a></li>
<li class="chapter" data-level="15.3" data-path="rgeoraster.html"><a href="rgeoraster.html#plot-dem"><i class="fa fa-check"></i><b>15.3</b> Plot DEM</a></li>
<li class="chapter" data-level="15.4" data-path="rgeoraster.html"><a href="rgeoraster.html#generate-a-hillshade"><i class="fa fa-check"></i><b>15.4</b> Generate a hillshade</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="rgeoraster.html"><a href="rgeoraster.html#how-whitebox-tools-functions-work"><i class="fa fa-check"></i><b>15.4.1</b> How whitebox tools functions work</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="rgeoraster.html"><a href="rgeoraster.html#prepare-dem-for-hydrology-analyses"><i class="fa fa-check"></i><b>15.5</b> Prepare DEM for Hydrology Analyses</a></li>
<li class="chapter" data-level="15.6" data-path="rgeoraster.html"><a href="rgeoraster.html#visualize-filled-sinks-and-breached-depressions"><i class="fa fa-check"></i><b>15.6</b> Visualize filled sinks and breached depressions</a></li>
<li class="chapter" data-level="15.7" data-path="rgeoraster.html"><a href="rgeoraster.html#d8-flow-accumulation"><i class="fa fa-check"></i><b>15.7</b> D8 Flow Accumulation</a></li>
<li class="chapter" data-level="15.8" data-path="rgeoraster.html"><a href="rgeoraster.html#d-infinity-flow-accumulation"><i class="fa fa-check"></i><b>15.8</b> D infinity flow accumulation</a></li>
<li class="chapter" data-level="15.9" data-path="rgeoraster.html"><a href="rgeoraster.html#topographic-wetness-index"><i class="fa fa-check"></i><b>15.9</b> Topographic Wetness Index</a></li>
<li class="chapter" data-level="15.10" data-path="rgeoraster.html"><a href="rgeoraster.html#downslope-twi"><i class="fa fa-check"></i><b>15.10</b> Downslope TWI</a></li>
<li class="chapter" data-level="15.11" data-path="rgeoraster.html"><a href="rgeoraster.html#map-stream-network"><i class="fa fa-check"></i><b>15.11</b> Map Stream Network</a></li>
<li class="chapter" data-level="15.12" data-path="rgeoraster.html"><a href="rgeoraster.html#extract-raster-values-to-point-locations"><i class="fa fa-check"></i><b>15.12</b> Extract raster values to point locations</a>
<ul>
<li class="chapter" data-level="15.12.1" data-path="rgeoraster.html"><a href="rgeoraster.html#import-and-plot-points"><i class="fa fa-check"></i><b>15.12.1</b> Import and plot points</a></li>
<li class="chapter" data-level="15.12.2" data-path="rgeoraster.html"><a href="rgeoraster.html#extract-values-from-multiple-rasters-at-once"><i class="fa fa-check"></i><b>15.12.2</b> Extract values from multiple rasters at once</a></li>
</ul></li>
<li class="chapter" data-level="15.13" data-path="rgeoraster.html"><a href="rgeoraster.html#view-raster-data-as-a-pdf-or-histogram"><i class="fa fa-check"></i><b>15.13</b> View raster data as a PDF or histogram</a></li>
<li class="chapter" data-level="15.14" data-path="rgeoraster.html"><a href="rgeoraster.html#subsetting-a-raster-for-visualization"><i class="fa fa-check"></i><b>15.14</b> Subsetting a raster for visualization</a></li>
<li class="chapter" data-level="15.15" data-path="rgeoraster.html"><a href="rgeoraster.html#raster-math"><i class="fa fa-check"></i><b>15.15</b> Raster Math</a></li>
<li class="chapter" data-level="15.16" data-path="rgeoraster.html"><a href="rgeoraster.html#extra-plot-topo-characteristics-against-one-another"><i class="fa fa-check"></i><b>15.16</b> Extra: plot topo characteristics against one another</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html"><i class="fa fa-check"></i><b>16</b> Geospatial R Raster - Watershed Delineation</a>
<ul>
<li class="chapter" data-level="16.1" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#introduction-4"><i class="fa fa-check"></i><b>16.1</b> Introduction</a></li>
<li class="chapter" data-level="16.2" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#the-watershed-delineation-toolprocess"><i class="fa fa-check"></i><b>16.2</b> The watershed delineation tool/process</a></li>
<li class="chapter" data-level="16.3" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#read-in-dem-1"><i class="fa fa-check"></i><b>16.3</b> Read in DEM</a></li>
<li class="chapter" data-level="16.4" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#generate-a-hillshade-1"><i class="fa fa-check"></i><b>16.4</b> Generate a hillshade</a></li>
<li class="chapter" data-level="16.5" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#prepare-dem-for-hydrology-analyses-1"><i class="fa fa-check"></i><b>16.5</b> Prepare DEM for Hydrology Analyses</a></li>
<li class="chapter" data-level="16.6" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#create-flow-accumulation-and-pointer-grids"><i class="fa fa-check"></i><b>16.6</b> Create flow accumulation and pointer grids</a></li>
<li class="chapter" data-level="16.7" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#setting-pour-points"><i class="fa fa-check"></i><b>16.7</b> Setting pour points</a></li>
<li class="chapter" data-level="16.8" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#delineate-watersheds"><i class="fa fa-check"></i><b>16.8</b> Delineate watersheds</a></li>
<li class="chapter" data-level="16.9" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#convert-watersheds-to-shapefiles"><i class="fa fa-check"></i><b>16.9</b> Convert watersheds to shapefiles</a></li>
<li class="chapter" data-level="16.10" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#extract-data-based-on-watershed-outline"><i class="fa fa-check"></i><b>16.10</b> Extract data based on watershed outline</a></li>
<li class="chapter" data-level="16.11" data-path="rgeowatersheds.html"><a href="rgeowatersheds.html#bonus-make-a-3d-map-of-your-watershed-with-rayshader"><i class="fa fa-check"></i><b>16.11</b> BONUS: Make a 3d map of your watershed with rayshader</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="modelingintro.html"><a href="modelingintro.html"><i class="fa fa-check"></i><b>17</b> Intro to Modeling - Getting Started with HBV</a>
<ul>
<li class="chapter" data-level="17.1" data-path="modelingintro.html"><a href="modelingintro.html#introduction-5"><i class="fa fa-check"></i><b>17.1</b> Introduction</a></li>
<li class="chapter" data-level="17.2" data-path="modelingintro.html"><a href="modelingintro.html#creating-the-hbv-model-function"><i class="fa fa-check"></i><b>17.2</b> Creating the HBV model function</a></li>
<li class="chapter" data-level="17.3" data-path="modelingintro.html"><a href="modelingintro.html#read-in-precip-and-temp"><i class="fa fa-check"></i><b>17.3</b> Read in Precip and Temp</a></li>
<li class="chapter" data-level="17.4" data-path="modelingintro.html"><a href="modelingintro.html#calculate-pet"><i class="fa fa-check"></i><b>17.4</b> Calculate PET</a></li>
<li class="chapter" data-level="17.5" data-path="modelingintro.html"><a href="modelingintro.html#hbv-parameters"><i class="fa fa-check"></i><b>17.5</b> HBV Parameters</a></li>
<li class="chapter" data-level="17.6" data-path="modelingintro.html"><a href="modelingintro.html#first-model-run"><i class="fa fa-check"></i><b>17.6</b> First model run</a></li>
<li class="chapter" data-level="17.7" data-path="modelingintro.html"><a href="modelingintro.html#import-observed-streamflow-data"><i class="fa fa-check"></i><b>17.7</b> Import observed streamflow data</a></li>
<li class="chapter" data-level="17.8" data-path="modelingintro.html"><a href="modelingintro.html#compare-observed-and-modeled-discharge-graphically"><i class="fa fa-check"></i><b>17.8</b> Compare observed and modeled discharge graphically</a></li>
<li class="chapter" data-level="17.9" data-path="modelingintro.html"><a href="modelingintro.html#compare-observed-and-modelled-discharge-with-interactive-graph"><i class="fa fa-check"></i><b>17.9</b> Compare observed and modelled discharge with interactive graph</a></li>
<li class="chapter" data-level="17.10" data-path="modelingintro.html"><a href="modelingintro.html#measure-how-well-the-model-fits-with-nse"><i class="fa fa-check"></i><b>17.10</b> Measure how well the model fits with NSE</a></li>
<li class="chapter" data-level="17.11" data-path="modelingintro.html"><a href="modelingintro.html#assess-model-fit-with-a-different-measure-snow"><i class="fa fa-check"></i><b>17.11</b> Assess model fit with a different measure: Snow</a></li>
<li class="chapter" data-level="17.12" data-path="modelingintro.html"><a href="modelingintro.html#calibrate-hbv-manually"><i class="fa fa-check"></i><b>17.12</b> Calibrate HBV manually</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="modelingcalibration.html"><a href="modelingcalibration.html"><i class="fa fa-check"></i><b>18</b> Intro to Modeling - Calibrate HBV</a>
<ul>
<li class="chapter" data-level="18.1" data-path="modelingcalibration.html"><a href="modelingcalibration.html#introduction-6"><i class="fa fa-check"></i><b>18.1</b> Introduction</a></li>
<li class="chapter" data-level="18.2" data-path="modelingcalibration.html"><a href="modelingcalibration.html#prep-data"><i class="fa fa-check"></i><b>18.2</b> Prep data</a></li>
<li class="chapter" data-level="18.3" data-path="modelingcalibration.html"><a href="modelingcalibration.html#calculate-pet-1"><i class="fa fa-check"></i><b>18.3</b> Calculate PET</a></li>
<li class="chapter" data-level="18.4" data-path="modelingcalibration.html"><a href="modelingcalibration.html#hbv-parameters-1"><i class="fa fa-check"></i><b>18.4</b> HBV Parameters</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Hydroinformatics at VT</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelingcalibration" class="section level1" number="18">
<h1><span class="header-section-number">Chapter 18</span> Intro to Modeling - Calibrate HBV</h1>
<div id="introduction-6" class="section level2" number="18.1">
<h2><span class="header-section-number">18.1</span> Introduction</h2>
<p>The following activity is available as a template github repository at the following link:</p>
<p><em>Goals for this activity:</em></p>
<ul>
<li>Learn how for loops work</li>
<li>Use for loops to run calibrate the HBV model using the Monte Carlo technique</li>
<li>Assess the results of the calibration, discuss equifinality</li>
</ul>
<p>We saw in the last activity that coming up with the parameters that create a model that fits our watershed discharge best is hard. For this reason, there are several ways people have devised for automating this process. We are going to explore one: a Monte Carlo calibration.</p>
<p>To use this approach, we will create a ton of random parameter sets, run the model for each, and then see which one fits best. The idea is that by creating a bunch of random sets of parameters, we will end up with at least one that works well. As you might guess, this can take a while. We will just do this for 100 or 1000 runs here in this activity, but we will also explore some output from a 100,000 run Monte Carlo that I ran and saved.</p>
<p>There is one new package this time, just for creating a parallel coordinate plot to look at the results of the 100k run Monte Carlo at the end.</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="modelingcalibration.html#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb319-2"><a href="modelingcalibration.html#cb319-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb319-3"><a href="modelingcalibration.html#cb319-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb319-4"><a href="modelingcalibration.html#cb319-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb319-5"><a href="modelingcalibration.html#cb319-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally) <span class="co">#for making parallel coordinate plot</span></span>
<span id="cb319-6"><a href="modelingcalibration.html#cb319-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb319-7"><a href="modelingcalibration.html#cb319-7" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>())</span></code></pre></div>
<p>In order to do what we are going to do, we need for loops</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="modelingcalibration.html#cb320-1" aria-hidden="true" tabindex="-1"></a>val <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb320-2"><a href="modelingcalibration.html#cb320-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-3"><a href="modelingcalibration.html#cb320-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(x <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb320-4"><a href="modelingcalibration.html#cb320-4" aria-hidden="true" tabindex="-1"></a>  val[x] <span class="ot">&lt;-</span> x</span>
<span id="cb320-5"><a href="modelingcalibration.html#cb320-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb320-6"><a href="modelingcalibration.html#cb320-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-7"><a href="modelingcalibration.html#cb320-7" aria-hidden="true" tabindex="-1"></a>val</span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="modelingcalibration.html#cb322-1" aria-hidden="true" tabindex="-1"></a>days <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;mon&quot;</span>,<span class="st">&quot;tues&quot;</span>,<span class="st">&quot;wednes&quot;</span>)</span>
<span id="cb322-2"><a href="modelingcalibration.html#cb322-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-3"><a href="modelingcalibration.html#cb322-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(x <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(days)){</span>
<span id="cb322-4"><a href="modelingcalibration.html#cb322-4" aria-hidden="true" tabindex="-1"></a>  days[x] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(days[x], <span class="st">&quot;day&quot;</span>)</span>
<span id="cb322-5"><a href="modelingcalibration.html#cb322-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb322-6"><a href="modelingcalibration.html#cb322-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-7"><a href="modelingcalibration.html#cb322-7" aria-hidden="true" tabindex="-1"></a>days</span></code></pre></div>
<pre><code>## [1] &quot;monday&quot;    &quot;tuesday&quot;   &quot;wednesday&quot;</code></pre>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="modelingcalibration.html#cb324-1" aria-hidden="true" tabindex="-1"></a>gages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;123&quot;</span>,<span class="st">&quot;ABC&quot;</span>,<span class="st">&quot;001&quot;</span>)</span>
<span id="cb324-2"><a href="modelingcalibration.html#cb324-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-3"><a href="modelingcalibration.html#cb324-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(g <span class="cf">in</span> gages){</span>
<span id="cb324-4"><a href="modelingcalibration.html#cb324-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(g)</span>
<span id="cb324-5"><a href="modelingcalibration.html#cb324-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;123&quot;
## [1] &quot;ABC&quot;
## [1] &quot;001&quot;</code></pre>
</div>
<div id="prep-data" class="section level2" number="18.2">
<h2><span class="header-section-number">18.2</span> Prep data</h2>
<p>Import data
Make P, Qobs, Temp as vectors</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="modelingcalibration.html#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Precip</span></span>
<span id="cb326-2"><a href="modelingcalibration.html#cb326-2" aria-hidden="true" tabindex="-1"></a>P1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;HBV/Pwd2009-2012.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb326-3"><a href="modelingcalibration.html#cb326-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">select</span>(DATE, WS_3) <span class="sc">%&gt;%</span></span>
<span id="cb326-4"><a href="modelingcalibration.html#cb326-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">DATE =</span> <span class="fu">ymd</span>(DATE)) <span class="sc">%&gt;%</span></span>
<span id="cb326-5"><a href="modelingcalibration.html#cb326-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">filter</span>(DATE <span class="sc">&gt;=</span> start <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end)</span></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   DATE = col_character(),
##   WS_1 = col_double(),
##   WS_2 = col_double(),
##   WS_3 = col_double(),
##   WS_4 = col_double(),
##   WS_5 = col_double(),
##   WS_6 = col_double(),
##   WS_7 = col_double(),
##   WS_8 = col_double(),
##   WS_9 = col_double()
## )</code></pre>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="modelingcalibration.html#cb328-1" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> P1<span class="sc">$</span>WS_3</span>
<span id="cb328-2"><a href="modelingcalibration.html#cb328-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-3"><a href="modelingcalibration.html#cb328-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Streamflow mm/d</span></span>
<span id="cb328-4"><a href="modelingcalibration.html#cb328-4" aria-hidden="true" tabindex="-1"></a>Qobs1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;HBV/SWD2009-2012.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb328-5"><a href="modelingcalibration.html#cb328-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">select</span>(DATE, WS_3) <span class="sc">%&gt;%</span></span>
<span id="cb328-6"><a href="modelingcalibration.html#cb328-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">DATE =</span> <span class="fu">ymd</span>(DATE)) <span class="sc">%&gt;%</span></span>
<span id="cb328-7"><a href="modelingcalibration.html#cb328-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">filter</span>(DATE <span class="sc">&gt;=</span> start <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end)</span></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   DATE = col_character(),
##   WS_1 = col_double(),
##   WS_2 = col_double(),
##   WS_3 = col_double(),
##   WS_4 = col_double(),
##   WS_5 = col_double(),
##   WS_6 = col_double(),
##   WS_7 = col_double(),
##   WS_8 = col_double(),
##   WS_9 = col_double()
## )</code></pre>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="modelingcalibration.html#cb330-1" aria-hidden="true" tabindex="-1"></a>Qobs <span class="ot">&lt;-</span> Qobs1<span class="sc">$</span>WS_3</span>
<span id="cb330-2"><a href="modelingcalibration.html#cb330-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb330-3"><a href="modelingcalibration.html#cb330-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Temp in deg C</span></span>
<span id="cb330-4"><a href="modelingcalibration.html#cb330-4" aria-hidden="true" tabindex="-1"></a>Temp1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;HBV/Tdm2009-2012.csv&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb330-5"><a href="modelingcalibration.html#cb330-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">select</span>(DATE, STA_1) <span class="sc">%&gt;%</span></span>
<span id="cb330-6"><a href="modelingcalibration.html#cb330-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">DATE =</span> <span class="fu">ymd</span>(DATE)) <span class="sc">%&gt;%</span></span>
<span id="cb330-7"><a href="modelingcalibration.html#cb330-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">filter</span>(DATE <span class="sc">&gt;=</span> start <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end)</span></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   DATE = col_character(),
##   STA_1 = col_double(),
##   STA_6 = col_double(),
##   STA_14 = col_double(),
##   STA_INT = col_double(),
##   STA_HQ = col_double(),
##   STA_23 = col_double(),
##   STA_17 = col_double(),
##   STA_24 = col_double()
## )</code></pre>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="modelingcalibration.html#cb332-1" aria-hidden="true" tabindex="-1"></a>Temp <span class="ot">&lt;-</span> Temp1<span class="sc">$</span>STA_1</span>
<span id="cb332-2"><a href="modelingcalibration.html#cb332-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-3"><a href="modelingcalibration.html#cb332-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Snow in SWE, mm</span></span>
<span id="cb332-4"><a href="modelingcalibration.html#cb332-4" aria-hidden="true" tabindex="-1"></a>snow <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;HBV/sno2009-2012.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb332-5"><a href="modelingcalibration.html#cb332-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">select</span>(DATE, STA2) <span class="sc">%&gt;%</span></span>
<span id="cb332-6"><a href="modelingcalibration.html#cb332-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">DATE =</span> <span class="fu">ymd</span>(DATE)) <span class="sc">%&gt;%</span></span>
<span id="cb332-7"><a href="modelingcalibration.html#cb332-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">filter</span>(DATE <span class="sc">&gt;=</span> start <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end)</span></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   .default = col_double(),
##   DATE = col_character()
## )
## ℹ Use `spec()` for the full column specifications.</code></pre>
<pre><code>## Warning: 76 parsing failures.
## row col   expected     actual                   file
##   1  -- 22 columns 25 columns &#39;HBV/sno2009-2012.csv&#39;
##   2  -- 22 columns 25 columns &#39;HBV/sno2009-2012.csv&#39;
##   3  -- 22 columns 25 columns &#39;HBV/sno2009-2012.csv&#39;
##   4  -- 22 columns 25 columns &#39;HBV/sno2009-2012.csv&#39;
##   5  -- 22 columns 25 columns &#39;HBV/sno2009-2012.csv&#39;
## ... ... .......... .......... ......................
## See problems(...) for more details.</code></pre>
<pre><code>## Warning: 8 failed to parse.</code></pre>
</div>
<div id="calculate-pet-1" class="section level2" number="18.3">
<h2><span class="header-section-number">18.3</span> Calculate PET</h2>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="modelingcalibration.html#cb336-1" aria-hidden="true" tabindex="-1"></a>lat <span class="ot">&lt;-</span> <span class="dv">43</span> <span class="sc">+</span> <span class="dv">57</span><span class="sc">/</span><span class="dv">60</span> <span class="co">#43 degrees and 57 minutes</span></span>
<span id="cb336-2"><a href="modelingcalibration.html#cb336-2" aria-hidden="true" tabindex="-1"></a>latrad <span class="ot">&lt;-</span> (lat<span class="sc">/</span><span class="dv">360</span>) <span class="sc">*</span> <span class="dv">2</span> <span class="sc">*</span> pi <span class="co">#convert to radians</span></span>
<span id="cb336-3"><a href="modelingcalibration.html#cb336-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb336-4"><a href="modelingcalibration.html#cb336-4" aria-hidden="true" tabindex="-1"></a>PET1 <span class="ot">&lt;-</span> <span class="fu">select</span>(Temp1, DATE) <span class="sc">%&gt;%</span></span>
<span id="cb336-5"><a href="modelingcalibration.html#cb336-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">DOY =</span> <span class="fu">yday</span>(DATE)) <span class="sc">%&gt;%</span> <span class="co">#DOY for dates</span></span>
<span id="cb336-6"><a href="modelingcalibration.html#cb336-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">tempvar =</span> (<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">365</span>) <span class="sc">*</span> DOY) <span class="sc">%&gt;%</span></span>
<span id="cb336-7"><a href="modelingcalibration.html#cb336-7" aria-hidden="true" tabindex="-1"></a>         <span class="co">#declination of the sun above the celestial equator in </span></span>
<span id="cb336-8"><a href="modelingcalibration.html#cb336-8" aria-hidden="true" tabindex="-1"></a>         <span class="co">#radians on day JulDay of the year</span></span>
<span id="cb336-9"><a href="modelingcalibration.html#cb336-9" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">delta_h =</span> <span class="fl">0.4093</span> <span class="sc">*</span> <span class="fu">sin</span>(tempvar <span class="sc">-</span> <span class="fl">1.405</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb336-10"><a href="modelingcalibration.html#cb336-10" aria-hidden="true" tabindex="-1"></a>         <span class="co">#day length in h</span></span>
<span id="cb336-11"><a href="modelingcalibration.html#cb336-11" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">daylen =</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">acos</span>(<span class="sc">-</span><span class="fu">tan</span>(delta_h) <span class="sc">*</span> <span class="fu">tan</span>(latrad)) <span class="sc">/</span> <span class="fl">0.2618</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb336-12"><a href="modelingcalibration.html#cb336-12" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(</span>
<span id="cb336-13"><a href="modelingcalibration.html#cb336-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">PET =</span> <span class="fl">29.8</span> <span class="sc">*</span> daylen <span class="sc">*</span> <span class="fl">0.611</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">17.3</span> <span class="sc">*</span> Temp <span class="sc">/</span> </span>
<span id="cb336-14"><a href="modelingcalibration.html#cb336-14" aria-hidden="true" tabindex="-1"></a>                  (Temp <span class="sc">+</span> <span class="fl">237.3</span>)) <span class="sc">/</span> (Temp <span class="sc">+</span> <span class="fl">273.2</span>))  <span class="co">#PET Hamon method</span></span>
<span id="cb336-15"><a href="modelingcalibration.html#cb336-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb336-16"><a href="modelingcalibration.html#cb336-16" aria-hidden="true" tabindex="-1"></a>PET <span class="ot">&lt;-</span> PET1<span class="sc">$</span>PET</span></code></pre></div>
</div>
<div id="hbv-parameters-1" class="section level2" number="18.4">
<h2><span class="header-section-number">18.4</span> HBV Parameters</h2>
<p>The table below shows the parameters of the HBV model, the minimum and maximum for those values, and a description of their function in the model.</p>
<table>
<colgroup>
<col width="32%" />
<col width="17%" />
<col width="14%" />
<col width="35%" />
</colgroup>
<thead>
<tr class="header">
<th>Object Name</th>
<th>Min</th>
<th>Max</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>FC</td>
<td>40</td>
<td>400</td>
<td>Max soil moisture storage, field capacity</td>
</tr>
<tr class="even">
<td>beta</td>
<td>1</td>
<td>6</td>
<td>Shape coefficient governing fate of water input to soil moisture storage</td>
</tr>
<tr class="odd">
<td>LP</td>
<td>.3</td>
<td>1</td>
<td>Threshold for reduction of evaporation</td>
</tr>
<tr class="even">
<td>SFCF</td>
<td>0.4</td>
<td>1.2</td>
<td>Snowfall correction factor</td>
</tr>
<tr class="odd">
<td>TT</td>
<td>-1.5</td>
<td>1.2</td>
<td>Threshold temperature</td>
</tr>
<tr class="even">
<td>CFMAX</td>
<td>1</td>
<td>8</td>
<td>Degree-day factor</td>
</tr>
<tr class="odd">
<td>k0</td>
<td>0.05</td>
<td>0.5</td>
<td>Recession constant (upper storage, near surface)</td>
</tr>
<tr class="even">
<td>k1</td>
<td>0.01</td>
<td>0.3</td>
<td>Recession constant (upper storage)</td>
</tr>
<tr class="odd">
<td>k2</td>
<td>0.001</td>
<td>0.15</td>
<td>Recession constant (lower storage)</td>
</tr>
<tr class="even">
<td>UZL</td>
<td>0</td>
<td>70</td>
<td>Threshold for shallow storage</td>
</tr>
<tr class="odd">
<td>PERC</td>
<td>0</td>
<td>4</td>
<td>Percolation, max flow from upper to lower storage</td>
</tr>
<tr class="even">
<td>MAXBAS</td>
<td>1</td>
<td>3</td>
<td>base of the triangular routing function, days"</td>
</tr>
</tbody>
</table>
<p>To pass a set of parameters to the model, we just put them into a single vector in the order they are in the table above. In the chunk below, I’ve structured this to make it easy to see a description of each parameter, but you could also just do it in one line without all the comments. Just be sure to get the order right!</p>
<p>The code below sets the routing to 0, which is what we want for a small catchment.</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="modelingcalibration.html#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="co">#number of runs</span></span>
<span id="cb337-2"><a href="modelingcalibration.html#cb337-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb337-3"><a href="modelingcalibration.html#cb337-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-4"><a href="modelingcalibration.html#cb337-4" aria-hidden="true" tabindex="-1"></a><span class="co"># PARAMETERS RANGE and generate set</span></span>
<span id="cb337-5"><a href="modelingcalibration.html#cb337-5" aria-hidden="true" tabindex="-1"></a>FC    <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="dv">40</span>   , <span class="at">max =</span> <span class="dv">400</span>)  <span class="co">#Max soil moisture storage, field capacity</span></span>
<span id="cb337-6"><a href="modelingcalibration.html#cb337-6" aria-hidden="true" tabindex="-1"></a>beta  <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="dv">1</span>    , <span class="at">max =</span> <span class="dv">6</span>)    <span class="co">#Shape coefficient governing fate of water input to soil moisture storage</span></span>
<span id="cb337-7"><a href="modelingcalibration.html#cb337-7" aria-hidden="true" tabindex="-1"></a>LP    <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="fl">0.3</span>   , <span class="at">max =</span> <span class="dv">1</span>)    <span class="co">#Threshold for reduction of evap</span></span>
<span id="cb337-8"><a href="modelingcalibration.html#cb337-8" aria-hidden="true" tabindex="-1"></a>SFCF  <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="fl">0.4</span>  , <span class="at">max =</span> <span class="fl">1.2</span>)  <span class="co">#Snowfall correction factor</span></span>
<span id="cb337-9"><a href="modelingcalibration.html#cb337-9" aria-hidden="true" tabindex="-1"></a>TT    <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="sc">-</span><span class="fl">1.5</span> , <span class="at">max =</span> <span class="fl">1.2</span>)  <span class="co">#Threshold temperature</span></span>
<span id="cb337-10"><a href="modelingcalibration.html#cb337-10" aria-hidden="true" tabindex="-1"></a>CFMAX <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="dv">1</span>    , <span class="at">max =</span> <span class="dv">8</span>)    <span class="co">#Degree-day factor</span></span>
<span id="cb337-11"><a href="modelingcalibration.html#cb337-11" aria-hidden="true" tabindex="-1"></a>k0    <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="fl">0.05</span> , <span class="at">max =</span> <span class="fl">0.5</span>)  <span class="co">#Recession constant (upper storage, near surface)</span></span>
<span id="cb337-12"><a href="modelingcalibration.html#cb337-12" aria-hidden="true" tabindex="-1"></a>k1    <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="fl">0.01</span> , <span class="at">max =</span> <span class="fl">0.3</span>)  <span class="co">#Recession constant (upper storage)</span></span>
<span id="cb337-13"><a href="modelingcalibration.html#cb337-13" aria-hidden="true" tabindex="-1"></a>k2    <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="fl">0.001</span>, <span class="at">max =</span> <span class="fl">0.15</span>) <span class="co">#Recession constant (lower storage)</span></span>
<span id="cb337-14"><a href="modelingcalibration.html#cb337-14" aria-hidden="true" tabindex="-1"></a>UZL   <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="dv">0</span>    , <span class="at">max =</span> <span class="dv">70</span>)   <span class="co">#Threshold for shallow storage</span></span>
<span id="cb337-15"><a href="modelingcalibration.html#cb337-15" aria-hidden="true" tabindex="-1"></a>PERC  <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="dv">0</span>    , <span class="at">max =</span> <span class="dv">4</span>)    <span class="co">#Percolation, max flow from upper to lower storage</span></span>
<span id="cb337-16"><a href="modelingcalibration.html#cb337-16" aria-hidden="true" tabindex="-1"></a>MAXBAS<span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, N)   <span class="co">#base of the triangular routing function, days</span></span>
<span id="cb337-17"><a href="modelingcalibration.html#cb337-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-18"><a href="modelingcalibration.html#cb337-18" aria-hidden="true" tabindex="-1"></a>NSE <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, N) <span class="co">#create NSE column, to be filled in for loop</span></span>
<span id="cb337-19"><a href="modelingcalibration.html#cb337-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-20"><a href="modelingcalibration.html#cb337-20" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">&lt;-</span> <span class="fu">cbind</span>(FC, beta, LP, SFCF, </span>
<span id="cb337-21"><a href="modelingcalibration.html#cb337-21" aria-hidden="true" tabindex="-1"></a>               TT, CFMAX, k0, k1, </span>
<span id="cb337-22"><a href="modelingcalibration.html#cb337-22" aria-hidden="true" tabindex="-1"></a>               k2, UZL, PERC, MAXBAS, NSE) </span></code></pre></div>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="modelingcalibration.html#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="co">#trim the first 40% (warm up) of Qobs off for NSE calculation </span></span>
<span id="cb338-2"><a href="modelingcalibration.html#cb338-2" aria-hidden="true" tabindex="-1"></a>EvalStart <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="fu">length</span>(Qobs)<span class="sc">*</span><span class="fl">0.4</span>)</span>
<span id="cb338-3"><a href="modelingcalibration.html#cb338-3" aria-hidden="true" tabindex="-1"></a>EvalEnd <span class="ot">&lt;-</span> <span class="fu">length</span>(Qobs)</span>
<span id="cb338-4"><a href="modelingcalibration.html#cb338-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-5"><a href="modelingcalibration.html#cb338-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-6"><a href="modelingcalibration.html#cb338-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb338-7"><a href="modelingcalibration.html#cb338-7" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb338-8"><a href="modelingcalibration.html#cb338-8" aria-hidden="true" tabindex="-1"></a>   <span class="co">#call model with i parameter set generated above</span></span>
<span id="cb338-9"><a href="modelingcalibration.html#cb338-9" aria-hidden="true" tabindex="-1"></a>   results <span class="ot">&lt;-</span> <span class="fu">HBV</span>(pars[i,<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>], P, Temp, PET, routing)</span>
<span id="cb338-10"><a href="modelingcalibration.html#cb338-10" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb338-11"><a href="modelingcalibration.html#cb338-11" aria-hidden="true" tabindex="-1"></a>   <span class="co">#add the Qobs to results</span></span>
<span id="cb338-12"><a href="modelingcalibration.html#cb338-12" aria-hidden="true" tabindex="-1"></a>   results <span class="ot">&lt;-</span> <span class="fu">cbind</span>(results, Qobs)</span>
<span id="cb338-13"><a href="modelingcalibration.html#cb338-13" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb338-14"><a href="modelingcalibration.html#cb338-14" aria-hidden="true" tabindex="-1"></a>   <span class="co">#trim the first 40% of the record so it isn&#39;t included in the NSE calculation</span></span>
<span id="cb338-15"><a href="modelingcalibration.html#cb338-15" aria-hidden="true" tabindex="-1"></a>   results <span class="ot">&lt;-</span> results[EvalStart<span class="sc">:</span>EvalEnd,]</span>
<span id="cb338-16"><a href="modelingcalibration.html#cb338-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb338-17"><a href="modelingcalibration.html#cb338-17" aria-hidden="true" tabindex="-1"></a>   <span class="co">#Calculate NSE and add to parameter set</span></span>
<span id="cb338-18"><a href="modelingcalibration.html#cb338-18" aria-hidden="true" tabindex="-1"></a>   pars[i,<span class="dv">13</span>]  <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> ((<span class="fu">sum</span>((results<span class="sc">$</span>Qobs <span class="sc">-</span> results<span class="sc">$</span>q) <span class="sc">^</span> <span class="dv">2</span>)) <span class="sc">/</span> <span class="fu">sum</span>((results<span class="sc">$</span>Qobs <span class="sc">-</span> <span class="fu">mean</span>(results<span class="sc">$</span>Qobs)) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb338-19"><a href="modelingcalibration.html#cb338-19" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb338-20"><a href="modelingcalibration.html#cb338-20" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="modelingcalibration.html#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="co">#find best parameters</span></span>
<span id="cb339-2"><a href="modelingcalibration.html#cb339-2" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(pars)</span>
<span id="cb339-3"><a href="modelingcalibration.html#cb339-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-4"><a href="modelingcalibration.html#cb339-4" aria-hidden="true" tabindex="-1"></a>bestparams <span class="ot">&lt;-</span> pars <span class="sc">%&gt;%</span> <span class="fu">filter</span>(NSE <span class="sc">==</span> <span class="fu">max</span>(NSE)) <span class="sc">%&gt;%</span></span>
<span id="cb339-5"><a href="modelingcalibration.html#cb339-5" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb339-6"><a href="modelingcalibration.html#cb339-6" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">as.numeric</span>()</span>
<span id="cb339-7"><a href="modelingcalibration.html#cb339-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-8"><a href="modelingcalibration.html#cb339-8" aria-hidden="true" tabindex="-1"></a><span class="co">#run with best parameters</span></span>
<span id="cb339-9"><a href="modelingcalibration.html#cb339-9" aria-hidden="true" tabindex="-1"></a>modeloutput <span class="ot">&lt;-</span>  <span class="fu">HBV</span>(bestparams, P, Temp, PET, routing)</span>
<span id="cb339-10"><a href="modelingcalibration.html#cb339-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-11"><a href="modelingcalibration.html#cb339-11" aria-hidden="true" tabindex="-1"></a><span class="co">#add observations for plotting</span></span>
<span id="cb339-12"><a href="modelingcalibration.html#cb339-12" aria-hidden="true" tabindex="-1"></a>modeloutput <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(modeloutput, Qobs1)</span>
<span id="cb339-13"><a href="modelingcalibration.html#cb339-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-14"><a href="modelingcalibration.html#cb339-14" aria-hidden="true" tabindex="-1"></a><span class="co">#trim out warm up period for plotting</span></span>
<span id="cb339-15"><a href="modelingcalibration.html#cb339-15" aria-hidden="true" tabindex="-1"></a>OutputTrim <span class="ot">&lt;-</span> <span class="fu">filter</span>(modeloutput, DATE <span class="sc">&gt;=</span> <span class="fu">mdy</span>(<span class="st">&quot;08-07-2010&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="modelingcalibration.html#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate NSE</span></span>
<span id="cb340-2"><a href="modelingcalibration.html#cb340-2" aria-hidden="true" tabindex="-1"></a>NSE <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> ((<span class="fu">sum</span>((OutputTrim<span class="sc">$</span>q <span class="sc">-</span> OutputTrim<span class="sc">$</span>WS_3) <span class="sc">^</span> <span class="dv">2</span>)) <span class="sc">/</span> </span>
<span id="cb340-3"><a href="modelingcalibration.html#cb340-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">sum</span>((OutputTrim<span class="sc">$</span>WS_3 <span class="sc">-</span> <span class="fu">mean</span>(OutputTrim<span class="sc">$</span>WS_3)) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb340-4"><a href="modelingcalibration.html#cb340-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-5"><a href="modelingcalibration.html#cb340-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Create plot with NSE in title</span></span>
<span id="cb340-6"><a href="modelingcalibration.html#cb340-6" aria-hidden="true" tabindex="-1"></a>OutputTrim <span class="sc">%&gt;%</span> <span class="fu">plot_ly</span>(<span class="at">x =</span> <span class="sc">~</span>DATE) <span class="sc">%&gt;%</span> </span>
<span id="cb340-7"><a href="modelingcalibration.html#cb340-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">add_trace</span>(<span class="at">y =</span> <span class="sc">~</span>q, <span class="at">name =</span> <span class="st">&#39;Modeled&#39;</span>,  <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="at">mode =</span> <span class="st">&#39;lines&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb340-8"><a href="modelingcalibration.html#cb340-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">add_trace</span>(<span class="at">y =</span> <span class="sc">~</span>WS_3, <span class="at">name =</span> <span class="st">&#39;Measured&#39;</span>, <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="at">mode =</span> <span class="st">&#39;lines&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb340-9"><a href="modelingcalibration.html#cb340-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">layout</span>(<span class="at">title=</span><span class="fu">paste</span>(<span class="st">&quot;NSE: &quot;</span>, <span class="fu">round</span>(NSE,<span class="dv">2</span>)))</span></code></pre></div>
<div id="htmlwidget-af5c1266d155a61e7498" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-af5c1266d155a61e7498">{"x":{"visdat":{"d21246c195":["function () ","plotlyVisDat"]},"cur_data":"d21246c195","attrs":{"d21246c195":{"x":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"name":"Modeled","type":"scatter","mode":"lines","inherit":true},"d21246c195.1":{"x":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"name":"Measured","type":"scatter","mode":"lines","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"NSE:  0.72","xaxis":{"domain":[0,1],"automargin":true,"title":"DATE"},"yaxis":{"domain":[0,1],"automargin":true,"title":"q"},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["2010-08-07","2010-08-08","2010-08-09","2010-08-10","2010-08-11","2010-08-12","2010-08-13","2010-08-14","2010-08-15","2010-08-16","2010-08-17","2010-08-18","2010-08-19","2010-08-20","2010-08-21","2010-08-22","2010-08-23","2010-08-24","2010-08-25","2010-08-26","2010-08-27","2010-08-28","2010-08-29","2010-08-30","2010-08-31","2010-09-01","2010-09-02","2010-09-03","2010-09-04","2010-09-05","2010-09-06","2010-09-07","2010-09-08","2010-09-09","2010-09-10","2010-09-11","2010-09-12","2010-09-13","2010-09-14","2010-09-15","2010-09-16","2010-09-17","2010-09-18","2010-09-19","2010-09-20","2010-09-21","2010-09-22","2010-09-23","2010-09-24","2010-09-25","2010-09-26","2010-09-27","2010-09-28","2010-09-29","2010-09-30","2010-10-01","2010-10-02","2010-10-03","2010-10-04","2010-10-05","2010-10-06","2010-10-07","2010-10-08","2010-10-09","2010-10-10","2010-10-11","2010-10-12","2010-10-13","2010-10-14","2010-10-15","2010-10-16","2010-10-17","2010-10-18","2010-10-19","2010-10-20","2010-10-21","2010-10-22","2010-10-23","2010-10-24","2010-10-25","2010-10-26","2010-10-27","2010-10-28","2010-10-29","2010-10-30","2010-10-31","2010-11-01","2010-11-02","2010-11-03","2010-11-04","2010-11-05","2010-11-06","2010-11-07","2010-11-08","2010-11-09","2010-11-10","2010-11-11","2010-11-12","2010-11-13","2010-11-14","2010-11-15","2010-11-16","2010-11-17","2010-11-18","2010-11-19","2010-11-20","2010-11-21","2010-11-22","2010-11-23","2010-11-24","2010-11-25","2010-11-26","2010-11-27","2010-11-28","2010-11-29","2010-11-30","2010-12-01","2010-12-02","2010-12-03","2010-12-04","2010-12-05","2010-12-06","2010-12-07","2010-12-08","2010-12-09","2010-12-10","2010-12-11","2010-12-12","2010-12-13","2010-12-14","2010-12-15","2010-12-16","2010-12-17","2010-12-18","2010-12-19","2010-12-20","2010-12-21","2010-12-22","2010-12-23","2010-12-24","2010-12-25","2010-12-26","2010-12-27","2010-12-28","2010-12-29","2010-12-30","2010-12-31","2011-01-01","2011-01-02","2011-01-03","2011-01-04","2011-01-05","2011-01-06","2011-01-07","2011-01-08","2011-01-09","2011-01-10","2011-01-11","2011-01-12","2011-01-13","2011-01-14","2011-01-15","2011-01-16","2011-01-17","2011-01-18","2011-01-19","2011-01-20","2011-01-21","2011-01-22","2011-01-23","2011-01-24","2011-01-25","2011-01-26","2011-01-27","2011-01-28","2011-01-29","2011-01-30","2011-01-31","2011-02-01","2011-02-02","2011-02-03","2011-02-04","2011-02-05","2011-02-06","2011-02-07","2011-02-08","2011-02-09","2011-02-10","2011-02-11","2011-02-12","2011-02-13","2011-02-14","2011-02-15","2011-02-16","2011-02-17","2011-02-18","2011-02-19","2011-02-20","2011-02-21","2011-02-22","2011-02-23","2011-02-24","2011-02-25","2011-02-26","2011-02-27","2011-02-28","2011-03-01","2011-03-02","2011-03-03","2011-03-04","2011-03-05","2011-03-06","2011-03-07","2011-03-08","2011-03-09","2011-03-10","2011-03-11","2011-03-12","2011-03-13","2011-03-14","2011-03-15","2011-03-16","2011-03-17","2011-03-18","2011-03-19","2011-03-20","2011-03-21","2011-03-22","2011-03-23","2011-03-24","2011-03-25","2011-03-26","2011-03-27","2011-03-28","2011-03-29","2011-03-30","2011-03-31","2011-04-01","2011-04-02","2011-04-03","2011-04-04","2011-04-05","2011-04-06","2011-04-07","2011-04-08","2011-04-09","2011-04-10","2011-04-11","2011-04-12","2011-04-13","2011-04-14","2011-04-15","2011-04-16","2011-04-17","2011-04-18","2011-04-19","2011-04-20","2011-04-21","2011-04-22","2011-04-23","2011-04-24","2011-04-25","2011-04-26","2011-04-27","2011-04-28","2011-04-29","2011-04-30","2011-05-01","2011-05-02","2011-05-03","2011-05-04","2011-05-05","2011-05-06","2011-05-07","2011-05-08","2011-05-09","2011-05-10","2011-05-11","2011-05-12","2011-05-13","2011-05-14","2011-05-15","2011-05-16","2011-05-17","2011-05-18","2011-05-19","2011-05-20","2011-05-21","2011-05-22","2011-05-23","2011-05-24","2011-05-25","2011-05-26","2011-05-27","2011-05-28","2011-05-29","2011-05-30","2011-05-31","2011-06-01","2011-06-02","2011-06-03","2011-06-04","2011-06-05","2011-06-06","2011-06-07","2011-06-08","2011-06-09","2011-06-10","2011-06-11","2011-06-12","2011-06-13","2011-06-14","2011-06-15","2011-06-16","2011-06-17","2011-06-18","2011-06-19","2011-06-20","2011-06-21","2011-06-22","2011-06-23","2011-06-24","2011-06-25","2011-06-26","2011-06-27","2011-06-28","2011-06-29","2011-06-30","2011-07-01","2011-07-02","2011-07-03","2011-07-04","2011-07-05","2011-07-06","2011-07-07","2011-07-08","2011-07-09","2011-07-10","2011-07-11","2011-07-12","2011-07-13","2011-07-14","2011-07-15","2011-07-16","2011-07-17","2011-07-18","2011-07-19","2011-07-20","2011-07-21","2011-07-22","2011-07-23","2011-07-24","2011-07-25","2011-07-26","2011-07-27","2011-07-28","2011-07-29","2011-07-30","2011-07-31","2011-08-01","2011-08-02","2011-08-03","2011-08-04","2011-08-05","2011-08-06","2011-08-07","2011-08-08","2011-08-09","2011-08-10","2011-08-11","2011-08-12","2011-08-13","2011-08-14","2011-08-15","2011-08-16","2011-08-17","2011-08-18","2011-08-19","2011-08-20","2011-08-21","2011-08-22","2011-08-23","2011-08-24","2011-08-25","2011-08-26","2011-08-27","2011-08-28","2011-08-29","2011-08-30","2011-08-31","2011-09-01","2011-09-02","2011-09-03","2011-09-04","2011-09-05","2011-09-06","2011-09-07","2011-09-08","2011-09-09","2011-09-10","2011-09-11","2011-09-12","2011-09-13","2011-09-14","2011-09-15","2011-09-16","2011-09-17","2011-09-18","2011-09-19","2011-09-20","2011-09-21","2011-09-22","2011-09-23","2011-09-24","2011-09-25","2011-09-26","2011-09-27","2011-09-28","2011-09-29","2011-09-30","2011-10-01","2011-10-02","2011-10-03","2011-10-04","2011-10-05","2011-10-06","2011-10-07","2011-10-08","2011-10-09","2011-10-10","2011-10-11","2011-10-12","2011-10-13","2011-10-14","2011-10-15","2011-10-16","2011-10-17","2011-10-18","2011-10-19","2011-10-20","2011-10-21","2011-10-22","2011-10-23","2011-10-24","2011-10-25","2011-10-26","2011-10-27","2011-10-28","2011-10-29","2011-10-30","2011-10-31","2011-11-01","2011-11-02","2011-11-03","2011-11-04","2011-11-05","2011-11-06","2011-11-07","2011-11-08","2011-11-09","2011-11-10","2011-11-11","2011-11-12","2011-11-13","2011-11-14","2011-11-15","2011-11-16","2011-11-17","2011-11-18","2011-11-19","2011-11-20","2011-11-21","2011-11-22","2011-11-23","2011-11-24","2011-11-25","2011-11-26","2011-11-27","2011-11-28","2011-11-29","2011-11-30","2011-12-01","2011-12-02","2011-12-03","2011-12-04","2011-12-05","2011-12-06","2011-12-07","2011-12-08","2011-12-09","2011-12-10","2011-12-11","2011-12-12","2011-12-13","2011-12-14","2011-12-15","2011-12-16","2011-12-17","2011-12-18","2011-12-19","2011-12-20","2011-12-21","2011-12-22","2011-12-23","2011-12-24","2011-12-25","2011-12-26","2011-12-27","2011-12-28","2011-12-29","2011-12-30","2011-12-31","2012-01-01","2012-01-02","2012-01-03","2012-01-04","2012-01-05","2012-01-06","2012-01-07","2012-01-08","2012-01-09","2012-01-10","2012-01-11","2012-01-12","2012-01-13","2012-01-14","2012-01-15","2012-01-16","2012-01-17","2012-01-18","2012-01-19","2012-01-20","2012-01-21","2012-01-22","2012-01-23","2012-01-24","2012-01-25","2012-01-26","2012-01-27","2012-01-28","2012-01-29","2012-01-30","2012-01-31","2012-02-01","2012-02-02","2012-02-03","2012-02-04","2012-02-05","2012-02-06","2012-02-07","2012-02-08","2012-02-09","2012-02-10","2012-02-11","2012-02-12","2012-02-13","2012-02-14","2012-02-15","2012-02-16","2012-02-17","2012-02-18","2012-02-19","2012-02-20","2012-02-21","2012-02-22","2012-02-23","2012-02-24","2012-02-25","2012-02-26","2012-02-27","2012-02-28","2012-02-29","2012-03-01","2012-03-02","2012-03-03","2012-03-04","2012-03-05","2012-03-06","2012-03-07","2012-03-08","2012-03-09","2012-03-10","2012-03-11","2012-03-12","2012-03-13","2012-03-14","2012-03-15","2012-03-16","2012-03-17","2012-03-18","2012-03-19","2012-03-20","2012-03-21","2012-03-22","2012-03-23","2012-03-24","2012-03-25","2012-03-26","2012-03-27","2012-03-28","2012-03-29","2012-03-30","2012-03-31","2012-04-01","2012-04-02","2012-04-03","2012-04-04","2012-04-05","2012-04-06","2012-04-07","2012-04-08","2012-04-09","2012-04-10","2012-04-11","2012-04-12","2012-04-13","2012-04-14","2012-04-15","2012-04-16","2012-04-17","2012-04-18","2012-04-19","2012-04-20","2012-04-21","2012-04-22","2012-04-23","2012-04-24","2012-04-25","2012-04-26","2012-04-27","2012-04-28","2012-04-29","2012-04-30","2012-05-01","2012-05-02","2012-05-03","2012-05-04","2012-05-05","2012-05-06","2012-05-07","2012-05-08","2012-05-09","2012-05-10","2012-05-11","2012-05-12","2012-05-13","2012-05-14","2012-05-15","2012-05-16","2012-05-17","2012-05-18","2012-05-19","2012-05-20","2012-05-21","2012-05-22","2012-05-23","2012-05-24","2012-05-25","2012-05-26","2012-05-27","2012-05-28","2012-05-29","2012-05-30","2012-05-31","2012-06-01","2012-06-02","2012-06-03","2012-06-04","2012-06-05","2012-06-06","2012-06-07","2012-06-08","2012-06-09","2012-06-10","2012-06-11","2012-06-12","2012-06-13","2012-06-14","2012-06-15","2012-06-16","2012-06-17","2012-06-18","2012-06-19","2012-06-20","2012-06-21","2012-06-22","2012-06-23","2012-06-24","2012-06-25","2012-06-26","2012-06-27","2012-06-28","2012-06-29","2012-06-30","2012-07-01","2012-07-02","2012-07-03","2012-07-04","2012-07-05","2012-07-06","2012-07-07","2012-07-08","2012-07-09","2012-07-10","2012-07-11","2012-07-12","2012-07-13","2012-07-14","2012-07-15","2012-07-16","2012-07-17","2012-07-18","2012-07-19","2012-07-20","2012-07-21","2012-07-22","2012-07-23","2012-07-24","2012-07-25","2012-07-26","2012-07-27","2012-07-28","2012-07-29","2012-07-30","2012-07-31","2012-08-01","2012-08-02","2012-08-03","2012-08-04","2012-08-05","2012-08-06","2012-08-07","2012-08-08","2012-08-09","2012-08-10","2012-08-11","2012-08-12","2012-08-13","2012-08-14","2012-08-15","2012-08-16","2012-08-17","2012-08-18","2012-08-19","2012-08-20","2012-08-21","2012-08-22","2012-08-23","2012-08-24","2012-08-25","2012-08-26","2012-08-27","2012-08-28","2012-08-29","2012-08-30","2012-08-31","2012-09-01","2012-09-02","2012-09-03","2012-09-04","2012-09-05","2012-09-06","2012-09-07","2012-09-08","2012-09-09","2012-09-10","2012-09-11","2012-09-12","2012-09-13","2012-09-14","2012-09-15","2012-09-16","2012-09-17","2012-09-18","2012-09-19","2012-09-20","2012-09-21","2012-09-22","2012-09-23","2012-09-24","2012-09-25","2012-09-26","2012-09-27","2012-09-28","2012-09-29","2012-09-30","2012-10-01","2012-10-02","2012-10-03","2012-10-04","2012-10-05","2012-10-06","2012-10-07","2012-10-08","2012-10-09","2012-10-10","2012-10-11","2012-10-12","2012-10-13","2012-10-14","2012-10-15","2012-10-16","2012-10-17","2012-10-18","2012-10-19","2012-10-20","2012-10-21","2012-10-22","2012-10-23","2012-10-24","2012-10-25","2012-10-26","2012-10-27","2012-10-28","2012-10-29","2012-10-30","2012-10-31","2012-11-01","2012-11-02","2012-11-03","2012-11-04","2012-11-05","2012-11-06","2012-11-07","2012-11-08","2012-11-09","2012-11-10","2012-11-11","2012-11-12","2012-11-13","2012-11-14","2012-11-15","2012-11-16","2012-11-17","2012-11-18","2012-11-19","2012-11-20","2012-11-21","2012-11-22","2012-11-23","2012-11-24","2012-11-25","2012-11-26","2012-11-27","2012-11-28","2012-11-29","2012-11-30","2012-12-01","2012-12-02","2012-12-03","2012-12-04","2012-12-05","2012-12-06","2012-12-07","2012-12-08","2012-12-09","2012-12-10","2012-12-11","2012-12-12","2012-12-13","2012-12-14","2012-12-15","2012-12-16","2012-12-17","2012-12-18","2012-12-19","2012-12-20","2012-12-21","2012-12-22","2012-12-23","2012-12-24","2012-12-25","2012-12-26","2012-12-27","2012-12-28","2012-12-29","2012-12-30","2012-12-31"],"y":[0.284648181108991,0.259764827654927,0.470466352274564,0.319211024705643,0.26506241029053,0.241891204288269,0.220745577043142,0.201448456662518,0.645257807713908,0.435810466148296,0.286853639549061,0.233612327826669,0.213190422786243,0.194553758316639,0.177546272390861,0.630371801955458,0.572908636454542,0.382418369500136,1.25993056280096,1.0439359475041,0.731441010179273,0.507241020386266,0.346810812448538,0.274585261114939,0.250581587249961,0.228676264755616,0.208685860108378,0.216131896347883,0.23936571354018,0.216097104166488,0.197206343640899,0.179966974209197,0.180786896806277,0.166900072864193,0.173136179213915,0.158000973619833,0.1529560630497,0.172613900012703,0.170072425586288,0.157662242687766,0.898179482270931,0.852683417355398,0.58196487016413,0.388982901348416,0.252038872967915,0.222654110703809,0.220910173349785,0.201598664301511,0.262775573981798,0.209004610558941,0.190733861110253,0.932633091881298,4.33509968412803,3.10973856248519,27.257064999086,41.5822023750025,9.78977612089834,5.49262722663358,3.95942951288434,2.85050141478792,3.20999224255308,3.13398302837095,2.8052494634245,2.01983890229148,1.45197251304591,1.04159718572177,0.745219859373284,0.531342515369986,0.641241895580934,13.4154422692858,6.48186772937683,4.85097302119728,3.50857745653406,2.5366430922158,1.83302213007578,1.32372440756748,0.95515625635831,0.688498519755441,0.495634130056909,3.39462474607854,3.95267769935359,6.35472735602445,4.60108278068986,3.63810602988956,2.63357806610186,1.90607535457723,1.37923031090517,0.997725035928227,0.721489481632643,0.521498731912744,4.25021600503302,3.29642972708348,2.38700406220053,1.72831025366398,2.52485550188348,3.45997582159589,2.50573739751482,1.81455908245155,1.31393149294342,0.951330733553795,0.688709947254632,0.62048204723541,9.47494831479982,5.55720786726302,4.02523883985863,2.91553734911067,2.11171551378341,1.52946455700337,2.70113648192617,1.95646540351452,1.41705700827751,1.02633525643274,0.743317758894184,0.538317833314986,0.389831163495363,0.352374443920184,15.2570019404978,6.0298421335185,4.36270983445178,3.15552682317599,2.2814819361524,1.64871925721028,1.1907034241983,0.85924048327625,0.619422364563863,0.445964787119832,0.356606816488858,19.8408794946682,18.7927190134173,6.33836271830942,4.58725420042684,3.31914802937381,2.40088722928269,1.73601840197436,1.25467521934812,0.90625025600537,0.654086635905023,0.471632788759922,0.364351311213834,0.332500475480181,0.303433973727796,0.276908405256488,0.252701646950311,0.230610993235292,0.210451458638199,0.19205422873209,0.175265246497005,2.00043389746847,1.95910721210046,1.38619436662234,0.974067922744431,0.678160074132041,0.466208832335725,0.314864364542294,0.259883286887518,0.237164829108405,0.216432371776041,0.19751230285158,0.180246187100431,0.164489439367516,0.150110113832057,0.136987799103186,0.125012609904019,0.114084266900606,0.104111256970328,0.0950100668778902,0.086704483941769,0.0791249578349461,0.0722080181757007,0.0658957430314044,0.0601352738846131,0.0548783729998159,0.0500810194842651,0.0457030406603299,0.041707775662515,0.0380617684421288,0.0347344876088479,0.0316980707631495,0.028927091178673,0.0263983448807255,0.024090656337942,0.0219847011399783,0.0200628441763514,0.0183089919613506,0.016708457868398,0.0152478391453418,0.0139149046808178,0.0126984925818421,0.0115884167049588,0.0105753813582406,0.00965090345986307,0.00880724150141596,0.00803733072109335,0.00733472394390972,0.00669353759354127,0.625911911465335,0.388347444604777,0.22194721971659,0.117630996766218,0.107347939069226,0.0979638049426068,0.0894000123527694,0.0815848487444699,0.0744528705252673,0.0679443550458007,0.0620048004868144,0.056584469465021,0.0516379725359938,0.0471238881063716,0.0430044155725506,0.0392450587812719,25.9506788160646,6.71129070804602,4.80725827569873,3.43276008331831,2.44143085745113,5.00249970357758,3.58607309712414,2.56333290763805,1.82548340376069,1.29374035362711,0.911057035797567,1.62698763706589,3.85830484392286,2.7750386956372,1.99207729144762,1.42649882455312,1.01824970891884,0.723840465178795,0.511779252318162,0.359264105089741,0.307794727496614,0.280887950977768,0.256333309040705,0.233925182960084,0.213475928772953,0.194814305962309,0.177784043501885,0.162242531254329,0.14805962576463,0.135116560448618,0.379274653841795,0.231745245889233,0.174083823940408,1.08539114337838,3.88678892370181,14.632697836969,33.9749952658155,18.3852584859167,12.1954976225233,6.81751154341131,4.91749649962685,3.54299792326729,13.7045807914242,8.03511702351978,7.66936707901429,10.0752055268793,6.13781579900733,6.01845157711103,11.3344587859383,13.5331861568619,23.8633032843563,36.70552837814,29.7479169233471,30.2652694886992,8.90937477090835,5.48670001788853,3.96960001782806,2.87106835244874,2.0963399024696,5.21411992335032,4.02931842324206,2.91568390253757,2.1092585848817,1.5253457794017,1.10259501015141,0.796567136056115,0.575073072850866,0.41479727417169,0.352618684209807,1.58760891422711,6.86679005783414,5.24705522340028,4.49799332030588,4.47406082302498,6.49874059076112,5.39246771625985,7.14471529399543,5.36442653029101,5.87501658877726,4.25326554713125,3.07871903917488,2.84275272777191,2.28031225931094,1.65009456956877,1.19372797872676,1.21837188076408,0.881258891449688,0.637175261189123,0.508284278261236,0.376373231884913,0.343471464787182,0.313445901910278,0.286045111448263,0.261039641242047,0.240850490636331,0.250134926646174,0.228268650295158,0.530054597400599,0.529817247369601,1.21953221971071,1.10721653104932,0.87567679197675,0.639616427733466,0.673309960835874,0.710437603989431,0.562047114114398,0.394150000505101,0.31075350142215,0.458207048863765,1.13031979019396,2.75876112861518,2.10025500531358,1.95598477115235,1.44801465038424,1.13385031290674,0.813928299696514,0.619741282050941,0.474997614890632,0.351891769402474,0.398263214839997,0.333786589120793,0.30460765798215,0.597774710093924,0.419132339093668,0.316225720663452,0.488450825373918,0.341935791025083,0.302390865162792,0.275956483078177,0.255412524687694,0.23308489166493,0.212709093999531,0.194114506293884,0.177145418868652,0.180491066446233,0.164712911868942,0.150314050831029,0.137173908352801,0.12518244986914,0.11423925980833,0.104252700719611,0.0977900723857947,0.0909649041091551,0.0830129409100773,0.0757561218365142,0.0737958330896089,0.067861348260382,0.061929049982369,0.0565153409125203,0.0522719228724139,0.0479604569287977,0.0444609245347929,0.0405742427517461,0.0371952914940014,0.0381845443853681,0.0353704603524128,0.0355728012196691,0.0502846115814034,0.0458888351587139,0.0418773283913043,0.0382164992231259,0.185034816067921,2.89456681613667,4.1982564056571,2.99146463134544,2.17214438524078,1.56511432907904,1.09599056557053,6.04093744530031,5.29557376976693,3.80731691419464,2.73176224954891,3.31906770584537,2.38246164853574,2.19159638125296,70.0604138933801,17.5382328951436,6.18413302818013,4.46585839337579,3.22238217653164,2.32273463917123,1.67205323583076,2.70603067325274,5.69834727294018,5.74657297201699,8.97052910315561,7.1947587169686,5.20567639537499,3.76535593980614,2.72250091373379,1.96751936117574,1.42102883370358,1.02552970118413,3.1183191429272,2.25565266592127,1.63103408335803,1.17882806035284,0.851491853820662,0.871232444600212,0.629081704791133,1.91546843099102,1.89787471577654,1.81860534919772,1.31595831058448,0.95197374864234,0.688422699070339,0.497613828883107,4.39981264444001,11.9047184723389,8.99131014070961,24.8648832742443,7.71768700672696,5.58887445277675,4.4840903220241,3.24766964133183,2.35207692419816,1.70336900358029,1.23349573873224,0.893163330556177,0.646664657778347,0.468134482012069,0.936368803939615,13.3975605340028,8.19636948998361,6.65462765821337,5.15245777405875,3.73216265121907,3.50437484628579,4.13284575264532,2.99361786750162,2.30516607274513,1.66970631349046,1.66934852787398,1.2091513546123,0.875801938653856,0.634337720279861,0.459432606088913,0.368519723993715,0.336304494262743,0.306905453080302,0.678118031713824,1.87442797415177,1.6522133593295,1.18559570545958,0.848569549560887,0.60533094429431,0.42995175665086,0.333705788410901,0.304533920702686,2.75993601077605,2.14580935718519,1.54169864134508,1.10520192255533,1.68815143929482,1.33234707978741,2.36771610393448,1.95827514667738,1.41120920279035,1.01556628413566,0.729555091700965,0.522907767872594,0.37370336939081,0.332229736848084,0.303186902505235,0.302194167798719,1.81905919130066,2.62640776583948,1.88946744287293,2.30814713068387,7.56415599737201,5.44262327128594,3.9334739076762,2.8410684840083,2.05047457678857,1.47844356606926,2.18000153510113,5.3561892081333,3.87468535441585,2.80197161091768,2.02533700553946,1.46313953810947,1.05624262251078,0.76181184953663,0.548821514827049,5.33116742677458,4.81622213220798,3.48647688547868,2.52343757931959,1.82601492081996,1.32098345431841,0.955301576332195,2.43553872811746,1.76292839793653,1.27581927733513,0.923073259754806,0.667647846127351,0.48271102589609,0.371051107839684,0.338614589784571,0.309013604844196,0.282000276596339,2.39058947727746,1.71392736831921,1.22532043713103,0.872801012321574,0.6187366582882,0.43587804959824,0.322536752482823,0.294341258723869,0.268610556534222,0.245129178948414,0.223700494676083,0.204145061526336,0.186299123772332,0.170013240873139,0.155151036069879,0.141588054377006,0.12921072040561,0.117915387291657,0.107607468764935,0.0982006470907441,0.0896161502516754,0.0817820923166588,0.074632871473582,0.0681086206846484,0.0621547063643038,0.0567212708816989,0.0517628150566375,0.0472378171528622,0.0431083851781571,0.0393399395796543,0.0359009236772578,0.0327625394103774,0.0298985061851345,0.0272848408026448,0.0248996566255146,0.0227229803007842,0.0207365845045727,0.0189238353078379,0.0172695528851053,0.0157598843997508,0.0143821880013887,0.0131249269639667,0.01197757307809,0.0109305184885865,0.00997499523905081,0.0091030018496363,0.00830723631326434,0.00758103494916625,0.00691831660172146,0.00631353171731766,0.00576161587280607,0.00525794736640278,0.036536458332426,0.252972035815364,0.123323065111834,0.0931146210041982,0.084974734014014,0.0775464190572915,0.0707674719831112,0.0645811263983767,0.058935578310307,0.0537835523236962,0.0490819057603084,0.0447912673853343,0.0408757077156311,0.0373024381489318,0.0340415363945559,3.35902212716466,2.37285286924822,1.66376824493045,1.15493677389461,5.15236198414167,8.8596852736129,7.18385589919971,6.09700053665972,7.201428376738,10.125385838146,20.9900382650713,25.0280064366042,19.4733939762741,6.32817581089472,4.56562407191448,3.29047445662988,2.57722890156035,2.84218262330672,2.04607368540886,1.47050296902825,1.0545881772023,1.20066131276982,1.03504967586391,1.41728463785064,1.17380540104643,0.843562515824972,0.6049286696524,0.432603176001423,0.344058643433707,0.313981750617699,0.286534117373367,0.288613257133755,2.23093192100607,1.59941052645115,1.14340330539188,0.814407826678531,0.57730104417017,0.406650689730483,0.318429993214753,0.290593503831025,0.265190422598921,0.242008026026238,0.220852186467139,0.201545746511844,1.10358996326361,3.30863918339457,10.8116997751007,6.02142280228092,4.33778975539115,5.48035836890953,4.54981931035599,3.27755158291867,2.35754199569629,1.69256149135152,4.84096970794969,3.8238013430813,3.23395957366617,5.50358882435873,4.1621013776089,3.00616436715552,2.16959470059378,6.02088000723817,5.49371341087882,10.1636107160719,6.38898365809677,4.62297849913568,3.3441640728525,2.8701747283755,24.1110951875277,12.593961395432,6.2937014736447,4.55609910812437,3.29767191069518,2.38632689946996,1.97502330228666,1.77450071446089,1.28355843361647,0.928092015503132,1.23528205886999,0.893404353611319,0.645878346380123,0.546142811354917,12.4057841199975,5.8858137970796,4.26267011587982,3.0869764003449,21.1135980460903,9.73038103936818,6.80862461323739,5.0357819722367,5.32886423104592,4.03063125234487,4.60107898571946,3.34991978626531,2.4262553566249,1.75720320553261,3.82863332566737,6.94840540579193,5.03303318378712,3.6455988966204,2.64059001437079,1.91260044180391,1.38527633923741,1.00330870555611,0.726632972468795,0.526227311863648,0.383660288955438,0.35012150244652,0.319514607073776,2.47201804813013,1.86587467290661,1.76888596077315,1.27191446824953,0.912742958291646,0.65331883759809,0.535208880152444,0.397734110898321,0.332916556657109,1.04231268647126,0.74600850299049,0.532160508754298,0.377973129890543,0.325155916330492,0.29673146070176,0.270791812013981,0.247119753599421,0.225517057420797,0.205802824124595,0.187811968203489,0.17362610385524,0.159901666609011,0.153031612737097,0.139839614139036,0.127615125185884,0.116459275695776,0.106278647423879,0.0969879885545162,0.0907519983625061,0.0893955010665282,0.0815807318255127,0.0789310427249373,0.0732342730172759,0.0795412388572285,0.166435467211666,0.110811561917535,0.101124645067238,0.110553008632256,0.100888693973758,0.0920692136528675,0.0840207140045075,0.121780256733997,0.103343391604823,0.0943093267096047,0.0860650010252213,1.07658403824804,23.2362960722372,10.6912465847891,6.62057337267807,4.7567281876925,3.41001347947021,3.62426272131869,2.59564141008547,2.13873365712843,1.52452050394321,1.08175940632052,0.763005610836669,0.533907644630696,0.369597091482325,0.291308032340468,0.265842488508448,0.242603089686747,0.221395230896981,0.634240282215391,1.98460258054933,1.41189293217279,0.999281626689243,0.755615113677956,0.527810674856364,0.985522926328108,0.69761830839819,1.24357400964916,2.50355789908012,1.80115709348213,1.29343372452908,3.45848266419837,2.49585315913632,1.79936602624141,1.29559507770932,0.931358184533651,0.668137045363909,0.478035030713347,0.353321241215153,0.322434631317517,0.294248064778971,21.0478987083211,7.31060278690245,5.28135578474977,3.81266081083405,3.42439160365534,2.99286908042202,2.15805894958307,1.55420640073113,1.28265008736219,1.02110093573728,2.38318972466774,1.99225137296913,1.95404378883044,3.1427255805279,2.27175660282986,3.99521179261325,3.57630684497382,2.62153594262449,3.24343548564203,3.03785659554562,2.35163131114779,1.70095935376915,2.6817632232059,1.99181151937435,2.10999384522699,1.52669244269069,2.66989664251459,2.49101256658556,1.92420853982319,1.39264764486063,1.00770165043981,6.70187403662214,5.9479027773211,4.57425398059099,3.31272946728876,2.39897415858488,1.73712980521193,1.25775918947347,0.910563896631466,0.6591092233422,0.477003014227598,3.34982255905875,17.390546055992,6.79515931180587,4.92196597667462,3.62978166912079,2.62908327958577,1.90422042758697,1.37916517064683,0.998844613606536,0.72336524834678,0.523829186494818,0.683498316671405,0.494977427124117,0.376467285541821,0.34355729646853,2.77389175529922,2.00215604307004,1.44375554265971,1.03983567485524,0.747768207967419,0.536678520037102,0.384205677006359,0.336387736873783,0.306981418794983,0.280145740035522,0.269402213167461,0.412982756610231,0.28576579407489,0.260784741213976,0.237987480167824,0.217183108386539,0.198197411625086,0.180871405086301,0.165060002094155,0.150630799148837,0.334002165106044,0.587084619859318,2.00499960008203,1.41879402347335,0.997094883643431,1.10360083936022,1.18562016376078,6.76583270461364,4.87977111388453,3.51540550766245,2.52878320927959,1.81564208448283,1.30046976386495,0.92857847888238,0.660364336364482,4.16500672040409,3.00681879328053,2.16874537791486,8.79415070260028,5.46602670358886,3.95238422131263,2.85655296792821,2.06332131086459,1.48923706931871,1.07385353690605,0.773388318115529,0.556129953909617,0.399110606667165,0.342509661441155],"name":"Modeled","type":"scatter","mode":"lines","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2010-08-07","2010-08-08","2010-08-09","2010-08-10","2010-08-11","2010-08-12","2010-08-13","2010-08-14","2010-08-15","2010-08-16","2010-08-17","2010-08-18","2010-08-19","2010-08-20","2010-08-21","2010-08-22","2010-08-23","2010-08-24","2010-08-25","2010-08-26","2010-08-27","2010-08-28","2010-08-29","2010-08-30","2010-08-31","2010-09-01","2010-09-02","2010-09-03","2010-09-04","2010-09-05","2010-09-06","2010-09-07","2010-09-08","2010-09-09","2010-09-10","2010-09-11","2010-09-12","2010-09-13","2010-09-14","2010-09-15","2010-09-16","2010-09-17","2010-09-18","2010-09-19","2010-09-20","2010-09-21","2010-09-22","2010-09-23","2010-09-24","2010-09-25","2010-09-26","2010-09-27","2010-09-28","2010-09-29","2010-09-30","2010-10-01","2010-10-02","2010-10-03","2010-10-04","2010-10-05","2010-10-06","2010-10-07","2010-10-08","2010-10-09","2010-10-10","2010-10-11","2010-10-12","2010-10-13","2010-10-14","2010-10-15","2010-10-16","2010-10-17","2010-10-18","2010-10-19","2010-10-20","2010-10-21","2010-10-22","2010-10-23","2010-10-24","2010-10-25","2010-10-26","2010-10-27","2010-10-28","2010-10-29","2010-10-30","2010-10-31","2010-11-01","2010-11-02","2010-11-03","2010-11-04","2010-11-05","2010-11-06","2010-11-07","2010-11-08","2010-11-09","2010-11-10","2010-11-11","2010-11-12","2010-11-13","2010-11-14","2010-11-15","2010-11-16","2010-11-17","2010-11-18","2010-11-19","2010-11-20","2010-11-21","2010-11-22","2010-11-23","2010-11-24","2010-11-25","2010-11-26","2010-11-27","2010-11-28","2010-11-29","2010-11-30","2010-12-01","2010-12-02","2010-12-03","2010-12-04","2010-12-05","2010-12-06","2010-12-07","2010-12-08","2010-12-09","2010-12-10","2010-12-11","2010-12-12","2010-12-13","2010-12-14","2010-12-15","2010-12-16","2010-12-17","2010-12-18","2010-12-19","2010-12-20","2010-12-21","2010-12-22","2010-12-23","2010-12-24","2010-12-25","2010-12-26","2010-12-27","2010-12-28","2010-12-29","2010-12-30","2010-12-31","2011-01-01","2011-01-02","2011-01-03","2011-01-04","2011-01-05","2011-01-06","2011-01-07","2011-01-08","2011-01-09","2011-01-10","2011-01-11","2011-01-12","2011-01-13","2011-01-14","2011-01-15","2011-01-16","2011-01-17","2011-01-18","2011-01-19","2011-01-20","2011-01-21","2011-01-22","2011-01-23","2011-01-24","2011-01-25","2011-01-26","2011-01-27","2011-01-28","2011-01-29","2011-01-30","2011-01-31","2011-02-01","2011-02-02","2011-02-03","2011-02-04","2011-02-05","2011-02-06","2011-02-07","2011-02-08","2011-02-09","2011-02-10","2011-02-11","2011-02-12","2011-02-13","2011-02-14","2011-02-15","2011-02-16","2011-02-17","2011-02-18","2011-02-19","2011-02-20","2011-02-21","2011-02-22","2011-02-23","2011-02-24","2011-02-25","2011-02-26","2011-02-27","2011-02-28","2011-03-01","2011-03-02","2011-03-03","2011-03-04","2011-03-05","2011-03-06","2011-03-07","2011-03-08","2011-03-09","2011-03-10","2011-03-11","2011-03-12","2011-03-13","2011-03-14","2011-03-15","2011-03-16","2011-03-17","2011-03-18","2011-03-19","2011-03-20","2011-03-21","2011-03-22","2011-03-23","2011-03-24","2011-03-25","2011-03-26","2011-03-27","2011-03-28","2011-03-29","2011-03-30","2011-03-31","2011-04-01","2011-04-02","2011-04-03","2011-04-04","2011-04-05","2011-04-06","2011-04-07","2011-04-08","2011-04-09","2011-04-10","2011-04-11","2011-04-12","2011-04-13","2011-04-14","2011-04-15","2011-04-16","2011-04-17","2011-04-18","2011-04-19","2011-04-20","2011-04-21","2011-04-22","2011-04-23","2011-04-24","2011-04-25","2011-04-26","2011-04-27","2011-04-28","2011-04-29","2011-04-30","2011-05-01","2011-05-02","2011-05-03","2011-05-04","2011-05-05","2011-05-06","2011-05-07","2011-05-08","2011-05-09","2011-05-10","2011-05-11","2011-05-12","2011-05-13","2011-05-14","2011-05-15","2011-05-16","2011-05-17","2011-05-18","2011-05-19","2011-05-20","2011-05-21","2011-05-22","2011-05-23","2011-05-24","2011-05-25","2011-05-26","2011-05-27","2011-05-28","2011-05-29","2011-05-30","2011-05-31","2011-06-01","2011-06-02","2011-06-03","2011-06-04","2011-06-05","2011-06-06","2011-06-07","2011-06-08","2011-06-09","2011-06-10","2011-06-11","2011-06-12","2011-06-13","2011-06-14","2011-06-15","2011-06-16","2011-06-17","2011-06-18","2011-06-19","2011-06-20","2011-06-21","2011-06-22","2011-06-23","2011-06-24","2011-06-25","2011-06-26","2011-06-27","2011-06-28","2011-06-29","2011-06-30","2011-07-01","2011-07-02","2011-07-03","2011-07-04","2011-07-05","2011-07-06","2011-07-07","2011-07-08","2011-07-09","2011-07-10","2011-07-11","2011-07-12","2011-07-13","2011-07-14","2011-07-15","2011-07-16","2011-07-17","2011-07-18","2011-07-19","2011-07-20","2011-07-21","2011-07-22","2011-07-23","2011-07-24","2011-07-25","2011-07-26","2011-07-27","2011-07-28","2011-07-29","2011-07-30","2011-07-31","2011-08-01","2011-08-02","2011-08-03","2011-08-04","2011-08-05","2011-08-06","2011-08-07","2011-08-08","2011-08-09","2011-08-10","2011-08-11","2011-08-12","2011-08-13","2011-08-14","2011-08-15","2011-08-16","2011-08-17","2011-08-18","2011-08-19","2011-08-20","2011-08-21","2011-08-22","2011-08-23","2011-08-24","2011-08-25","2011-08-26","2011-08-27","2011-08-28","2011-08-29","2011-08-30","2011-08-31","2011-09-01","2011-09-02","2011-09-03","2011-09-04","2011-09-05","2011-09-06","2011-09-07","2011-09-08","2011-09-09","2011-09-10","2011-09-11","2011-09-12","2011-09-13","2011-09-14","2011-09-15","2011-09-16","2011-09-17","2011-09-18","2011-09-19","2011-09-20","2011-09-21","2011-09-22","2011-09-23","2011-09-24","2011-09-25","2011-09-26","2011-09-27","2011-09-28","2011-09-29","2011-09-30","2011-10-01","2011-10-02","2011-10-03","2011-10-04","2011-10-05","2011-10-06","2011-10-07","2011-10-08","2011-10-09","2011-10-10","2011-10-11","2011-10-12","2011-10-13","2011-10-14","2011-10-15","2011-10-16","2011-10-17","2011-10-18","2011-10-19","2011-10-20","2011-10-21","2011-10-22","2011-10-23","2011-10-24","2011-10-25","2011-10-26","2011-10-27","2011-10-28","2011-10-29","2011-10-30","2011-10-31","2011-11-01","2011-11-02","2011-11-03","2011-11-04","2011-11-05","2011-11-06","2011-11-07","2011-11-08","2011-11-09","2011-11-10","2011-11-11","2011-11-12","2011-11-13","2011-11-14","2011-11-15","2011-11-16","2011-11-17","2011-11-18","2011-11-19","2011-11-20","2011-11-21","2011-11-22","2011-11-23","2011-11-24","2011-11-25","2011-11-26","2011-11-27","2011-11-28","2011-11-29","2011-11-30","2011-12-01","2011-12-02","2011-12-03","2011-12-04","2011-12-05","2011-12-06","2011-12-07","2011-12-08","2011-12-09","2011-12-10","2011-12-11","2011-12-12","2011-12-13","2011-12-14","2011-12-15","2011-12-16","2011-12-17","2011-12-18","2011-12-19","2011-12-20","2011-12-21","2011-12-22","2011-12-23","2011-12-24","2011-12-25","2011-12-26","2011-12-27","2011-12-28","2011-12-29","2011-12-30","2011-12-31","2012-01-01","2012-01-02","2012-01-03","2012-01-04","2012-01-05","2012-01-06","2012-01-07","2012-01-08","2012-01-09","2012-01-10","2012-01-11","2012-01-12","2012-01-13","2012-01-14","2012-01-15","2012-01-16","2012-01-17","2012-01-18","2012-01-19","2012-01-20","2012-01-21","2012-01-22","2012-01-23","2012-01-24","2012-01-25","2012-01-26","2012-01-27","2012-01-28","2012-01-29","2012-01-30","2012-01-31","2012-02-01","2012-02-02","2012-02-03","2012-02-04","2012-02-05","2012-02-06","2012-02-07","2012-02-08","2012-02-09","2012-02-10","2012-02-11","2012-02-12","2012-02-13","2012-02-14","2012-02-15","2012-02-16","2012-02-17","2012-02-18","2012-02-19","2012-02-20","2012-02-21","2012-02-22","2012-02-23","2012-02-24","2012-02-25","2012-02-26","2012-02-27","2012-02-28","2012-02-29","2012-03-01","2012-03-02","2012-03-03","2012-03-04","2012-03-05","2012-03-06","2012-03-07","2012-03-08","2012-03-09","2012-03-10","2012-03-11","2012-03-12","2012-03-13","2012-03-14","2012-03-15","2012-03-16","2012-03-17","2012-03-18","2012-03-19","2012-03-20","2012-03-21","2012-03-22","2012-03-23","2012-03-24","2012-03-25","2012-03-26","2012-03-27","2012-03-28","2012-03-29","2012-03-30","2012-03-31","2012-04-01","2012-04-02","2012-04-03","2012-04-04","2012-04-05","2012-04-06","2012-04-07","2012-04-08","2012-04-09","2012-04-10","2012-04-11","2012-04-12","2012-04-13","2012-04-14","2012-04-15","2012-04-16","2012-04-17","2012-04-18","2012-04-19","2012-04-20","2012-04-21","2012-04-22","2012-04-23","2012-04-24","2012-04-25","2012-04-26","2012-04-27","2012-04-28","2012-04-29","2012-04-30","2012-05-01","2012-05-02","2012-05-03","2012-05-04","2012-05-05","2012-05-06","2012-05-07","2012-05-08","2012-05-09","2012-05-10","2012-05-11","2012-05-12","2012-05-13","2012-05-14","2012-05-15","2012-05-16","2012-05-17","2012-05-18","2012-05-19","2012-05-20","2012-05-21","2012-05-22","2012-05-23","2012-05-24","2012-05-25","2012-05-26","2012-05-27","2012-05-28","2012-05-29","2012-05-30","2012-05-31","2012-06-01","2012-06-02","2012-06-03","2012-06-04","2012-06-05","2012-06-06","2012-06-07","2012-06-08","2012-06-09","2012-06-10","2012-06-11","2012-06-12","2012-06-13","2012-06-14","2012-06-15","2012-06-16","2012-06-17","2012-06-18","2012-06-19","2012-06-20","2012-06-21","2012-06-22","2012-06-23","2012-06-24","2012-06-25","2012-06-26","2012-06-27","2012-06-28","2012-06-29","2012-06-30","2012-07-01","2012-07-02","2012-07-03","2012-07-04","2012-07-05","2012-07-06","2012-07-07","2012-07-08","2012-07-09","2012-07-10","2012-07-11","2012-07-12","2012-07-13","2012-07-14","2012-07-15","2012-07-16","2012-07-17","2012-07-18","2012-07-19","2012-07-20","2012-07-21","2012-07-22","2012-07-23","2012-07-24","2012-07-25","2012-07-26","2012-07-27","2012-07-28","2012-07-29","2012-07-30","2012-07-31","2012-08-01","2012-08-02","2012-08-03","2012-08-04","2012-08-05","2012-08-06","2012-08-07","2012-08-08","2012-08-09","2012-08-10","2012-08-11","2012-08-12","2012-08-13","2012-08-14","2012-08-15","2012-08-16","2012-08-17","2012-08-18","2012-08-19","2012-08-20","2012-08-21","2012-08-22","2012-08-23","2012-08-24","2012-08-25","2012-08-26","2012-08-27","2012-08-28","2012-08-29","2012-08-30","2012-08-31","2012-09-01","2012-09-02","2012-09-03","2012-09-04","2012-09-05","2012-09-06","2012-09-07","2012-09-08","2012-09-09","2012-09-10","2012-09-11","2012-09-12","2012-09-13","2012-09-14","2012-09-15","2012-09-16","2012-09-17","2012-09-18","2012-09-19","2012-09-20","2012-09-21","2012-09-22","2012-09-23","2012-09-24","2012-09-25","2012-09-26","2012-09-27","2012-09-28","2012-09-29","2012-09-30","2012-10-01","2012-10-02","2012-10-03","2012-10-04","2012-10-05","2012-10-06","2012-10-07","2012-10-08","2012-10-09","2012-10-10","2012-10-11","2012-10-12","2012-10-13","2012-10-14","2012-10-15","2012-10-16","2012-10-17","2012-10-18","2012-10-19","2012-10-20","2012-10-21","2012-10-22","2012-10-23","2012-10-24","2012-10-25","2012-10-26","2012-10-27","2012-10-28","2012-10-29","2012-10-30","2012-10-31","2012-11-01","2012-11-02","2012-11-03","2012-11-04","2012-11-05","2012-11-06","2012-11-07","2012-11-08","2012-11-09","2012-11-10","2012-11-11","2012-11-12","2012-11-13","2012-11-14","2012-11-15","2012-11-16","2012-11-17","2012-11-18","2012-11-19","2012-11-20","2012-11-21","2012-11-22","2012-11-23","2012-11-24","2012-11-25","2012-11-26","2012-11-27","2012-11-28","2012-11-29","2012-11-30","2012-12-01","2012-12-02","2012-12-03","2012-12-04","2012-12-05","2012-12-06","2012-12-07","2012-12-08","2012-12-09","2012-12-10","2012-12-11","2012-12-12","2012-12-13","2012-12-14","2012-12-15","2012-12-16","2012-12-17","2012-12-18","2012-12-19","2012-12-20","2012-12-21","2012-12-22","2012-12-23","2012-12-24","2012-12-25","2012-12-26","2012-12-27","2012-12-28","2012-12-29","2012-12-30","2012-12-31"],"y":[0.232,0.188,0.249,0.307,0.163,0.153,0.139,0.111,0.107,0.745,0.302,0.251,0.148,0.14,0.133,0.487,0.776,0.456,1.419,1.298,0.674,0.398,0.254,0.208,0.158,0.15,0.16,0.126,0.198,0.127,0.129,0.127,0.156,0.134,0.128,0.163,0.155,0.275,0.303,0.227,0.423,1.673,0.586,0.394,0.292,0.236,0.312,0.347,0.477,0.334,0.221,0.395,5.947,5.298,26.239,41.661,12.058,5.169,3.285,2.436,2.122,2.349,2.051,1.827,1.504,1.314,1.195,1.1,1.05,15.584,7.481,4.398,3.155,2.42,2.066,2.248,2.564,2.144,2.07,2.089,4.759,10.144,6.284,4.044,3.228,2.936,2.398,2.125,1.861,3.34,11.946,6.237,4.014,5.17,4.194,3.207,2.666,2.343,1.828,1.617,1.498,1.416,10.329,6.162,3.821,2.969,2.419,2.484,3.732,3.464,2.625,2.339,1.999,1.728,1.576,1.566,17.95,22.143,7.05,4.503,3.385,2.74,2.309,1.958,1.619,1.485,1.433,9.018,30.67,11.413,5.645,3.861,3.092,2.552,2.238,1.955,1.706,1.627,1.523,1.387,1.284,1.202,1.204,1.101,1.024,0.977,1.004,2.793,5.399,3.435,2.377,1.942,1.647,1.46,1.334,1.181,1.072,1.053,1.003,0.945,0.8,0.718,0.701,0.763,0.83,0.866,0.872,0.817,0.795,0.76,0.723,0.694,0.659,0.617,0.603,0.591,0.581,0.595,0.613,0.622,0.639,0.649,0.604,0.618,0.622,0.61,0.6,0.597,0.596,0.593,0.606,0.595,0.559,0.556,0.771,1.816,1.711,1.143,0.941,0.894,0.806,0.768,0.757,0.734,0.769,0.826,0.721,0.667,0.656,0.692,0.69,20.072,35.229,9.098,5.066,3.885,9.084,9.595,5.179,3.889,3.298,3.212,3.847,13.622,10.723,6.062,4.849,3.79,3.125,2.739,2.353,2.129,2.023,1.777,1.673,1.738,1.871,1.821,1.856,2.232,2.573,3.455,3.297,3.201,4.419,7.254,16.446,54.427,33.419,18.191,16.396,10.761,6.962,27.681,11.052,7.386,7.512,6.176,5.309,4.929,10.734,9.581,30.516,11.822,9.907,8.569,5.303,3.948,3.218,2.751,4.437,4.76,3.427,2.813,2.418,2.1,1.835,1.693,1.566,1.452,1.735,9.302,9.21,5.657,5.255,11.735,6.777,8.116,6.566,7.713,7.815,4.795,3.521,3.272,2.736,2.457,1.999,1.396,1.1,0.915,0.892,0.772,0.648,0.427,0.349,0.274,0.234,0.203,0.546,1.285,1.61,3.157,1.357,0.824,0.558,1.021,0.77,0.535,0.334,0.277,1.009,3.865,4.349,2.339,1.856,1.088,0.789,0.595,0.54,0.375,0.5,0.558,0.327,0.349,0.504,0.301,0.521,0.353,0.235,0.25,0.244,0.256,0.18,0.14,0.144,0.184,0.181,0.079,0.078,0.062,0.062,0.067,0.073,0.152,0.085,0.092,0.122,0.167,0.089,0.079,0.087,0.091,0.072,0.076,0.08,0.203,0.149,0.089,0.408,0.259,0.131,0.103,0.557,3.556,6.615,1.895,0.675,0.362,0.217,1.105,8.194,1.687,0.771,0.913,1.363,0.665,70.594,18.438,5.086,2.57,1.608,1.138,0.859,0.843,3.67,8.085,8.756,11.075,4.923,2.704,1.81,1.361,0.95,0.731,2.328,1.913,1.165,0.832,0.646,0.679,0.711,1.704,3.06,4.273,2.37,1.435,0.96,0.768,5.311,11.334,19.193,22.093,13.334,6.617,4.483,3.238,2.459,1.972,1.586,1.343,1.164,1.071,1.604,11.522,14.451,6.472,4.439,3.308,2.774,3.765,2.974,2.471,2.185,1.935,1.848,1.695,1.672,1.744,1.658,1.572,1.672,2.305,2.309,1.937,1.63,1.428,1.289,1.256,1.168,1.034,1.648,2.685,1.767,1.558,1.487,2.145,1.923,2.788,2.057,1.717,1.576,1.396,1.277,1.405,1.286,1.659,3.155,4.457,5.312,3.781,21.773,6.944,4.398,3.367,2.812,2.447,4.378,9.479,4.739,3.551,2.88,2.456,2.178,2.006,3.54,6.687,5.106,3.488,2.621,2.339,2.059,2.409,4.094,3.4,2.582,2.268,2.07,3.854,19.039,6.486,4.18,3.446,3.975,7.375,4.134,2.863,2.456,2.108,1.97,1.774,1.612,1.47,1.312,2.459,1.334,1.131,1.124,1.115,1.122,1.076,0.948,0.893,0.866,0.821,1.25,8.871,3.599,2.392,3.556,3.68,2.474,1.99,1.781,1.997,2.219,1.776,1.627,1.464,1.412,1.338,1.247,1.217,1.146,1.145,1.126,1.16,1.067,0.87,0.784,0.79,0.766,0.76,0.734,0.775,0.798,0.825,0.837,0.856,0.806,0.719,0.695,0.706,0.711,0.699,0.73,0.768,0.787,0.786,1.018,3.463,7.184,3.231,2.489,4.08,12.631,12.704,7.638,6.216,12.118,19.133,16.104,11.335,7.399,5.325,4.083,3.22,3.672,3.335,2.477,2.263,2.204,2.086,3.453,1.992,1.578,1.43,1.358,1.265,1.118,1.013,1.038,1.898,2.095,1.693,1.462,1.294,1.224,1.139,1.117,1.03,0.95,0.927,0.918,1.431,4.066,19.152,9.82,5.496,3.89,6.778,3.972,3.04,2.52,6.379,5.353,4.756,8.827,5.861,4.166,3.317,27.385,18.61,12.629,7.319,4.799,3.597,2.992,13.381,11.137,8.26,5.562,3.95,2.876,2.107,1.972,1.62,1.346,1.715,1.764,1.227,1.001,15.039,12.596,4.444,2.711,20.044,17.601,7.196,4.387,3.801,4.092,3.137,3.226,2.099,1.571,1.681,13.289,5.063,3.035,2.263,1.856,1.359,1.227,0.914,0.658,0.472,0.355,0.29,2.826,2.535,1.636,1.15,0.784,0.507,1.435,0.382,0.246,0.559,0.736,0.457,0.328,0.234,0.175,0.145,0.121,0.104,0.092,0.08,0.072,0.087,0.073,0.113,0.081,0.078,0.074,0.072,0.087,0.255,0.1,0.088,0.194,0.205,0.522,0.356,0.15,0.138,0.316,0.146,0.093,0.163,0.382,0.149,0.098,2.295,28.957,11.403,5.286,2.951,1.67,1.827,1.52,0.972,0.685,0.45,0.301,0.2,0.153,0.11,0.097,0.083,0.108,0.236,1.943,0.609,0.313,0.185,0.165,0.281,0.237,0.533,3.651,1.376,0.739,1.595,2.942,1.283,0.763,0.483,0.341,0.252,0.203,0.175,0.157,18.486,20.958,4.84,2.684,1.988,2.137,1.435,1.15,1.021,0.973,1.533,2.167,1.864,3.319,2.318,4.109,4.352,3.433,2.968,2.786,2.811,2.078,2.304,2.963,2.276,1.91,2.829,2.874,2.651,2.069,1.738,7.919,13.908,6.11,4.052,2.872,2.384,2.038,1.83,1.69,1.554,1.797,17.857,18.49,7.325,4.669,3.419,2.741,2.311,1.972,1.786,1.694,1.548,1.49,1.382,1.308,2.84,2.446,1.901,1.595,1.372,1.194,1.18,1.157,1.104,1.045,1.05,1.014,0.956,0.877,0.804,0.809,0.766,0.722,0.67,1.567,5.631,2.947,4.107,2.723,2.102,1.866,1.662,6.493,7.312,3.684,2.651,2.228,1.883,1.62,1.543,3.026,4.714,2.924,7.174,8.398,4.226,2.967,2.399,2.017,1.9,1.685,1.557,1.457,1.334],"name":"Measured","type":"scatter","mode":"lines","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>NSE in the top 100 runs from a 100,000 run monte carlo</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="modelingcalibration.html#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="co">#the [,-1] drops the first column, which is just row numbers</span></span>
<span id="cb341-2"><a href="modelingcalibration.html#cb341-2" aria-hidden="true" tabindex="-1"></a>pars100 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;HBV/parsFrom100kRun.csv&quot;</span>)[,<span class="sc">-</span><span class="dv">1</span>]</span></code></pre></div>
<pre><code>## Warning: Missing column names filled in: &#39;X1&#39; [1]</code></pre>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   X1 = col_double(),
##   FC = col_double(),
##   beta = col_double(),
##   LP = col_double(),
##   SFCF = col_double(),
##   TT = col_double(),
##   CFMAX = col_double(),
##   k0 = col_double(),
##   k1 = col_double(),
##   k2 = col_double(),
##   UZL = col_double(),
##   PERC = col_double(),
##   MAXBAS = col_double(),
##   NSE = col_double(),
##   ranks = col_double()
## )</code></pre>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="modelingcalibration.html#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pars100, <span class="fu">aes</span>(NSE))<span class="sc">+</span></span>
<span id="cb344-2"><a href="modelingcalibration.html#cb344-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Hydroinformatics_Bookdown_files/figure-html/unnamed-chunk-186-1.png" width="672" /></p>
<p>Show the top 10 parameter sets</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="modelingcalibration.html#cb346-1" aria-hidden="true" tabindex="-1"></a>rankedpars <span class="ot">&lt;-</span> <span class="fu">filter</span>(pars100, ranks <span class="sc">&lt;=</span> <span class="dv">10</span>)</span>
<span id="cb346-2"><a href="modelingcalibration.html#cb346-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-3"><a href="modelingcalibration.html#cb346-3" aria-hidden="true" tabindex="-1"></a>mins <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">1</span>, <span class="fl">0.3</span> , <span class="fl">0.4</span>, <span class="sc">-</span><span class="fl">1.5</span>, <span class="dv">1</span>, <span class="fl">0.05</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb346-4"><a href="modelingcalibration.html#cb346-4" aria-hidden="true" tabindex="-1"></a>maxs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">400</span>, <span class="dv">6</span>, <span class="dv">1</span>, <span class="fl">1.2</span>, <span class="fl">1.2</span>, <span class="dv">8</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.15</span>, <span class="dv">70</span> , <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb346-5"><a href="modelingcalibration.html#cb346-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-6"><a href="modelingcalibration.html#cb346-6" aria-hidden="true" tabindex="-1"></a>rankedpars <span class="ot">&lt;-</span> <span class="fu">rbind</span>(rankedpars, mins, maxs)</span>
<span id="cb346-7"><a href="modelingcalibration.html#cb346-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-8"><a href="modelingcalibration.html#cb346-8" aria-hidden="true" tabindex="-1"></a>rankedpars <span class="ot">&lt;-</span> rankedpars <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">NSE =</span> <span class="fu">as.character</span>(<span class="fu">round</span>(NSE, <span class="dv">2</span>)))</span>
<span id="cb346-9"><a href="modelingcalibration.html#cb346-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-10"><a href="modelingcalibration.html#cb346-10" aria-hidden="true" tabindex="-1"></a>rankedpars<span class="sc">$</span>NSE[rankedpars<span class="sc">$</span>NSE <span class="sc">==</span> <span class="st">&quot;0&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Min/Max&quot;</span></span>
<span id="cb346-11"><a href="modelingcalibration.html#cb346-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-12"><a href="modelingcalibration.html#cb346-12" aria-hidden="true" tabindex="-1"></a>rankedpars <span class="ot">&lt;-</span> rankedpars <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">ranks =</span> <span class="fu">factor</span>(ranks))</span>
<span id="cb346-13"><a href="modelingcalibration.html#cb346-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-14"><a href="modelingcalibration.html#cb346-14" aria-hidden="true" tabindex="-1"></a>rankedpars <span class="sc">%&gt;%</span> <span class="fu">ggparcoord</span>(<span class="at">columns =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>, </span>
<span id="cb346-15"><a href="modelingcalibration.html#cb346-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">groupColumn =</span> <span class="dv">13</span>,</span>
<span id="cb346-16"><a href="modelingcalibration.html#cb346-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">showPoints =</span> <span class="cn">TRUE</span>,</span>
<span id="cb346-17"><a href="modelingcalibration.html#cb346-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">scale =</span> <span class="st">&quot;uniminmax&quot;</span>) <span class="sc">+</span></span>
<span id="cb346-18"><a href="modelingcalibration.html#cb346-18" aria-hidden="true" tabindex="-1"></a>              <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb346-19"><a href="modelingcalibration.html#cb346-19" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ggtitle</span>(<span class="st">&quot;Top 10 parameter sets from 100,000 run Monte Carlo&quot;</span>)<span class="sc">+</span></span>
<span id="cb346-20"><a href="modelingcalibration.html#cb346-20" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ylab</span>(<span class="st">&quot;normalized parameter values&quot;</span>)<span class="sc">+</span></span>
<span id="cb346-21"><a href="modelingcalibration.html#cb346-21" aria-hidden="true" tabindex="-1"></a>              <span class="fu">xlab</span>(<span class="st">&quot;parameters&quot;</span>)</span></code></pre></div>
<p><img src="Hydroinformatics_Bookdown_files/figure-html/unnamed-chunk-187-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelingintro.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Hydroinformatics_Bookdown.pdf", "Hydroinformatics_Bookdown.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
